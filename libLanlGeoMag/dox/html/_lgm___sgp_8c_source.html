<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LanlGeoMag: /home/mgh/LanlGeoMag/libLanlGeoMag/Lgm_Sgp.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>/home/mgh/LanlGeoMag/libLanlGeoMag/Lgm_Sgp.c</h1><a href="_lgm___sgp_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include "<a class="code" href="_lgm___c_trans_8h.html">Lgm/Lgm_CTrans.h</a>"</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include "<a class="code" href="_lgm___sgp_8h.html">Lgm/Lgm_Sgp.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="keyword">static</span> <span class="keywordtype">char</span> *MonStr1[] = {<span class="stringliteral">"January"</span>, <span class="stringliteral">"February"</span>, <span class="stringliteral">"March"</span>, <span class="stringliteral">"April"</span>, <span class="stringliteral">"May"</span>, <span class="stringliteral">"June"</span>, <span class="stringliteral">"July"</span>, <span class="stringliteral">"August"</span>, <span class="stringliteral">"September"</span>, <span class="stringliteral">"October"</span>, <span class="stringliteral">"November"</span>, <span class="stringliteral">"December"</span>};
<a name="l00008"></a>00008 <span class="comment">//static char *MonStr2[] = {"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"};</span>
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="_lgm___sgp_8c.html#6271ed7e00e88083593d9823dd3f5a9a">00010</a> <span class="keywordtype">int</span> <a class="code" href="_lgm___sgp_8h.html#6271ed7e00e88083593d9823dd3f5a9a">LgmSgp_TleChecksum</a>( <span class="keywordtype">char</span> *Line ) {
<a name="l00011"></a>00011 
<a name="l00012"></a>00012     <span class="keywordtype">int</span> i, sum, val;
<a name="l00013"></a>00013 
<a name="l00014"></a>00014     <span class="keywordflow">if</span> ( strlen( Line ) &lt; 69 ) <span class="keywordflow">return</span>(-1);
<a name="l00015"></a>00015 
<a name="l00016"></a>00016     <span class="keywordflow">for</span> (sum=0, i=0; i&lt;68; i++){
<a name="l00017"></a>00017         <span class="keywordflow">if</span> ( Line[i] == <span class="charliteral">'-'</span> ) val = 1;
<a name="l00018"></a>00018         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (Line[i] &gt;= <span class="charliteral">'0'</span>) &amp;&amp; (Line[i] &lt;= <span class="charliteral">'9'</span>) ) val = (int)Line[i]-<span class="charliteral">'0'</span>;
<a name="l00019"></a>00019         <span class="keywordflow">else</span> val = 0;
<a name="l00020"></a>00020         sum += val;
<a name="l00021"></a>00021     }
<a name="l00022"></a>00022 
<a name="l00023"></a>00023     <span class="keywordflow">return</span>(sum%10);
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 }
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="_lgm___sgp_8c.html#21a21fc6d39baa848658e76b661a8063">00027</a> <span class="keywordtype">int</span> <a class="code" href="_lgm___sgp_8h.html#21a21fc6d39baa848658e76b661a8063">LgmSgp_ReadTlesFromFile</a>( <span class="keywordtype">char</span> *Filename, <span class="keywordtype">int</span> *nTLEs, <a class="code" href="struct___sgp_t_l_e.html">_SgpTLE</a> *TLEs, <span class="keywordtype">int</span> Verbosity ) {
<a name="l00028"></a>00028 
<a name="l00029"></a>00029     <span class="keywordtype">char</span>    *Line0, *Line1, *Line2, *ptr;
<a name="l00030"></a>00030     <span class="keywordtype">int</span>     nLines, done, TLEValid, CheckSumRead1, CheckSumComp1;
<a name="l00031"></a>00031     <span class="keywordtype">int</span>     CheckSumRead2, CheckSumComp2;
<a name="l00032"></a>00032     FILE    *fp;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">//    *nTLEs = 0;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036     <span class="keywordflow">if</span> ( (fp = fopen( Filename, <span class="stringliteral">"rb"</span> )) == NULL ) {
<a name="l00037"></a>00037 
<a name="l00038"></a>00038         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Couldn't open Two Line Element file: %s\n"</span>, Filename);
<a name="l00039"></a>00039         <span class="keywordflow">return</span>(0);
<a name="l00040"></a>00040 
<a name="l00041"></a>00041     } <span class="keywordflow">else</span> {
<a name="l00042"></a>00042 
<a name="l00043"></a>00043         Line0 = (<span class="keywordtype">char</span> *)calloc(256, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00044"></a>00044         Line1 = (<span class="keywordtype">char</span> *)calloc(256, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00045"></a>00045         Line2 = (<span class="keywordtype">char</span> *)calloc(256, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00046"></a>00046 
<a name="l00047"></a>00047         nLines    = 0;
<a name="l00048"></a>00048         done      = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00049"></a>00049         <span class="keywordflow">while</span>( !done ) {
<a name="l00050"></a>00050 
<a name="l00051"></a>00051             TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053             <span class="keywordflow">if</span> ( fgets( Line0, 256, fp ) == NULL) {         <span class="comment">// Try to read in Line 0</span>
<a name="l00054"></a>00054                 done = <a class="code" href="_lgm___c_trans_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00055"></a>00055             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fgets( Line1, 256, fp ) == NULL) {  <span class="comment">// Try to read in Line 1</span>
<a name="l00056"></a>00056                 done = <a class="code" href="_lgm___c_trans_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00057"></a>00057             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fgets( Line2, 256, fp ) == NULL) {  <span class="comment">// Try to read in Line 2</span>
<a name="l00058"></a>00058                 done = <a class="code" href="_lgm___c_trans_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00059"></a>00059             }
<a name="l00060"></a>00060 
<a name="l00061"></a>00061             <span class="keywordflow">if</span> (!done){
<a name="l00062"></a>00062 
<a name="l00063"></a>00063                 nLines += 3;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065                 <span class="comment">/*</span>
<a name="l00066"></a>00066 <span class="comment">                 * fgets also reads in the newline. Also it appears that the</span>
<a name="l00067"></a>00067 <span class="comment">                 * TLE files you often get are dos format with the CRLF (i.e.</span>
<a name="l00068"></a>00068 <span class="comment">                 * '\r\n') line terminators instead of the more sane linux/unix</span>
<a name="l00069"></a>00069 <span class="comment">                 * LF (i.e. '\n' ) line terminator. So, to fix this lets just</span>
<a name="l00070"></a>00070 <span class="comment">                 * replace any occurances of either with a string terminator</span>
<a name="l00071"></a>00071 <span class="comment">                 * (i.e. a '\0').  Then the string will be properly terminated</span>
<a name="l00072"></a>00072 <span class="comment">                 * if its a dos or linux style txt file.</span>
<a name="l00073"></a>00073 <span class="comment">                 */</span>
<a name="l00074"></a>00074                 <span class="keywordflow">if</span> ( (ptr = strstr(Line0, <span class="stringliteral">"\n"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>; <span class="keywordflow">if</span> ( (ptr = strstr(Line0, <span class="stringliteral">"\r"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>;
<a name="l00075"></a>00075                 <span class="keywordflow">if</span> ( (ptr = strstr(Line1, <span class="stringliteral">"\n"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>; <span class="keywordflow">if</span> ( (ptr = strstr(Line1, <span class="stringliteral">"\r"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>;
<a name="l00076"></a>00076                 <span class="keywordflow">if</span> ( (ptr = strstr(Line2, <span class="stringliteral">"\n"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>; <span class="keywordflow">if</span> ( (ptr = strstr(Line2, <span class="stringliteral">"\r"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078                 <span class="keywordflow">if</span> (Verbosity &gt; 3){
<a name="l00079"></a>00079                     printf(<span class="stringliteral">"Line0 = |%s|\n"</span>, Line0);
<a name="l00080"></a>00080                     printf(<span class="stringliteral">"Line1 = |%s|\n"</span>, Line1);
<a name="l00081"></a>00081                     printf(<span class="stringliteral">"Line2 = |%s|\n"</span>, Line2);
<a name="l00082"></a>00082                 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a>00085                 <span class="comment">/*</span>
<a name="l00086"></a>00086 <span class="comment">                 * Now, validate the lines. Must be a valid TLE to get added to</span>
<a name="l00087"></a>00087 <span class="comment">                 * the list of TLEs.</span>
<a name="l00088"></a>00088 <span class="comment">                 */</span>
<a name="l00089"></a>00089                 CheckSumRead1 = (int)(Line1[68]-<span class="charliteral">'0'</span>);
<a name="l00090"></a>00090                 CheckSumComp1 = <a class="code" href="_lgm___sgp_8h.html#6271ed7e00e88083593d9823dd3f5a9a">LgmSgp_TleChecksum</a>( Line1 );
<a name="l00091"></a>00091                 
<a name="l00092"></a>00092                 CheckSumRead2 = (int)(Line2[68]-<span class="charliteral">'0'</span>);
<a name="l00093"></a>00093                 CheckSumComp2 = <a class="code" href="_lgm___sgp_8h.html#6271ed7e00e88083593d9823dd3f5a9a">LgmSgp_TleChecksum</a>( Line2 );
<a name="l00094"></a>00094 
<a name="l00095"></a>00095                 <span class="keywordflow">if</span> ( Line1[0] != <span class="charliteral">'1'</span> ) {
<a name="l00096"></a>00096                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Format Error in Two Line Element.\n"</span>);
<a name="l00097"></a>00097                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    In file \"%s\", at line number %d, an assumed TLE Line#1 doesn't\n"</span>, Filename, nLines-1);
<a name="l00098"></a>00098                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    start with a `1'.\n"</span>);
<a name="l00099"></a>00099                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line1=\"%s\"\n\n"</span>, Line1);
<a name="l00100"></a>00100                     TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00101"></a>00101                 }
<a name="l00102"></a>00102                 <span class="keywordflow">if</span> ( CheckSumRead1 != CheckSumComp1 ) {
<a name="l00103"></a>00103                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Checksum Error in Two Line Element.\n"</span>);
<a name="l00104"></a>00104                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    In file \"%s\", at line number %d, an assumed TLE Line#1 doesn't\n"</span>, Filename, nLines-1);
<a name="l00105"></a>00105                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    have the correct Checksum. Read: %d, Computed: %d.\n"</span>, CheckSumRead1, CheckSumComp1);
<a name="l00106"></a>00106                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line1=\"%s\"\n\n"</span>, Line1);
<a name="l00107"></a>00107                     TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00108"></a>00108                 }
<a name="l00109"></a>00109                 <span class="keywordflow">if</span> ( Line2[0] != <span class="charliteral">'2'</span> ) {
<a name="l00110"></a>00110                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Format Error in Two Line Element.\n"</span>);
<a name="l00111"></a>00111                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    In file \"%s\", at line number %d, an assumed TLE Line#2 doesn't\n"</span>, Filename, nLines);
<a name="l00112"></a>00112                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    start with a `2'.\n"</span>);
<a name="l00113"></a>00113                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line2=\"%s\"\n\n"</span>, Line2);
<a name="l00114"></a>00114                     TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00115"></a>00115                 }
<a name="l00116"></a>00116                 <span class="keywordflow">if</span> ( CheckSumRead2 != CheckSumComp2 ) {
<a name="l00117"></a>00117                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Checksum Error in Two Line Element.\n"</span>);
<a name="l00118"></a>00118                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    In file \"%s\", at line number %d, an assumed TLE Line#2 doesn't\n"</span>, Filename, nLines);
<a name="l00119"></a>00119                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    have the correct Checksum. Read: %d, Computed: %d.\n"</span>, CheckSumRead2, CheckSumComp2);
<a name="l00120"></a>00120                     <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line2=\"%s\"\n\n"</span>, Line2);
<a name="l00121"></a>00121                     TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00122"></a>00122                 }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124                 <span class="keywordflow">if</span> (TLEValid) {
<a name="l00125"></a>00125 
<a name="l00126"></a>00126                     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\n\t\tAdding valid TLE to list. nTLEs = %d\n"</span>, *nTLEs);
<a name="l00127"></a>00127                     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t--------------------------------------\n"</span>);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129                     <span class="comment">// Finally decode the lines and dump into structure -- must be valid TLE at this point</span>
<a name="l00130"></a>00130                     <a class="code" href="_lgm___sgp_8h.html#1cdf495d9a7e1309a4b1ababdc14a64c">Lgm_SgpDecodeTle</a>( Line0, Line1, Line2, &amp;(TLEs[*nTLEs]), Verbosity );
<a name="l00131"></a>00131 
<a name="l00132"></a>00132                     ++(*nTLEs);
<a name="l00133"></a>00133                 }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135             }
<a name="l00136"></a>00136             
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         } 
<a name="l00139"></a>00139 
<a name="l00140"></a>00140         fclose(fp);
<a name="l00141"></a>00141         free(Line0);
<a name="l00142"></a>00142         free(Line1);
<a name="l00143"></a>00143         free(Line2);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <span class="keywordflow">return</span>(1);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="_lgm___sgp_8c.html#c8c62bf872785b575faa2f2c6093049a">00151</a> <span class="keywordtype">int</span> <a class="code" href="_lgm___sgp_8h.html#c8c62bf872785b575faa2f2c6093049a">LgmSgp_ReadTlesFromStrings</a>( <span class="keywordtype">char</span> *Line0, <span class="keywordtype">char</span> *Line1, <span class="keywordtype">char</span> *Line2, <span class="keywordtype">int</span> *nTLEs, <a class="code" href="struct___sgp_t_l_e.html">_SgpTLE</a> *TLEs, <span class="keywordtype">int</span> Verbosity ) {
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <span class="keywordtype">char</span>    *ptr;
<a name="l00154"></a>00154     <span class="keywordtype">int</span>     TLEValid, CheckSumRead1, CheckSumComp1;
<a name="l00155"></a>00155     <span class="keywordtype">int</span>     CheckSumRead2, CheckSumComp2;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">//    *nTLEs = 0;</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="comment">/*</span>
<a name="l00160"></a>00160 <span class="comment">     * fgets also reads in the newline. Also it appears that the</span>
<a name="l00161"></a>00161 <span class="comment">     * TLE files you often get are dos format with the CRLF (i.e.</span>
<a name="l00162"></a>00162 <span class="comment">     * '\r\n') line terminators instead of the more sane linux/unix</span>
<a name="l00163"></a>00163 <span class="comment">     * LF (i.e. '\n' ) line terminator. So, to fix this lets just</span>
<a name="l00164"></a>00164 <span class="comment">     * replace any occurances of either with a string terminator</span>
<a name="l00165"></a>00165 <span class="comment">     * (i.e. a '\0').  Then the string will be properly terminated</span>
<a name="l00166"></a>00166 <span class="comment">     * if its a dos or linux style txt file.</span>
<a name="l00167"></a>00167 <span class="comment">     */</span>
<a name="l00168"></a>00168     <span class="keywordflow">if</span> ( (ptr = strstr(Line0, <span class="stringliteral">"\n"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>; <span class="keywordflow">if</span> ( (ptr = strstr(Line0, <span class="stringliteral">"\r"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>;
<a name="l00169"></a>00169     <span class="keywordflow">if</span> ( (ptr = strstr(Line1, <span class="stringliteral">"\n"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>; <span class="keywordflow">if</span> ( (ptr = strstr(Line1, <span class="stringliteral">"\r"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>;
<a name="l00170"></a>00170     <span class="keywordflow">if</span> ( (ptr = strstr(Line2, <span class="stringliteral">"\n"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>; <span class="keywordflow">if</span> ( (ptr = strstr(Line2, <span class="stringliteral">"\r"</span>)) != NULL ) *ptr = <span class="charliteral">'\0'</span>;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     <span class="keywordflow">if</span> (Verbosity &gt; 3){
<a name="l00174"></a>00174         printf(<span class="stringliteral">"Line0 = |%s|\n"</span>, Line0);
<a name="l00175"></a>00175         printf(<span class="stringliteral">"Line1 = |%s|\n"</span>, Line1);
<a name="l00176"></a>00176         printf(<span class="stringliteral">"Line2 = |%s|\n"</span>, Line2);
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="comment">/*</span>
<a name="l00181"></a>00181 <span class="comment">     * Now, validate the lines. Must be a valid TLE to get added to</span>
<a name="l00182"></a>00182 <span class="comment">     * the list of TLEs.</span>
<a name="l00183"></a>00183 <span class="comment">     */</span>
<a name="l00184"></a>00184     CheckSumRead1 = (int)(Line1[68]-<span class="charliteral">'0'</span>);
<a name="l00185"></a>00185     CheckSumComp1 = <a class="code" href="_lgm___sgp_8h.html#6271ed7e00e88083593d9823dd3f5a9a">LgmSgp_TleChecksum</a>( Line1 );
<a name="l00186"></a>00186     
<a name="l00187"></a>00187     CheckSumRead2 = (int)(Line2[68]-<span class="charliteral">'0'</span>);
<a name="l00188"></a>00188     CheckSumComp2 = <a class="code" href="_lgm___sgp_8h.html#6271ed7e00e88083593d9823dd3f5a9a">LgmSgp_TleChecksum</a>( Line2 );
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00191"></a>00191     <span class="keywordflow">if</span> ( Line1[0] != <span class="charliteral">'1'</span> ) {
<a name="l00192"></a>00192         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Format Error in Two Line Element.\n"</span>);
<a name="l00193"></a>00193         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    TLE Line#1 doesn't\n"</span> );
<a name="l00194"></a>00194         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    start with a `1'.\n"</span>);
<a name="l00195"></a>00195         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line1=\"%s\"\n\n"</span>, Line1);
<a name="l00196"></a>00196         TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198     <span class="keywordflow">if</span> ( CheckSumRead1 != CheckSumComp1 ) {
<a name="l00199"></a>00199         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Checksum Error in Two Line Element.\n"</span>);
<a name="l00200"></a>00200         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    TLE Line#1 doesn't\n"</span>);
<a name="l00201"></a>00201         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    have the correct Checksum. Read: %d, Computed: %d.\n"</span>, CheckSumRead1, CheckSumComp1);
<a name="l00202"></a>00202         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line1=\"%s\"\n\n"</span>, Line1);
<a name="l00203"></a>00203         TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205     <span class="keywordflow">if</span> ( Line2[0] != <span class="charliteral">'2'</span> ) {
<a name="l00206"></a>00206         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Format Error in Two Line Element.\n"</span>);
<a name="l00207"></a>00207         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    TLE Line#2 doesn't\n"</span>);
<a name="l00208"></a>00208         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    start with a `2'.\n"</span>);
<a name="l00209"></a>00209         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line2=\"%s\"\n\n"</span>, Line2);
<a name="l00210"></a>00210         TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212     <span class="keywordflow">if</span> ( CheckSumRead2 != CheckSumComp2 ) {
<a name="l00213"></a>00213         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"LgmSgp_ReadTwoLineElements: Checksum Error in Two Line Element.\n"</span>);
<a name="l00214"></a>00214         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    TLE Line#2 doesn't\n"</span>);
<a name="l00215"></a>00215         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    have the correct Checksum. Read: %d, Computed: %d.\n"</span>, CheckSumRead2, CheckSumComp2);
<a name="l00216"></a>00216         <span class="keywordflow">if</span> (Verbosity &gt; 0) printf(<span class="stringliteral">"    Line2=\"%s\"\n\n"</span>, Line2);
<a name="l00217"></a>00217         TLEValid = <a class="code" href="_lgm___c_trans_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="keywordflow">if</span> (TLEValid) {
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\n\t\tAdding valid TLE to list. nTLEs = %d\n"</span>, *nTLEs);
<a name="l00223"></a>00223         <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t--------------------------------------\n"</span>);
<a name="l00224"></a>00224 
<a name="l00225"></a>00225         <span class="comment">// Finally decode the lines and dump into structure -- must be valid TLE at this point</span>
<a name="l00226"></a>00226         <a class="code" href="_lgm___sgp_8h.html#1cdf495d9a7e1309a4b1ababdc14a64c">Lgm_SgpDecodeTle</a>( Line0, Line1, Line2, &amp;(TLEs[*nTLEs]), Verbosity );
<a name="l00227"></a>00227 
<a name="l00228"></a>00228         ++(*nTLEs);
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     <span class="keywordflow">return</span>(1);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="comment">/*</span>
<a name="l00237"></a>00237 <span class="comment"> * Given Lines 0-2, decode the vals and populate vars in the _SgpTLE structure</span>
<a name="l00238"></a>00238 <span class="comment"> */</span>
<a name="l00239"></a><a class="code" href="_lgm___sgp_8c.html#1cdf495d9a7e1309a4b1ababdc14a64c">00239</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#1cdf495d9a7e1309a4b1ababdc14a64c">Lgm_SgpDecodeTle</a>( <span class="keywordtype">char</span> *Line0, <span class="keywordtype">char</span> *Line1, <span class="keywordtype">char</span> *Line2, <a class="code" href="struct___sgp_t_l_e.html">_SgpTLE</a> *TLE, <span class="keywordtype">int</span> Verbosity ) {
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     <span class="keywordtype">char</span>    str[40], *p;
<a name="l00242"></a>00242     <span class="keywordtype">int</span>     d2, yy, yyyy;
<a name="l00243"></a>00243     <span class="keywordtype">int</span>     hh, mm, ss;
<a name="l00244"></a>00244     <span class="keywordtype">long</span>    d1;
<a name="l00245"></a>00245     <a class="code" href="struct_lgm___c_trans.html">Lgm_CTrans</a> *c = <a class="code" href="_lgm___c_trans_8h.html#fcde56b5112b21766bf3569c62d6ab0b">Lgm_init_ctrans</a>(0); <span class="comment">// need this for JD calcs</span>
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">/*</span>
<a name="l00248"></a>00248 <span class="comment">     *  DECODE LINE 0</span>
<a name="l00249"></a>00249 <span class="comment">     */</span>
<a name="l00250"></a>00250     <span class="comment">// Save the 3 lines</span>
<a name="l00251"></a>00251     strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#e82736c1760be22e457d9d40dbeb39b6">Line0</a>, Line0 );
<a name="l00252"></a>00252     strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#793987b1643141f9bec4786e272d1244">Line1</a>, Line1 );
<a name="l00253"></a>00253     strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#05f315119f6d3da73fc77ce525f8d373">Line2</a>, Line2 );
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="comment">// Object name</span>
<a name="l00256"></a>00256     strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#d1f4d8ec802a30593b1aadbaf41aa205">Name</a>, Line0 );
<a name="l00257"></a>00257     strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#70ff42494dd6b9ce04f0465a4cecc1bc">ObjectType</a>, <span class="stringliteral">"SAT"</span>); 
<a name="l00258"></a>00258     <span class="keywordflow">if</span> ( (p = strstr( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#d1f4d8ec802a30593b1aadbaf41aa205">Name</a>, <span class="stringliteral">" DEB"</span> )) ) {
<a name="l00259"></a>00259         <span class="keywordflow">if</span> ( ( p[4] == <span class="charliteral">' '</span> ) || ( p[4] == <span class="charliteral">'\0'</span> ) ) strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#70ff42494dd6b9ce04f0465a4cecc1bc">ObjectType</a>, <span class="stringliteral">"DEB"</span>);
<a name="l00260"></a>00260     } 
<a name="l00261"></a>00261     <span class="keywordflow">if</span>  ( strstr( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#d1f4d8ec802a30593b1aadbaf41aa205">Name</a>, <span class="stringliteral">"R/B"</span> ) ) strcpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#70ff42494dd6b9ce04f0465a4cecc1bc">ObjectType</a>, <span class="stringliteral">"R/B"</span>);
<a name="l00262"></a>00262     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tObject Name     = %s (Object Type = %s)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#d1f4d8ec802a30593b1aadbaf41aa205">Name</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#70ff42494dd6b9ce04f0465a4cecc1bc">ObjectType</a>);
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <span class="comment">/*</span>
<a name="l00265"></a>00265 <span class="comment">     *  DECODE LINE 1</span>
<a name="l00266"></a>00266 <span class="comment">     */</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="comment">// Object ID number</span>
<a name="l00269"></a>00269     strncpy( str, Line1+2, 5 ); str[5] = <span class="charliteral">'\0'</span>; <span class="comment">// be careful! strncpy doesnt NULL-terminate strings</span>
<a name="l00270"></a>00270     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8134db9bcf3428082c18dba769258dfd">IdNumber</a> = atoi(str);
<a name="l00271"></a>00271     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tIdNumber        = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8134db9bcf3428082c18dba769258dfd">IdNumber</a>);
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <span class="comment">// Elset Classification</span>
<a name="l00274"></a>00274     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#27655aa07b94161a7cad6c42562c2fd6">ElsetClass</a> = Line1[7];
<a name="l00275"></a>00275     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tElsetClass      = %c\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#27655aa07b94161a7cad6c42562c2fd6">ElsetClass</a>);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     <span class="comment">//  International Designator</span>
<a name="l00278"></a>00278     strncpy( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a15ad7195fd3d6ea5481548706bf091">IntDesig</a>, Line1+9, 8 ); TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a15ad7195fd3d6ea5481548706bf091">IntDesig</a>[8] = <span class="charliteral">'\0'</span>;
<a name="l00279"></a>00279     yy = (int)(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a15ad7195fd3d6ea5481548706bf091">IntDesig</a>[0] -<span class="charliteral">'0'</span>)*10 + (int)(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a15ad7195fd3d6ea5481548706bf091">IntDesig</a>[1] -<span class="charliteral">'0'</span>);
<a name="l00280"></a>00280     yyyy = (yy&lt;50) ? 2000+yy : 1900+yy;
<a name="l00281"></a>00281     sprintf( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#37b8c7421d0ac1fad2e300ce2f39d03c">IntDesig2</a>, <span class="stringliteral">"%4d-%s"</span>, yyyy, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a15ad7195fd3d6ea5481548706bf091">IntDesig</a>[2]) );
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tIntDesig        = %s  (%s)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a15ad7195fd3d6ea5481548706bf091">IntDesig</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#37b8c7421d0ac1fad2e300ce2f39d03c">IntDesig2</a>);
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     <span class="comment">// Element Set Epoch (UTC) (also decode into other date formats)</span>
<a name="l00285"></a>00285     strncpy( str, Line1+18, 14 ); str[14] = <span class="charliteral">'\0'</span>;
<a name="l00286"></a>00286     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9292d9013dff34d350a2dd9bf102eb6d">ElementSetEpoch</a>));
<a name="l00287"></a>00287     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tElementSetEpoch = %14.8lf\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9292d9013dff34d350a2dd9bf102eb6d">ElementSetEpoch</a>);
<a name="l00288"></a>00288     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8c1b7b17183e48a6fafaf6302e1b1da9">Date</a> = (<span class="keywordtype">long</span> int)TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9292d9013dff34d350a2dd9bf102eb6d">ElementSetEpoch</a>;
<a name="l00289"></a>00289     if ( ((<span class="keywordtype">int</span>)(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8c1b7b17183e48a6fafaf6302e1b1da9">Date</a>/1000.0)) &lt; 50 ) TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8c1b7b17183e48a6fafaf6302e1b1da9">Date</a> += 2000000;
<a name="l00290"></a>00290     d1 = (<span class="keywordtype">int</span>)TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9292d9013dff34d350a2dd9bf102eb6d">ElementSetEpoch</a>;
<a name="l00291"></a>00291     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#729fdcc4d138ef63b0baba5e9af8da26">UT</a> = (TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9292d9013dff34d350a2dd9bf102eb6d">ElementSetEpoch</a> - (double)d1)*24.0;
<a name="l00292"></a>00292     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t          Date  = %ld\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8c1b7b17183e48a6fafaf6302e1b1da9">Date</a>);
<a name="l00293"></a>00293     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t            UT  = %lf\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#729fdcc4d138ef63b0baba5e9af8da26">UT</a>);
<a name="l00294"></a>00294     <a class="code" href="_lgm___c_trans_8h.html#104fe1084e885dd5b4e9d7421ee361a2">Lgm_Doy</a>( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8c1b7b17183e48a6fafaf6302e1b1da9">Date</a>, &amp;TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#42e645110404fbf4f10235789577fa32">Year</a>, &amp;TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#530b376ec91a278ac98531d3ea17f148">Month</a>, &amp;TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8f67164de537e3ec2b47e3204ddd3400">Day</a>, &amp;TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#72a1d4d4121176f8cf34faa09b5b4982">Doy</a>);
<a name="l00295"></a>00295     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t          Year  = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#42e645110404fbf4f10235789577fa32">Year</a>);
<a name="l00296"></a>00296     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t         Month  = %d (%s)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#530b376ec91a278ac98531d3ea17f148">Month</a>, MonStr1[TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#530b376ec91a278ac98531d3ea17f148">Month</a>-1]);
<a name="l00297"></a>00297     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t           Day  = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8f67164de537e3ec2b47e3204ddd3400">Day</a>);
<a name="l00298"></a>00298     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t           Doy  = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#72a1d4d4121176f8cf34faa09b5b4982">Doy</a>);
<a name="l00299"></a>00299     <a class="code" href="_lgm___c_trans_8h.html#38f91ae9f05bbcd134091cea464ee003">Lgm_DayOfWeek</a>( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#42e645110404fbf4f10235789577fa32">Year</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#530b376ec91a278ac98531d3ea17f148">Month</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8f67164de537e3ec2b47e3204ddd3400">Day</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#2837532bf73f7b76480715042d548d63">Dow</a>);
<a name="l00300"></a>00300     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t           Dow  = %s\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#2837532bf73f7b76480715042d548d63">Dow</a>);
<a name="l00301"></a>00301     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#fca64005cd84fa9e811dac5219a618ad">JD</a> = <a class="code" href="_lgm___c_trans_8h.html#73a444d73b7a1119517c60f5a070cc9d">Lgm_JD</a>( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#42e645110404fbf4f10235789577fa32">Year</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#530b376ec91a278ac98531d3ea17f148">Month</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8f67164de537e3ec2b47e3204ddd3400">Day</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#729fdcc4d138ef63b0baba5e9af8da26">UT</a>, <a class="code" href="_lgm___c_trans_8h.html#b437ee7a4acdc0a259414f0dc24151ec">LGM_TIME_SYS_UTC</a>, c );
<a name="l00302"></a>00302     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t    Julian Date = %.12lf\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#fca64005cd84fa9e811dac5219a618ad">JD</a>);
<a name="l00303"></a>00303     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#f6a8f0b6159c1b5df5c8f6334b4002db">YYYYDDDdFRAC</a> = TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#42e645110404fbf4f10235789577fa32">Year</a>*1000.0 + (double)TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#72a1d4d4121176f8cf34faa09b5b4982">Doy</a> + TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#729fdcc4d138ef63b0baba5e9af8da26">UT</a>/24.0;
<a name="l00304"></a>00304     if (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t   YYYYDDD.FRAC = %.12lf\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#f6a8f0b6159c1b5df5c8f6334b4002db">YYYYDDDdFRAC</a>);
<a name="l00305"></a>00305     <a class="code" href="_lgm___c_trans_8h.html#4c5eb958c42764eb7c98c2209a191d6e">Lgm_UT_to_HMS</a>( TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#729fdcc4d138ef63b0baba5e9af8da26">UT</a>, &amp;hh, &amp;mm, &amp;ss );
<a name="l00306"></a>00306     sprintf(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#b6d6f17aac13c3765520b602f44b21be">EpochStr</a>, <span class="stringliteral">"%4d%02d%02d %02d:%02d:%02d"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#42e645110404fbf4f10235789577fa32">Year</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#530b376ec91a278ac98531d3ea17f148">Month</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#8f67164de537e3ec2b47e3204ddd3400">Day</a>, hh, mm, ss );
<a name="l00307"></a>00307     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\t       EpochStr = %s\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#b6d6f17aac13c3765520b602f44b21be">EpochStr</a>);
<a name="l00308"></a>00308         
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="comment">//  1st Derivative of the Mean Motion with respect to Time</span>
<a name="l00311"></a>00311     strncpy( str, Line1+33, 10 ); str[10] = <span class="charliteral">'\0'</span>;
<a name="l00312"></a>00312     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#0ffa4eb7b3b12cc2c8c51d6c300ca61a">dMMdT1</a>));
<a name="l00313"></a>00313     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tdMMdT1          = %14.8lf\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#0ffa4eb7b3b12cc2c8c51d6c300ca61a">dMMdT1</a>);
<a name="l00314"></a>00314     
<a name="l00315"></a>00315     <span class="comment">//  2nd Derivative of the Mean Motion with respect to Time</span>
<a name="l00316"></a>00316     strncpy( str, Line1+44, 6 ); str[6] = <span class="charliteral">'\0'</span>; d1 = atol( str ); <span class="comment">// mantissa (*1e5 because theres no leading decimal yet)</span>
<a name="l00317"></a>00317     strncpy( str, Line1+50, 2 ); str[2] = <span class="charliteral">'\0'</span>; d2 = atoi( str ); <span class="comment">// exponent</span>
<a name="l00318"></a>00318     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#eaac5f4f09ca804c3373fe4f78e8a96b">dMMdT2</a> = (double)d1*pow(10.0, (<span class="keywordtype">double</span>)d2-5.0 );
<a name="l00319"></a>00319     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tdMMdT2          = %14.5e\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#eaac5f4f09ca804c3373fe4f78e8a96b">dMMdT2</a>);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321     <span class="comment">//  B* Drag Term</span>
<a name="l00322"></a>00322     strncpy( str, Line1+53, 6 ); str[6] = <span class="charliteral">'\0'</span>; d1 = atol( str ); <span class="comment">// mantissa (*1e5 because theres no leading decimal yet)</span>
<a name="l00323"></a>00323     strncpy( str, Line1+59, 2 ); str[2] = <span class="charliteral">'\0'</span>; d2 = atoi( str ); <span class="comment">// exponent</span>
<a name="l00324"></a>00324     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#542efb643c91709b678e9a08a27d9e40">BstarDrag</a> = (double)d1*pow(10.0, (<span class="keywordtype">double</span>)d2-5.0 );
<a name="l00325"></a>00325     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tBstarDrag       = %14.5e\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#542efb643c91709b678e9a08a27d9e40">BstarDrag</a>);
<a name="l00326"></a>00326 
<a name="l00327"></a>00327     <span class="comment">// Element Set Type</span>
<a name="l00328"></a>00328     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#c036ab9b5a5d2885f7739225bdebfe4e">ElementSetType</a> = (int)(Line1[62] - <span class="charliteral">'0'</span>);
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tElementSetType  = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#c036ab9b5a5d2885f7739225bdebfe4e">ElementSetType</a>);
<a name="l00330"></a>00330     
<a name="l00331"></a>00331     <span class="comment">// Element Number</span>
<a name="l00332"></a>00332     strncpy( str, Line1+64, 4 ); str[4] = <span class="charliteral">'\0'</span>;
<a name="l00333"></a>00333     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#792ff599d71797b42592d89cc27fa00c">ElementSetNum</a> = atoi(str);
<a name="l00334"></a>00334     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tElementSetNum   = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#792ff599d71797b42592d89cc27fa00c">ElementSetNum</a>);
<a name="l00335"></a>00335     
<a name="l00336"></a>00336     <span class="comment">// Line1 Checksum</span>
<a name="l00337"></a>00337     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#43803c19029852338bbb6ec4b9c13381">Line1CheckSum</a> = (int)(Line1[68] - <span class="charliteral">'0'</span>);
<a name="l00338"></a>00338     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tLine1CheckSum   = %d (passed)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#43803c19029852338bbb6ec4b9c13381">Line1CheckSum</a>);
<a name="l00339"></a>00339 
<a name="l00340"></a>00340     <span class="comment">/*</span>
<a name="l00341"></a>00341 <span class="comment">     *  DECODE LINE 2</span>
<a name="l00342"></a>00342 <span class="comment">     */</span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344     <span class="comment">//  Orbit Inclination (degrees)</span>
<a name="l00345"></a>00345     strncpy( str, Line2+8, 8 ); str[8] = <span class="charliteral">'\0'</span>;
<a name="l00346"></a>00346     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#dc4143d3dcc5a8a32498a8d172e0d394">Inclination</a>));
<a name="l00347"></a>00347     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tInclination     = %14.8lf (degrees)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#dc4143d3dcc5a8a32498a8d172e0d394">Inclination</a>);
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <span class="comment">// Right Ascension of Ascending Node (degrees)</span>
<a name="l00350"></a>00350     strncpy( str, Line2+17, 8 ); str[8] = <span class="charliteral">'\0'</span>;
<a name="l00351"></a>00351     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#32a0bdaab6be58e1e601ee6c236c681e">RAofAscNode</a>));
<a name="l00352"></a>00352     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tRAofAscNode     = %14.8lf (degrees)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#32a0bdaab6be58e1e601ee6c236c681e">RAofAscNode</a>);
<a name="l00353"></a>00353     
<a name="l00354"></a>00354     <span class="comment">// Eccentricity</span>
<a name="l00355"></a>00355     strncpy( str, Line2+26, 7 ); str[7] = <span class="charliteral">'\0'</span>; d1 = atol( str ); <span class="comment">// mantissa (*1e7 because theres no leading decimal yet)</span>
<a name="l00356"></a>00356     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9e8627236231ee5feff425a382c3cc0d">Eccentricity</a> = (double)d1*1e-7;
<a name="l00357"></a>00357     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tEccentricity    = %14.8lf\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#9e8627236231ee5feff425a382c3cc0d">Eccentricity</a>);
<a name="l00358"></a>00358     
<a name="l00359"></a>00359     <span class="comment">// Argument of Perigee (degrees)</span>
<a name="l00360"></a>00360     strncpy( str, Line2+34, 8 ); str[8] = <span class="charliteral">'\0'</span>;
<a name="l00361"></a>00361     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#faafa77786dcba9c30db49ee397f3bdc">ArgOfPerigee</a>));
<a name="l00362"></a>00362     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tArgOfPerigee    = %14.8lf (degrees)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#faafa77786dcba9c30db49ee397f3bdc">ArgOfPerigee</a>);
<a name="l00363"></a>00363     
<a name="l00364"></a>00364     <span class="comment">// Mean Anomaly (degrees)</span>
<a name="l00365"></a>00365     strncpy( str, Line2+43, 8 ); str[8] = <span class="charliteral">'\0'</span>;
<a name="l00366"></a>00366     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#d3d6acdadbbc8715b238f8f6fbf4d4a8">MeanAnomaly</a>));
<a name="l00367"></a>00367     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tMeanAnomaly     = %14.8lf (degrees)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#d3d6acdadbbc8715b238f8f6fbf4d4a8">MeanAnomaly</a>);
<a name="l00368"></a>00368     
<a name="l00369"></a>00369     <span class="comment">// Mean Motion (revolutions/day)</span>
<a name="l00370"></a>00370     strncpy( str, Line2+52, 11 ); str[11] = <span class="charliteral">'\0'</span>;
<a name="l00371"></a>00371     sscanf( str, <span class="stringliteral">"%lf"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#a8230c8489edeb8a5e009088180c9d12">MeanMotion</a>));
<a name="l00372"></a>00372     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a64c0f7b4ac76464f9118ce94ad8f3e">Period</a> = 1440.0/TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#a8230c8489edeb8a5e009088180c9d12">MeanMotion</a>; <span class="comment">// period in minutes</span>
<a name="l00373"></a>00373     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tMeanMotion      = %14.8lf (revs/day)  (Period = %g min)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#a8230c8489edeb8a5e009088180c9d12">MeanMotion</a>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3a64c0f7b4ac76464f9118ce94ad8f3e">Period</a>);
<a name="l00374"></a>00374     
<a name="l00375"></a>00375     <span class="comment">// Revolution Number at Epoch</span>
<a name="l00376"></a>00376     strncpy( str, Line2+63, 5 ); str[5] = <span class="charliteral">'\0'</span>;
<a name="l00377"></a>00377     sscanf( str, <span class="stringliteral">"%d"</span>, &amp;(TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#f19e71600e08a125e2e15bb43663cb63">RevNumAtEpoch</a>));
<a name="l00378"></a>00378     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tRevNumAtEpoch   = %d\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#f19e71600e08a125e2e15bb43663cb63">RevNumAtEpoch</a>);
<a name="l00379"></a>00379     
<a name="l00380"></a>00380     <span class="comment">// Line2 Checksum</span>
<a name="l00381"></a>00381     TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3630c8fcee279a2fa0698fa9b7748cf3">Line2CheckSum</a> = (int)(Line2[68] - <span class="charliteral">'0'</span>);
<a name="l00382"></a>00382     <span class="keywordflow">if</span> (Verbosity &gt; 3) printf(<span class="stringliteral">"\t\tLine2CheckSum   = %d (passed)\n"</span>, TLE-&gt;<a class="code" href="struct___sgp_t_l_e.html#3630c8fcee279a2fa0698fa9b7748cf3">Line2CheckSum</a>);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     <a class="code" href="_lgm___c_trans_8h.html#5434c56ab7ae78cd7186d0c9dc17004c">Lgm_free_ctrans</a>( c );
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00390"></a>00390 <span class="comment">*</span>
<a name="l00391"></a>00391 <span class="comment">* function gstime</span>
<a name="l00392"></a>00392 <span class="comment">*</span>
<a name="l00393"></a>00393 <span class="comment">* this function finds the greenwich sidereal time.</span>
<a name="l00394"></a>00394 <span class="comment">*</span>
<a name="l00395"></a>00395 <span class="comment">* author : david vallado 719-573-2600 1 mar 2001</span>
<a name="l00396"></a>00396 <span class="comment">*</span>
<a name="l00397"></a>00397 <span class="comment">* inputs description range / units</span>
<a name="l00398"></a>00398 <span class="comment">* jdut1 - julian date in ut1 days from 4713 bc</span>
<a name="l00399"></a>00399 <span class="comment">*</span>
<a name="l00400"></a>00400 <span class="comment">* outputs :</span>
<a name="l00401"></a>00401 <span class="comment">* gstime - greenwich sidereal time 0 to 2pi rad</span>
<a name="l00402"></a>00402 <span class="comment">*</span>
<a name="l00403"></a>00403 <span class="comment">* locals :</span>
<a name="l00404"></a>00404 <span class="comment">* temp - temporary variable for doubles rad</span>
<a name="l00405"></a>00405 <span class="comment">* tut1 - julian centuries from the</span>
<a name="l00406"></a>00406 <span class="comment">* jan 1, 2000 12 h epoch (ut1)</span>
<a name="l00407"></a>00407 <span class="comment">*</span>
<a name="l00408"></a>00408 <span class="comment">* coupling :</span>
<a name="l00409"></a>00409 <span class="comment">* none</span>
<a name="l00410"></a>00410 <span class="comment">*</span>
<a name="l00411"></a>00411 <span class="comment">* references :</span>
<a name="l00412"></a>00412 <span class="comment">* vallado 2004, 191, eq 3-45</span>
<a name="l00413"></a>00413 <span class="comment">* --------------------------------------------------------------------------- */</span>
<a name="l00414"></a><a class="code" href="_lgm___sgp_8c.html#4226a319104ba9b36b55e73a4c1d0d30">00414</a> <span class="keywordtype">double</span> <a class="code" href="_lgm___sgp_8h.html#4226a319104ba9b36b55e73a4c1d0d30">LgmSgp_gstime</a>( <span class="keywordtype">double</span> jdut1) {
<a name="l00415"></a>00415 
<a name="l00416"></a>00416     <span class="keyword">const</span> <span class="keywordtype">double</span>    deg2rad = <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.0;
<a name="l00417"></a>00417     <span class="keywordtype">double</span>          temp, tut1;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     tut1 = (jdut1 - 2451545.0) / 36525.0;
<a name="l00420"></a>00420     temp = -6.2e-6*tut1*tut1*tut1 + 0.093104*tut1*tut1 + (876600.0*3600 + 8640184.812866)*tut1 + 67310.54841; <span class="comment">// sec</span>
<a name="l00421"></a>00421     temp = fmod(temp*deg2rad / 240.0, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>); <span class="comment">//360/86400 = 1/240, to deg, to rad</span>
<a name="l00422"></a>00422 
<a name="l00423"></a>00423     <span class="comment">// ------------------------ check quadrants ---------------------</span>
<a name="l00424"></a>00424     <span class="keywordflow">if</span> (temp &lt; 0.0) temp += <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426     <span class="keywordflow">return</span>( temp );
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 } <span class="comment">// end gstime</span>
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l00432"></a>00432 <span class="comment">*</span>
<a name="l00433"></a>00433 <span class="comment">* procedure dpper</span>
<a name="l00434"></a>00434 <span class="comment">*</span>
<a name="l00435"></a>00435 <span class="comment">* this procedure provides deep space long period periodic contributions</span>
<a name="l00436"></a>00436 <span class="comment">* to the mean elements. by design, these periodics are zero at epoch.</span>
<a name="l00437"></a>00437 <span class="comment">* this used to be dscom which included initialization, but it's really a</span>
<a name="l00438"></a>00438 <span class="comment">* recurring function.</span>
<a name="l00439"></a>00439 <span class="comment">*</span>
<a name="l00440"></a>00440 <span class="comment">* author : david vallado 719-573-2600 28 jun 2005</span>
<a name="l00441"></a>00441 <span class="comment">*</span>
<a name="l00442"></a>00442 <span class="comment">* inputs (used):</span>
<a name="l00443"></a>00443 <span class="comment">*     from structure, s: e3, ee2, peo, pgho, pho, pinco, plo, se2, se3, sgh2, sgh3, sgh4, </span>
<a name="l00444"></a>00444 <span class="comment">*                     sh2, sh3, si2, si3, sl2, sl3, sl4, t, xh2, xh3, xi2, xi3, xl2, </span>
<a name="l00445"></a>00445 <span class="comment">*                     xl3, xl4, zmol, zmos</span>
<a name="l00446"></a>00446 <span class="comment"></span>
<a name="l00447"></a>00447 <span class="comment">*     inclo - inclination - needed for lyddane modification (pass by value -- not changed)</span>
<a name="l00448"></a>00448 <span class="comment">*     init  - init flag (pass by value -- not changed)</span>
<a name="l00449"></a>00449 <span class="comment">*     ep    - eccentricity 0.0 - 1.0</span>
<a name="l00450"></a>00450 <span class="comment">*     nodep - right ascension of ascending node</span>
<a name="l00451"></a>00451 <span class="comment">*     argpp - argument of perigee</span>
<a name="l00452"></a>00452 <span class="comment">*     mp    - mean anomaly</span>
<a name="l00453"></a>00453 <span class="comment">*</span>
<a name="l00454"></a>00454 <span class="comment">* outputs :</span>
<a name="l00455"></a>00455 <span class="comment">*     ep    - eccentricity 0.0 - 1.0</span>
<a name="l00456"></a>00456 <span class="comment">*     inclp - inclination</span>
<a name="l00457"></a>00457 <span class="comment">*     nodep - right ascension of ascending node</span>
<a name="l00458"></a>00458 <span class="comment">*     argpp - argument of perigee</span>
<a name="l00459"></a>00459 <span class="comment">*     mp    - mean anomaly</span>
<a name="l00460"></a>00460 <span class="comment">*</span>
<a name="l00461"></a>00461 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l00462"></a><a class="code" href="_lgm___sgp_8c.html#3a3d1ab6587159dd6059bf83aa4b6924">00462</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#3a3d1ab6587159dd6059bf83aa4b6924">LgmSgp_dpper</a>( <span class="keywordtype">double</span> inclo, <span class="keywordtype">char</span> init, <span class="keywordtype">double</span> *ep, <span class="keywordtype">double</span> *inclp, <span class="keywordtype">double</span> *nodep, <span class="keywordtype">double</span> *argpp, <span class="keywordtype">double</span> *mp, <a class="code" href="struct___sgp_info.html">_SgpInfo</a> *s ){
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l00466"></a>00466     <span class="keywordtype">char</span>        ildm;
<a name="l00467"></a>00467     <span class="keywordtype">double</span>      alfdp, betdp, cosip, cosop, dalf, dbet, dls;
<a name="l00468"></a>00468     <span class="keywordtype">double</span>      f2, f3, pe, pgh, ph, pinc, pl;
<a name="l00469"></a>00469     <span class="keywordtype">double</span>      sel, ses, sghl, sghs, shll, shs, sil;
<a name="l00470"></a>00470     <span class="keywordtype">double</span>      sinip, sinop, sinzf, sis, sll, sls, xls;
<a name="l00471"></a>00471     <span class="keywordtype">double</span>      xnoh, zf, zm, zel, zes, znl, zns, t;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="comment">/* ---------------------- constants ----------------------------- */</span>
<a name="l00474"></a>00474     zns = 1.19459e-5;
<a name="l00475"></a>00475     zes = 0.01675;
<a name="l00476"></a>00476     znl = 1.5835218e-4;
<a name="l00477"></a>00477     zel = 0.05490;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="comment">/* --------------- calculate time varying periodics ----------- */</span>
<a name="l00480"></a>00480     t = s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l00481"></a>00481     zm = s-&gt;<a class="code" href="struct___sgp_info.html#1840b955ac5e5eb7d015f46051df589f">zmos</a> + zns*t;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="comment">// be sure that the initial call has time set to zero</span>
<a name="l00484"></a>00484     <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#6a9691d2260a0c4c1a531b79d708520a">init</a> == <span class="charliteral">'y'</span>) zm = s-&gt;<a class="code" href="struct___sgp_info.html#1840b955ac5e5eb7d015f46051df589f">zmos</a>;
<a name="l00485"></a>00485     zf     = zm + 2.0*zes*sin(zm);
<a name="l00486"></a>00486     sinzf = sin(zf);
<a name="l00487"></a>00487     f2    = 0.5*sinzf*sinzf - 0.25;
<a name="l00488"></a>00488     f3    = -0.5*sinzf*cos(zf);
<a name="l00489"></a>00489     ses   = s-&gt;<a class="code" href="struct___sgp_info.html#5a7f7150e4e1afe1ca272a66d2618936">se2</a>* f2 + s-&gt;<a class="code" href="struct___sgp_info.html#7881e839568571e07c209edcdf9ac468">se3</a>*f3;
<a name="l00490"></a>00490     sis   = s-&gt;<a class="code" href="struct___sgp_info.html#61a1945bc1d3f4c395b657c4203ceb2a">si2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#5e144ba52a7d297f9c6dfcd5380e49d1">si3</a>*f3;
<a name="l00491"></a>00491     sls   = s-&gt;<a class="code" href="struct___sgp_info.html#24aba20cbbf42da0d081954b34834924">sl2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#18b9a2f918f88752c91b220bf3531d31">sl3</a>*f3 + s-&gt;<a class="code" href="struct___sgp_info.html#234f391445ad2c9894442de5280d0559">sl4</a>*sinzf;
<a name="l00492"></a>00492     sghs  = s-&gt;<a class="code" href="struct___sgp_info.html#77544b4b59fd16ed1ac93adfee0eb997">sgh2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#d42d32067016e78f4583075ea03773b2">sgh3</a>*f3 + s-&gt;<a class="code" href="struct___sgp_info.html#8333fff103deda5ec256d39b38beabf3">sgh4</a>*sinzf;
<a name="l00493"></a>00493     shs   = s-&gt;<a class="code" href="struct___sgp_info.html#f39a6d6ec64bcb919784f1c046a5031d">sh2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#9081e5546a5c993436dcc994592f0c7a">sh3</a>*f3;
<a name="l00494"></a>00494     zm    = s-&gt;<a class="code" href="struct___sgp_info.html#0c8d59633bdce5d61494b16c884903bd">zmol</a> + znl*t;
<a name="l00495"></a>00495     <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#6a9691d2260a0c4c1a531b79d708520a">init</a> == <span class="charliteral">'y'</span>) zm = s-&gt;<a class="code" href="struct___sgp_info.html#0c8d59633bdce5d61494b16c884903bd">zmol</a>;
<a name="l00496"></a>00496     zf    = zm + 2.0*zel*sin(zm);
<a name="l00497"></a>00497     sinzf = sin(zf);
<a name="l00498"></a>00498     f2    = 0.5*sinzf*sinzf - 0.25;
<a name="l00499"></a>00499     f3    = -0.5*sinzf*cos(zf);
<a name="l00500"></a>00500     sel   = s-&gt;<a class="code" href="struct___sgp_info.html#3907e33c8e58cb154a33174dd8e78179">ee2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#ff99da95c225d58a2c9acf9aa04a267b">e3</a>*f3;
<a name="l00501"></a>00501     sil   = s-&gt;<a class="code" href="struct___sgp_info.html#c3b4de799b764c0819cffc7166a2df10">xi2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#90e3204b70e2fc9053c1879656ca4bc7">xi3</a>*f3;
<a name="l00502"></a>00502     sll   = s-&gt;<a class="code" href="struct___sgp_info.html#965576393853e94605542dbd4df08cfe">xl2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#db2bab7e771a89101eaf1dd3d527fcf3">xl3</a>*f3 + s-&gt;<a class="code" href="struct___sgp_info.html#5233fa6736de1f47b91f58865ea7cb80">xl4</a>*sinzf;
<a name="l00503"></a>00503     sghl  = s-&gt;<a class="code" href="struct___sgp_info.html#12cc589dda276aa5ae735902e6778b7c">xgh2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#e49feebf68831d39731fa268baba51c1">xgh3</a>*f3 + s-&gt;<a class="code" href="struct___sgp_info.html#c1fc37ddfcd1eb053bb240d30083455d">xgh4</a>*sinzf;
<a name="l00504"></a>00504     shll  = s-&gt;<a class="code" href="struct___sgp_info.html#1ae6115c362e5b5450b515b208f46764">xh2</a>*f2 + s-&gt;<a class="code" href="struct___sgp_info.html#b8a252c46a5859f5f5f5f7a3bb0ed3b8">xh3</a>*f3;
<a name="l00505"></a>00505     pe    = ses + sel;
<a name="l00506"></a>00506     pinc  = sis + sil;
<a name="l00507"></a>00507     pl    = sls + sll;
<a name="l00508"></a>00508     pgh   = sghs + sghl;
<a name="l00509"></a>00509     ph    = shs + shll;
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#6a9691d2260a0c4c1a531b79d708520a">init</a> == <span class="charliteral">'n'</span>) {
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         <span class="comment">// 0.2 rad = 11.45916 deg</span>
<a name="l00515"></a>00515         <span class="comment">// sgp4fix for lyddane choice</span>
<a name="l00516"></a>00516         <span class="comment">// add next three lines to set up use of original inclination per strn3 ver</span>
<a name="l00517"></a>00517         ildm = <span class="charliteral">'y'</span>;
<a name="l00518"></a>00518         <span class="keywordflow">if</span> (inclo &gt;= 0.2) ildm = <span class="charliteral">'n'</span>;
<a name="l00519"></a>00519         pe    -= s-&gt;<a class="code" href="struct___sgp_info.html#689de6e0b3caffccb68dcee94abb1018">peo</a>;
<a name="l00520"></a>00520         pinc  -= s-&gt;<a class="code" href="struct___sgp_info.html#3063db50044a10a1805f09ec06904db9">pinco</a>;
<a name="l00521"></a>00521         pl    -= s-&gt;<a class="code" href="struct___sgp_info.html#7ad4147f4ca4a74315a064ca7b1817f5">plo</a>;
<a name="l00522"></a>00522         pgh   -= s-&gt;<a class="code" href="struct___sgp_info.html#f56cf39324cbf2fe295bf84dc69e3e8f">pgho</a>;
<a name="l00523"></a>00523         ph    -= s-&gt;<a class="code" href="struct___sgp_info.html#6455bb211516d721115c708d51f5beec">pho</a>;
<a name="l00524"></a>00524         *inclp += pinc;
<a name="l00525"></a>00525         *ep    += pe;
<a name="l00526"></a>00526         sinip = sin(*inclp);
<a name="l00527"></a>00527         cosip = cos(*inclp);
<a name="l00528"></a>00528         <span class="comment">/* ----------------- apply periodics directly ------------ */</span>
<a name="l00529"></a>00529         <span class="comment">// sgp4fix for lyddane choice</span>
<a name="l00530"></a>00530         <span class="comment">// strn3 used original inclination - this is technically feasible</span>
<a name="l00531"></a>00531         <span class="comment">// gsfc used perturbed inclination - also technically feasible</span>
<a name="l00532"></a>00532         <span class="comment">// probably best to readjust the 0.2 limit value and limit discontinuity</span>
<a name="l00533"></a>00533         <span class="comment">// use next line for original strn3 approach and original inclination</span>
<a name="l00534"></a>00534         <span class="comment">// if (inclo &gt;= 0.2)</span>
<a name="l00535"></a>00535         <span class="comment">// use next line for gsfc version and perturbed inclination</span>
<a name="l00536"></a>00536         <span class="keywordflow">if</span> (*inclp &gt;= 0.2) {
<a name="l00537"></a>00537 
<a name="l00538"></a>00538             ph    /= sinip;
<a name="l00539"></a>00539             pgh   -= cosip*ph;
<a name="l00540"></a>00540             *argpp += pgh;
<a name="l00541"></a>00541             *nodep += ph;
<a name="l00542"></a>00542             *mp    += pl;
<a name="l00543"></a>00543 
<a name="l00544"></a>00544         } <span class="keywordflow">else</span> {
<a name="l00545"></a>00545 
<a name="l00546"></a>00546             <span class="comment">/* ---- apply periodics with lyddane modification ---- */</span>
<a name="l00547"></a>00547             sinop = sin(*nodep);
<a name="l00548"></a>00548             cosop = cos(*nodep);
<a name="l00549"></a>00549             alfdp = sinip*sinop;
<a name="l00550"></a>00550             betdp = sinip*cosop;
<a name="l00551"></a>00551             dalf  =  ph*cosop + pinc*cosip*sinop;
<a name="l00552"></a>00552             dbet  = -ph*sinop + pinc*cosip*cosop;
<a name="l00553"></a>00553 
<a name="l00554"></a>00554             alfdp += dalf;
<a name="l00555"></a>00555             betdp += dbet;
<a name="l00556"></a>00556             *nodep = fmod(*nodep, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l00557"></a>00557             xls   = *mp + *argpp + cosip* (*nodep);
<a name="l00558"></a>00558             dls   = pl + pgh - pinc*( *nodep)*sinip;
<a name="l00559"></a>00559             xls   += dls;
<a name="l00560"></a>00560             xnoh  = *nodep;
<a name="l00561"></a>00561             *nodep = atan2(alfdp, betdp);
<a name="l00562"></a>00562             <span class="keywordflow">if</span> (fabs(xnoh - *nodep) &gt; <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>) {
<a name="l00563"></a>00563                 <span class="keywordflow">if</span> ( *nodep &lt; xnoh )
<a name="l00564"></a>00564                     *nodep = *nodep + <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>;
<a name="l00565"></a>00565                 <span class="keywordflow">else</span>
<a name="l00566"></a>00566                     *nodep = *nodep - M_2PI;
<a name="l00567"></a>00567             }
<a name="l00568"></a>00568             *mp   += pl;
<a name="l00569"></a>00569             *argpp = xls - *mp - cosip * *nodep;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571         }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573     } <span class="comment">// if s-&gt;init == 'n'</span>
<a name="l00574"></a>00574 
<a name="l00575"></a>00575     <span class="comment">//#include "debug1.cpp"</span>
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 
<a name="l00578"></a>00578 } <span class="comment">// end LgmSgp_dpper</span>
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l00583"></a>00583 <span class="comment">*</span>
<a name="l00584"></a>00584 <span class="comment">* procedure dscom</span>
<a name="l00585"></a>00585 <span class="comment">*</span>
<a name="l00586"></a>00586 <span class="comment">* this procedure provides deep space common items used by both the secular</span>
<a name="l00587"></a>00587 <span class="comment">* and periodics subroutines. input is provided as shown. this routine</span>
<a name="l00588"></a>00588 <span class="comment">* used to be called dpper, but the functions inside weren't well organized.</span>
<a name="l00589"></a>00589 <span class="comment">*</span>
<a name="l00590"></a>00590 <span class="comment">* author : david vallado 719-573-2600 28 jun 2005</span>
<a name="l00591"></a>00591 <span class="comment">*</span>
<a name="l00592"></a>00592 <span class="comment">* inputs :</span>
<a name="l00593"></a>00593 <span class="comment">* epoch -</span>
<a name="l00594"></a>00594 <span class="comment">* ep - eccentricity</span>
<a name="l00595"></a>00595 <span class="comment">* argpp - argument of perigee</span>
<a name="l00596"></a>00596 <span class="comment">* tc -</span>
<a name="l00597"></a>00597 <span class="comment">* inclp - inclination</span>
<a name="l00598"></a>00598 <span class="comment">* nodep - right ascension of ascending node</span>
<a name="l00599"></a>00599 <span class="comment">* np - mean motion</span>
<a name="l00600"></a>00600 <span class="comment">*</span>
<a name="l00601"></a>00601 <span class="comment">* outputs :</span>
<a name="l00602"></a>00602 <span class="comment">*     sinim , cosim , sinomm , cosomm , snodm , cnodm</span>
<a name="l00603"></a>00603 <span class="comment">*     day -</span>
<a name="l00604"></a>00604 <span class="comment">*     e3 -</span>
<a name="l00605"></a>00605 <span class="comment">*     ee2 -</span>
<a name="l00606"></a>00606 <span class="comment">*     em - eccentricity</span>
<a name="l00607"></a>00607 <span class="comment">*     emsq - eccentricity squared</span>
<a name="l00608"></a>00608 <span class="comment">*     gam -</span>
<a name="l00609"></a>00609 <span class="comment">*     peo -</span>
<a name="l00610"></a>00610 <span class="comment">*     pgho -</span>
<a name="l00611"></a>00611 <span class="comment">*     pho -</span>
<a name="l00612"></a>00612 <span class="comment">*     pinco -</span>
<a name="l00613"></a>00613 <span class="comment">*     plo -</span>
<a name="l00614"></a>00614 <span class="comment">*     rtemsq -</span>
<a name="l00615"></a>00615 <span class="comment">*     se2, se3 -</span>
<a name="l00616"></a>00616 <span class="comment">*     sgh2, sgh3, sgh4 -</span>
<a name="l00617"></a>00617 <span class="comment">*     sh2, sh3, si2, si3, sl2, sl3, sl4 -</span>
<a name="l00618"></a>00618 <span class="comment">*     s1, s2, s3, s4, s5, s6, s7 -</span>
<a name="l00619"></a>00619 <span class="comment">*     ss1, ss2, ss3, ss4, ss5, ss6, ss7, sz1, sz2, sz3 -</span>
<a name="l00620"></a>00620 <span class="comment">*     sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32, sz33 -</span>
<a name="l00621"></a>00621 <span class="comment">*     xgh2, xgh3, xgh4, xh2, xh3, xi2, xi3, xl2, xl3, xl4 -</span>
<a name="l00622"></a>00622 <span class="comment">*     nm - mean motion</span>
<a name="l00623"></a>00623 <span class="comment">*     z1, z2, z3, z11, z12, z13, z21, z22, z23, z31, z32, z33 -</span>
<a name="l00624"></a>00624 <span class="comment">*     zmol -</span>
<a name="l00625"></a>00625 <span class="comment">*     zmos -</span>
<a name="l00626"></a>00626 <span class="comment">*</span>
<a name="l00627"></a>00627 <span class="comment">* locals :</span>
<a name="l00628"></a>00628 <span class="comment">* a1, a2, a3, a4, a5, a6, a7, a8, a9, a10 -</span>
<a name="l00629"></a>00629 <span class="comment">* betasq -</span>
<a name="l00630"></a>00630 <span class="comment">* cc -</span>
<a name="l00631"></a>00631 <span class="comment">* ctem, stem -</span>
<a name="l00632"></a>00632 <span class="comment">* x1, x2, x3, x4, x5, x6, x7, x8 -</span>
<a name="l00633"></a>00633 <span class="comment">* xnodce -</span>
<a name="l00634"></a>00634 <span class="comment">* xnoi -</span>
<a name="l00635"></a>00635 <span class="comment">* zcosg , zsing , zcosgl , zsingl , zcosh , zsinh , zcoshl , zsinhl ,</span>
<a name="l00636"></a>00636 <span class="comment">* zcosi , zsini , zcosil , zsinil ,</span>
<a name="l00637"></a>00637 <span class="comment">* zx -</span>
<a name="l00638"></a>00638 <span class="comment">* zy -</span>
<a name="l00639"></a>00639 <span class="comment">*</span>
<a name="l00640"></a>00640 <span class="comment">* coupling :</span>
<a name="l00641"></a>00641 <span class="comment">* none.</span>
<a name="l00642"></a>00642 <span class="comment">*</span>
<a name="l00643"></a>00643 <span class="comment">* references :</span>
<a name="l00644"></a>00644 <span class="comment">* hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l00645"></a>00645 <span class="comment">* hoots, norad spacetrack report #6 1986</span>
<a name="l00646"></a>00646 <span class="comment">* hoots, schumacher and glover 2004</span>
<a name="l00647"></a>00647 <span class="comment">* vallado, crawford, hujsak, kelso 2006</span>
<a name="l00648"></a>00648 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l00649"></a><a class="code" href="_lgm___sgp_8c.html#584c10e9b76c3814acb6ac927d11dfdf">00649</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#584c10e9b76c3814acb6ac927d11dfdf">LgmSgp_dscom</a>( <span class="keywordtype">double</span> epoch, <span class="keywordtype">double</span> ep, <span class="keywordtype">double</span> argpp, <span class="keywordtype">double</span> tc, <span class="keywordtype">double</span> inclp, <span class="keywordtype">double</span> nodep, <span class="keywordtype">double</span> np,
<a name="l00650"></a>00650                     <span class="keywordtype">double</span> *snodm, <span class="keywordtype">double</span> *cnodm, <span class="keywordtype">double</span> *sinim, <span class="keywordtype">double</span> *cosim, <span class="keywordtype">double</span> *sinomm,
<a name="l00651"></a>00651                     <span class="keywordtype">double</span> *cosomm,<span class="keywordtype">double</span> *day, <span class="keywordtype">double</span> *e3, <span class="keywordtype">double</span> *ee2, <span class="keywordtype">double</span> *em,
<a name="l00652"></a>00652                     <span class="keywordtype">double</span> *emsq, <span class="keywordtype">double</span> *gam, <span class="keywordtype">double</span> *peo, <span class="keywordtype">double</span> *pgho, <span class="keywordtype">double</span> *pho,
<a name="l00653"></a>00653                     <span class="keywordtype">double</span> *pinco, <span class="keywordtype">double</span> *plo, <span class="keywordtype">double</span> *rtemsq, <span class="keywordtype">double</span> *se2, <span class="keywordtype">double</span> *se3,
<a name="l00654"></a>00654                     <span class="keywordtype">double</span> *sgh2, <span class="keywordtype">double</span> *sgh3, <span class="keywordtype">double</span> *sgh4, <span class="keywordtype">double</span> *sh2, <span class="keywordtype">double</span> *sh3,
<a name="l00655"></a>00655                     <span class="keywordtype">double</span> *si2, <span class="keywordtype">double</span> *si3, <span class="keywordtype">double</span> *sl2, <span class="keywordtype">double</span> *sl3, <span class="keywordtype">double</span> *sl4,
<a name="l00656"></a>00656                     <span class="keywordtype">double</span> *s1, <span class="keywordtype">double</span> *s2, <span class="keywordtype">double</span> *s3, <span class="keywordtype">double</span> *s4, <span class="keywordtype">double</span> *s5,
<a name="l00657"></a>00657                     <span class="keywordtype">double</span> *s6, <span class="keywordtype">double</span> *s7, <span class="keywordtype">double</span> *ss1, <span class="keywordtype">double</span> *ss2, <span class="keywordtype">double</span> *ss3,
<a name="l00658"></a>00658                     <span class="keywordtype">double</span> *ss4, <span class="keywordtype">double</span> *ss5, <span class="keywordtype">double</span> *ss6, <span class="keywordtype">double</span> *ss7, <span class="keywordtype">double</span> *sz1,
<a name="l00659"></a>00659                     <span class="keywordtype">double</span> *sz2, <span class="keywordtype">double</span> *sz3, <span class="keywordtype">double</span> *sz11, <span class="keywordtype">double</span> *sz12, <span class="keywordtype">double</span> *sz13,
<a name="l00660"></a>00660                     <span class="keywordtype">double</span> *sz21, <span class="keywordtype">double</span> *sz22, <span class="keywordtype">double</span> *sz23, <span class="keywordtype">double</span> *sz31, <span class="keywordtype">double</span> *sz32,
<a name="l00661"></a>00661                     <span class="keywordtype">double</span> *sz33, <span class="keywordtype">double</span> *xgh2, <span class="keywordtype">double</span> *xgh3, <span class="keywordtype">double</span> *xgh4, <span class="keywordtype">double</span> *xh2,
<a name="l00662"></a>00662                     <span class="keywordtype">double</span> *xh3, <span class="keywordtype">double</span> *xi2, <span class="keywordtype">double</span> *xi3, <span class="keywordtype">double</span> *xl2, <span class="keywordtype">double</span> *xl3,
<a name="l00663"></a>00663                     <span class="keywordtype">double</span> *xl4, <span class="keywordtype">double</span> *nm, <span class="keywordtype">double</span> *z1, <span class="keywordtype">double</span> *z2, <span class="keywordtype">double</span> *z3,
<a name="l00664"></a>00664                     <span class="keywordtype">double</span> *z11, <span class="keywordtype">double</span> *z12, <span class="keywordtype">double</span> *z13, <span class="keywordtype">double</span> *z21, <span class="keywordtype">double</span> *z22,
<a name="l00665"></a>00665                     <span class="keywordtype">double</span> *z23, <span class="keywordtype">double</span> *z31, <span class="keywordtype">double</span> *z32, <span class="keywordtype">double</span> *z33, <span class="keywordtype">double</span> *zmol, <span class="keywordtype">double</span> *zmos) {
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 
<a name="l00668"></a>00668     <span class="comment">/* -------------------------- constants ------------------------- */</span>
<a name="l00669"></a>00669     <span class="keyword">const</span> <span class="keywordtype">double</span> zes    = 0.01675;
<a name="l00670"></a>00670     <span class="keyword">const</span> <span class="keywordtype">double</span> zel    = 0.05490;
<a name="l00671"></a>00671     <span class="keyword">const</span> <span class="keywordtype">double</span> c1ss   = 2.9864797e-6;
<a name="l00672"></a>00672     <span class="keyword">const</span> <span class="keywordtype">double</span> c1l    = 4.7968065e-7;
<a name="l00673"></a>00673     <span class="keyword">const</span> <span class="keywordtype">double</span> zsinis = 0.39785416;
<a name="l00674"></a>00674     <span class="keyword">const</span> <span class="keywordtype">double</span> zcosis = 0.91744867;
<a name="l00675"></a>00675     <span class="keyword">const</span> <span class="keywordtype">double</span> zcosgs = 0.1945905;
<a name="l00676"></a>00676     <span class="keyword">const</span> <span class="keywordtype">double</span> zsings = -0.98088458;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678     <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l00679"></a>00679     <span class="keywordtype">int</span>     lsflg;
<a name="l00680"></a>00680     <span class="keywordtype">double</span>  a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, betasq, cc, ctem, stem;
<a name="l00681"></a>00681     <span class="keywordtype">double</span>  x1, x2, x3, x4, x5, x6, x7, x8, xnodce, xnoi, zcosg, zcosgl, zcosh, zcoshl;
<a name="l00682"></a>00682     <span class="keywordtype">double</span>  zcosi, zcosil, zsing, zsingl, zsinh, zsinhl, zsini, zsinil, zx, zy;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 
<a name="l00685"></a>00685     *nm     = np;
<a name="l00686"></a>00686     *em     = ep;
<a name="l00687"></a>00687     *snodm  = sin(nodep);
<a name="l00688"></a>00688     *cnodm  = cos(nodep);
<a name="l00689"></a>00689     *sinomm = sin(argpp);
<a name="l00690"></a>00690     *cosomm = cos(argpp);
<a name="l00691"></a>00691     *sinim  = sin(inclp);
<a name="l00692"></a>00692     *cosim  = cos(inclp);
<a name="l00693"></a>00693     *emsq   = *em * *em;
<a name="l00694"></a>00694     betasq = 1.0 - *emsq;
<a name="l00695"></a>00695     *rtemsq = sqrt(betasq);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697     <span class="comment">/* ----------------- initialize lunar solar terms --------------- */</span>
<a name="l00698"></a>00698     *peo    = 0.0;
<a name="l00699"></a>00699     *pinco  = 0.0;
<a name="l00700"></a>00700     *plo    = 0.0;
<a name="l00701"></a>00701     *pgho   = 0.0;
<a name="l00702"></a>00702     *pho    = 0.0;
<a name="l00703"></a>00703     *day    = epoch + 18261.5 + tc / 1440.0;
<a name="l00704"></a>00704     xnodce = fmod(4.5236020 - 9.2422029e-4 * *day, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l00705"></a>00705     stem   = sin(xnodce);
<a name="l00706"></a>00706     ctem   = cos(xnodce);
<a name="l00707"></a>00707     zcosil = 0.91375164 - 0.03568096 * ctem;
<a name="l00708"></a>00708     zsinil = sqrt(1.0 - zcosil * zcosil);
<a name="l00709"></a>00709     zsinhl = 0.089683511 * stem / zsinil;
<a name="l00710"></a>00710     zcoshl = sqrt(1.0 - zsinhl * zsinhl);
<a name="l00711"></a>00711     *gam    = 5.8351514 + 0.0019443680 * *day;
<a name="l00712"></a>00712     zx     = 0.39785416 * stem / zsinil;
<a name="l00713"></a>00713     zy     = zcoshl * ctem + 0.91744867 * zsinhl * stem;
<a name="l00714"></a>00714     zx     = atan2(zx, zy);
<a name="l00715"></a>00715     zx     = *gam + zx - xnodce;
<a name="l00716"></a>00716     zcosgl = cos(zx);
<a name="l00717"></a>00717     zsingl = sin(zx);
<a name="l00718"></a>00718 
<a name="l00719"></a>00719 
<a name="l00720"></a>00720     <span class="comment">/* ------------------------- do solar terms --------------------- */</span>
<a name="l00721"></a>00721     zcosg = zcosgs;
<a name="l00722"></a>00722     zsing = zsings;
<a name="l00723"></a>00723     zcosi = zcosis;
<a name="l00724"></a>00724     zsini = zsinis;
<a name="l00725"></a>00725     zcosh = *cnodm;
<a name="l00726"></a>00726     zsinh = *snodm;
<a name="l00727"></a>00727     cc = c1ss;
<a name="l00728"></a>00728     xnoi = 1.0/(*nm);
<a name="l00729"></a>00729     <span class="keywordflow">for</span> (lsflg = 1; lsflg &lt;= 2; lsflg++) {
<a name="l00730"></a>00730         a1  = zcosg*zcosh + zsing*zcosi*zsinh;
<a name="l00731"></a>00731         a3  = -zsing*zcosh + zcosg*zcosi*zsinh;
<a name="l00732"></a>00732         a7  = -zcosg*zsinh + zsing*zcosi*zcosh;
<a name="l00733"></a>00733         a8  = zsing*zsini;
<a name="l00734"></a>00734         a9  = zsing*zsinh + zcosg*zcosi*zcosh;
<a name="l00735"></a>00735         a10 = zcosg*zsini;
<a name="l00736"></a>00736         a2  = *cosim*a7 + *sinim*a8;
<a name="l00737"></a>00737         a4  = *cosim*a9 + *sinim*a10;
<a name="l00738"></a>00738         a5  = -*sinim*a7 + *cosim*a8;
<a name="l00739"></a>00739         a6  = -*sinim*a9 + *cosim*a10;
<a name="l00740"></a>00740         x1  = a1 * *cosomm + a2 * *sinomm;
<a name="l00741"></a>00741         x2  = a3 * *cosomm + a4 * *sinomm;
<a name="l00742"></a>00742         x3  = -a1 * *sinomm + a2 * *cosomm;
<a name="l00743"></a>00743         x4  = -a3 * *sinomm + a4 * *cosomm;
<a name="l00744"></a>00744         x5  = a5 * *sinomm;
<a name="l00745"></a>00745         x6  = a6 * *sinomm;
<a name="l00746"></a>00746         x7  = a5 * *cosomm;
<a name="l00747"></a>00747         x8  = a6 * *cosomm;
<a name="l00748"></a>00748         *z31 = 12.0*x1*x1 - 3.0*x3*x3;
<a name="l00749"></a>00749         *z32 = 24.0*x1*x2 - 6.0*x3*x4;
<a name="l00750"></a>00750         *z33 = 12.0*x2*x2 - 3.0*x4*x4;
<a name="l00751"></a>00751         *z1  = 3.0*(a1*a1 + a2*a2) + *z31 * *emsq;
<a name="l00752"></a>00752         *z2  = 6.0*(a1*a3 + a2*a4) + *z32 * *emsq;
<a name="l00753"></a>00753         *z3  = 3.0*(a3*a3 + a4*a4) + *z33 * *emsq;
<a name="l00754"></a>00754         *z11 = -6.0*a1*a5 + *emsq*(-24.0*x1*x7-6.0*x3*x5);
<a name="l00755"></a>00755         *z12 = -6.0*(a1*a6 + a3*a5) + *emsq * (-24.0*(x2*x7 + x1*x8) - 6.0*(x3*x6 + x4*x5));
<a name="l00756"></a>00756         *z13 = -6.0*a3*a6 + *emsq*(-24.0*x2*x8 - 6.0*x4*x6);
<a name="l00757"></a>00757         *z21 = 6.0*a2*a5 + *emsq*(24.0*x1*x5 - 6.0*x3*x7);
<a name="l00758"></a>00758         *z22 = 6.0*(a4*a5 + a2*a6) + *emsq * (24.0*(x2*x5 + x1*x6) - 6.0*(x4*x7 + x3*x8));
<a name="l00759"></a>00759         *z23 = 6.0*a4*a6 + *emsq*(24.0*x2*x6 - 6.0*x4*x8);
<a name="l00760"></a>00760         *z1  = *z1 + *z1 + betasq * *z31;
<a name="l00761"></a>00761         *z2  = *z2 + *z2 + betasq * *z32;
<a name="l00762"></a>00762         *z3  = *z3 + *z3 + betasq * *z33;
<a name="l00763"></a>00763         *s3  = cc*xnoi;
<a name="l00764"></a>00764         *s2  = -0.5 * *s3 / *rtemsq;
<a name="l00765"></a>00765         *s4  = *s3 * *rtemsq;
<a name="l00766"></a>00766         *s1  = -15.0 * *em * *s4;
<a name="l00767"></a>00767         *s5  = x1*x3 + x2*x4;
<a name="l00768"></a>00768         *s6  = x2*x3 + x1*x4;
<a name="l00769"></a>00769         *s7  = x2*x4 - x1*x3;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 
<a name="l00772"></a>00772         <span class="comment">/* ----------------------- do lunar terms ------------------- */</span>
<a name="l00773"></a>00773         <span class="keywordflow">if</span> (lsflg == 1) {
<a name="l00774"></a>00774             *ss1 = *s1; *ss2 = *s2; *ss3 = *s3; *ss4 = *s4; *ss5 = *s5; *ss6 = *s6; *ss7 = *s7;
<a name="l00775"></a>00775             *sz1 = *z1; *sz2 = *z2; *sz3 = *z3;
<a name="l00776"></a>00776             *sz11 = *z11; *sz12 = *z12; *sz13 = *z13; *sz21 = *z21; *sz22 = *z22; *sz23 = *z23; *sz31 = *z31; *sz32 = *z32; *sz33 = *z33;
<a name="l00777"></a>00777             zcosg = zcosgl; zsing = zsingl; zcosi = zcosil; zsini = zsinil;
<a name="l00778"></a>00778             zcosh = zcoshl*(*cnodm) + zsinhl*(*snodm);
<a name="l00779"></a>00779             zsinh = *snodm*zcoshl - *cnodm*zsinhl;
<a name="l00780"></a>00780             cc = c1l;
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783     }
<a name="l00784"></a>00784 
<a name="l00785"></a>00785     *zmol = fmod(4.7199672 + 0.22997150 * *day - *gam, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l00786"></a>00786     *zmos = fmod(6.2565837 + 0.017201977 * *day, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788     <span class="comment">/* ------------------------ do solar terms ---------------------- */</span>
<a name="l00789"></a>00789     *se2  = 2.0 * *ss1 * *ss6;
<a name="l00790"></a>00790     *se3  = 2.0 * *ss1 * *ss7;
<a name="l00791"></a>00791     *si2  = 2.0 * *ss2 * *sz12;
<a name="l00792"></a>00792     *si3  = 2.0 * *ss2*(*sz13 - *sz11);
<a name="l00793"></a>00793     *sl2  = -2.0 * *ss3 * *sz2;
<a name="l00794"></a>00794     *sl3  = -2.0 * *ss3*(*sz3 - *sz1);
<a name="l00795"></a>00795     *sl4  = -2.0 * *ss3*(-21.0 - 9.0 * *emsq)*zes;
<a name="l00796"></a>00796     *sgh2 = 2.0 * *ss4 * *sz32;
<a name="l00797"></a>00797     *sgh3 = 2.0 * *ss4*(*sz33 - *sz31);
<a name="l00798"></a>00798     *sgh4 = -18.0 * *ss4*zes;
<a name="l00799"></a>00799     *sh2  = -2.0 * *ss2 * *sz22;
<a name="l00800"></a>00800     *sh3  = -2.0 * *ss2*(*sz23 - *sz21);
<a name="l00801"></a>00801 
<a name="l00802"></a>00802     <span class="comment">/* ------------------------ do lunar terms ---------------------- */</span>
<a name="l00803"></a>00803     *ee2  = 2.0 * *s1 * *s6;
<a name="l00804"></a>00804     *e3   = 2.0 * *s1 * *s7;
<a name="l00805"></a>00805     *xi2  = 2.0 * *s2 * *z12;
<a name="l00806"></a>00806     *xi3  = 2.0 * *s2*(*z13 - *z11);
<a name="l00807"></a>00807     *xl2  = -2.0 * *s3 * *z2;
<a name="l00808"></a>00808     *xl3  = -2.0 * *s3*(*z3 - *z1);
<a name="l00809"></a>00809     *xl4  = -2.0 * *s3*(-21.0 - 9.0 * *emsq)*zel;
<a name="l00810"></a>00810     *xgh2 = 2.0 * *s4 * *z32;
<a name="l00811"></a>00811     *xgh3 = 2.0 * *s4*(*z33 - *z31);
<a name="l00812"></a>00812     *xgh4 = -18.0 * *s4*zel;
<a name="l00813"></a>00813     *xh2  = -2.0 * *s2 * *z22;
<a name="l00814"></a>00814     *xh3  = -2.0 * *s2*(*z23 - *z21);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     <span class="comment">//#include "debug2.cpp"</span>
<a name="l00817"></a>00817 
<a name="l00818"></a>00818 } <span class="comment">// end dscom</span>
<a name="l00819"></a>00819 
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l00822"></a>00822 <span class="comment">*</span>
<a name="l00823"></a>00823 <span class="comment">* procedure dsinit</span>
<a name="l00824"></a>00824 <span class="comment">*</span>
<a name="l00825"></a>00825 <span class="comment">* this procedure provides deep space contributions to mean motion dot due</span>
<a name="l00826"></a>00826 <span class="comment">* to geopotential resonance with half day and one day orbits.</span>
<a name="l00827"></a>00827 <span class="comment">*</span>
<a name="l00828"></a>00828 <span class="comment">* author : david vallado 719-573-2600 28 jun 2005</span>
<a name="l00829"></a>00829 <span class="comment">*</span>
<a name="l00830"></a>00830 <span class="comment">* inputs :</span>
<a name="l00831"></a>00831 <span class="comment">* cosim, sinim-</span>
<a name="l00832"></a>00832 <span class="comment">* emsq - eccentricity squared</span>
<a name="l00833"></a>00833 <span class="comment">* argpo - argument of perigee</span>
<a name="l00834"></a>00834 <span class="comment">* s1, s2, s3, s4, s5 -</span>
<a name="l00835"></a>00835 <span class="comment">* ss1, ss2, ss3, ss4, ss5 -</span>
<a name="l00836"></a>00836 <span class="comment">* sz1, sz3, sz11, sz13, sz21, sz23, sz31, sz33 -</span>
<a name="l00837"></a>00837 <span class="comment">* t - time</span>
<a name="l00838"></a>00838 <span class="comment">* tc -</span>
<a name="l00839"></a>00839 <span class="comment">* gsto - greenwich sidereal time rad</span>
<a name="l00840"></a>00840 <span class="comment">* mo - mean anomaly</span>
<a name="l00841"></a>00841 <span class="comment">* mdot - mean anomaly dot (rate)</span>
<a name="l00842"></a>00842 <span class="comment">* no - mean motion</span>
<a name="l00843"></a>00843 <span class="comment">* nodeo - right ascension of ascending node</span>
<a name="l00844"></a>00844 <span class="comment">* nodedot - right ascension of ascending node dot (rate)</span>
<a name="l00845"></a>00845 <span class="comment">* xpidot -</span>
<a name="l00846"></a>00846 <span class="comment">* z1, z3, z11, z13, z21, z23, z31, z33 -</span>
<a name="l00847"></a>00847 <span class="comment">* eccm - eccentricity</span>
<a name="l00848"></a>00848 <span class="comment">* argpm - argument of perigee</span>
<a name="l00849"></a>00849 <span class="comment">* inclm - inclination</span>
<a name="l00850"></a>00850 <span class="comment">* mm - mean anomaly</span>
<a name="l00851"></a>00851 <span class="comment">* xn - mean motion</span>
<a name="l00852"></a>00852 <span class="comment">* nodem - right ascension of ascending node</span>
<a name="l00853"></a>00853 <span class="comment">*</span>
<a name="l00854"></a>00854 <span class="comment">* outputs :</span>
<a name="l00855"></a>00855 <span class="comment">* em - eccentricity</span>
<a name="l00856"></a>00856 <span class="comment">* argpm - argument of perigee</span>
<a name="l00857"></a>00857 <span class="comment">* inclm - inclination</span>
<a name="l00858"></a>00858 <span class="comment">* mm - mean anomaly</span>
<a name="l00859"></a>00859 <span class="comment">* nm - mean motion</span>
<a name="l00860"></a>00860 <span class="comment">* nodem - right ascension of ascending node</span>
<a name="l00861"></a>00861 <span class="comment">* irez - flag for resonance 0-none, 1-one day, 2-half day</span>
<a name="l00862"></a>00862 <span class="comment">* atime -</span>
<a name="l00863"></a>00863 <span class="comment">* d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433 -</span>
<a name="l00864"></a>00864 <span class="comment">* dedt -</span>
<a name="l00865"></a>00865 <span class="comment">* didt -</span>
<a name="l00866"></a>00866 <span class="comment">* dmdt -</span>
<a name="l00867"></a>00867 <span class="comment">* dndt -</span>
<a name="l00868"></a>00868 <span class="comment">* dnodt -</span>
<a name="l00869"></a>00869 <span class="comment">* domdt -</span>
<a name="l00870"></a>00870 <span class="comment">* del1, del2, del3 -</span>
<a name="l00871"></a>00871 <span class="comment">* ses , sghl , sghs , sgs , shl , shs , sis , sls</span>
<a name="l00872"></a>00872 <span class="comment">* theta -</span>
<a name="l00873"></a>00873 <span class="comment">* xfact -</span>
<a name="l00874"></a>00874 <span class="comment">* xlamo -</span>
<a name="l00875"></a>00875 <span class="comment">* xli -</span>
<a name="l00876"></a>00876 <span class="comment">* xni</span>
<a name="l00877"></a>00877 <span class="comment">*</span>
<a name="l00878"></a>00878 <span class="comment">* locals :</span>
<a name="l00879"></a>00879 <span class="comment">* ainv2 -</span>
<a name="l00880"></a>00880 <span class="comment">* aonv -</span>
<a name="l00881"></a>00881 <span class="comment">* cosisq -</span>
<a name="l00882"></a>00882 <span class="comment">* eoc -</span>
<a name="l00883"></a>00883 <span class="comment">* f220, f221, f311, f321, f322, f330, f441, f442, f522, f523, f542, f543 -</span>
<a name="l00884"></a>00884 <span class="comment">* g200, g201, g211, g300, g310, g322, g410, g422, g520, g521, g532, g533 -</span>
<a name="l00885"></a>00885 <span class="comment">* sini2 -</span>
<a name="l00886"></a>00886 <span class="comment">* temp -</span>
<a name="l00887"></a>00887 <span class="comment">* temp1 -</span>
<a name="l00888"></a>00888 <span class="comment">* theta -</span>
<a name="l00889"></a>00889 <span class="comment">* xno2 -</span>
<a name="l00890"></a>00890 <span class="comment">*</span>
<a name="l00891"></a>00891 <span class="comment">* coupling :</span>
<a name="l00892"></a>00892 <span class="comment">* LgmSgp_GetGravConst</span>
<a name="l00893"></a>00893 <span class="comment">*</span>
<a name="l00894"></a>00894 <span class="comment">* references :</span>
<a name="l00895"></a>00895 <span class="comment">* hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l00896"></a>00896 <span class="comment">* hoots, norad spacetrack report #6 1986</span>
<a name="l00897"></a>00897 <span class="comment">* hoots, schumacher and glover 2004</span>
<a name="l00898"></a>00898 <span class="comment">* vallado, crawford, hujsak, kelso 2006</span>
<a name="l00899"></a>00899 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 
<a name="l00902"></a><a class="code" href="_lgm___sgp_8c.html#f068d9816c00ad56633a4dbfe8eb47b8">00902</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#f068d9816c00ad56633a4dbfe8eb47b8">LgmSgp_dsinit</a>( <span class="keywordtype">int</span> whichconst, <span class="keywordtype">double</span> cosim, <span class="keywordtype">double</span> emsq, <span class="keywordtype">double</span> argpo,
<a name="l00903"></a>00903                         <span class="keywordtype">double</span> s1, <span class="keywordtype">double</span> s2, <span class="keywordtype">double</span> s3, <span class="keywordtype">double</span> s4, <span class="keywordtype">double</span> s5, <span class="keywordtype">double</span> sinim, <span class="keywordtype">double</span> ss1, 
<a name="l00904"></a>00904                         <span class="keywordtype">double</span> ss2, <span class="keywordtype">double</span> ss3, <span class="keywordtype">double</span> ss4, <span class="keywordtype">double</span> ss5, <span class="keywordtype">double</span> sz1, <span class="keywordtype">double</span> sz3, <span class="keywordtype">double</span> sz11, 
<a name="l00905"></a>00905                         <span class="keywordtype">double</span> sz13, <span class="keywordtype">double</span> sz21, <span class="keywordtype">double</span> sz23, <span class="keywordtype">double</span> sz31, <span class="keywordtype">double</span> sz33, <span class="keywordtype">double</span> t, <span class="keywordtype">double</span> tc, 
<a name="l00906"></a>00906                         <span class="keywordtype">double</span> gsto, <span class="keywordtype">double</span> mo, <span class="keywordtype">double</span> mdot, <span class="keywordtype">double</span> no, <span class="keywordtype">double</span> nodeo, <span class="keywordtype">double</span> nodedot, 
<a name="l00907"></a>00907                         <span class="keywordtype">double</span> xpidot, <span class="keywordtype">double</span> z1, <span class="keywordtype">double</span> z3, <span class="keywordtype">double</span> z11, <span class="keywordtype">double</span> z13, <span class="keywordtype">double</span> z21, <span class="keywordtype">double</span> z23, 
<a name="l00908"></a>00908                         <span class="keywordtype">double</span> z31, <span class="keywordtype">double</span> z33, <span class="keywordtype">double</span> ecco, <span class="keywordtype">double</span> eccsq, 
<a name="l00909"></a>00909 
<a name="l00910"></a>00910                         <span class="keywordtype">double</span> *em, <span class="keywordtype">double</span> *argpm, <span class="keywordtype">double</span> *inclm, <span class="keywordtype">double</span> *mm, <span class="keywordtype">double</span> *nm, <span class="keywordtype">double</span> *nodem, 
<a name="l00911"></a>00911                         <span class="keywordtype">int</span> *irez, <span class="keywordtype">double</span> *atime, <span class="keywordtype">double</span> *d2201, <span class="keywordtype">double</span> *d2211, <span class="keywordtype">double</span> *d3210, <span class="keywordtype">double</span> *d3222, 
<a name="l00912"></a>00912                         <span class="keywordtype">double</span> *d4410, <span class="keywordtype">double</span> *d4422, <span class="keywordtype">double</span> *d5220, <span class="keywordtype">double</span> *d5232, <span class="keywordtype">double</span> *d5421, <span class="keywordtype">double</span> *d5433, 
<a name="l00913"></a>00913                         <span class="keywordtype">double</span> *dedt, <span class="keywordtype">double</span> *didt, <span class="keywordtype">double</span> *dmdt, <span class="keywordtype">double</span> *dndt, <span class="keywordtype">double</span> *dnodt, <span class="keywordtype">double</span> *domdt, 
<a name="l00914"></a>00914                         <span class="keywordtype">double</span> *del1, <span class="keywordtype">double</span> *del2, <span class="keywordtype">double</span> *del3, <span class="keywordtype">double</span> *xfact, <span class="keywordtype">double</span> *xlamo, <span class="keywordtype">double</span> *xli, <span class="keywordtype">double</span> *xni) {
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 
<a name="l00917"></a>00917 
<a name="l00918"></a>00918     <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l00919"></a>00919     <span class="keywordtype">double</span>  ainv2, aonv=0.0, cosisq, eoc, f220, f221, f311;
<a name="l00920"></a>00920     <span class="keywordtype">double</span>  f321, f322, f330, f441, f442, f522, f523;
<a name="l00921"></a>00921     <span class="keywordtype">double</span>  f542, f543, g200, g201, g211, g300, g310;
<a name="l00922"></a>00922     <span class="keywordtype">double</span>  g322, g410, g422, g520, g521, g532, g533;
<a name="l00923"></a>00923     <span class="keywordtype">double</span>  ses, sgs, sghl, sghs, shs, shll, sis;
<a name="l00924"></a>00924     <span class="keywordtype">double</span>  sini2, sls, temp, temp1, theta, xno2, q22;
<a name="l00925"></a>00925     <span class="keywordtype">double</span>  q31, q33, root22, root44, root54, rptim, root32;
<a name="l00926"></a>00926     <span class="keywordtype">double</span>  root52, x2o3, xke, znl, emo, zns, emsqo;
<a name="l00927"></a>00927     <span class="keywordtype">double</span>  tumin, radiusearthkm, j2, j3, j4, j3oj2;
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 
<a name="l00930"></a>00930 
<a name="l00931"></a>00931     q22    = 1.7891679e-6;
<a name="l00932"></a>00932     q31    = 2.1460748e-6;
<a name="l00933"></a>00933     q33    = 2.2123015e-7;
<a name="l00934"></a>00934     root22 = 1.7891679e-6;
<a name="l00935"></a>00935     root44 = 7.3636953e-9;
<a name="l00936"></a>00936     root54 = 2.1765803e-9;
<a name="l00937"></a>00937     rptim  = 4.37526908801129966e-3; <span class="comment">// this equates to 7.29211514668855e-5 rad/sec</span>
<a name="l00938"></a>00938     root32 = 3.7393792e-7;
<a name="l00939"></a>00939     root52 = 1.1428639e-7;
<a name="l00940"></a>00940     x2o3   = 2.0 / 3.0;
<a name="l00941"></a>00941     znl    = 1.5835218e-4;
<a name="l00942"></a>00942     zns    = 1.19459e-5;
<a name="l00943"></a>00943 
<a name="l00944"></a>00944 
<a name="l00945"></a>00945 
<a name="l00946"></a>00946     <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l00947"></a>00947     <a class="code" href="_lgm___sgp_8h.html#67d8f3b2acd5863c49efb5ba9e8c2eb7">LgmSgp_GetGravConst</a>( whichconst, &amp;tumin, &amp;radiusearthkm, &amp;xke, &amp;j2, &amp;j3, &amp;j4, &amp;j3oj2 );
<a name="l00948"></a>00948 
<a name="l00949"></a>00949 
<a name="l00950"></a>00950     <span class="comment">/* -------------------- deep space initialization ------------ */</span>
<a name="l00951"></a>00951     *irez = 0;
<a name="l00952"></a>00952     <span class="keywordflow">if</span> ((*nm &lt; 0.0052359877) &amp;&amp; (*nm &gt; 0.0034906585))        *irez = 1;
<a name="l00953"></a>00953     <span class="keywordflow">if</span> ((*nm &gt;= 8.26e-3) &amp;&amp; (*nm &lt;= 9.24e-3) &amp;&amp; (*em &gt;= 0.5)) *irez = 2;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 
<a name="l00956"></a>00956     <span class="comment">/* ------------------------ do solar terms ------------------- */</span>
<a name="l00957"></a>00957     ses  = ss1*zns*ss5;
<a name="l00958"></a>00958     sis  = ss2*zns*(sz11 + sz13);
<a name="l00959"></a>00959     sls  = -zns*ss3*(sz1 + sz3 - 14.0 - 6.0*emsq);
<a name="l00960"></a>00960     sghs = ss4*zns*(sz31 + sz33 - 6.0);
<a name="l00961"></a>00961     shs  = -zns*ss2*(sz21 + sz23);
<a name="l00962"></a>00962     <span class="comment">// sgp4fix for 180 deg incl</span>
<a name="l00963"></a>00963     <span class="keywordflow">if</span> ((*inclm &lt; 5.2359877e-2) || (*inclm &gt; <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a> - 5.2359877e-2)) shs = 0.0;
<a name="l00964"></a>00964     <span class="keywordflow">if</span> (sinim != 0.0) shs = shs / sinim;
<a name="l00965"></a>00965     sgs = sghs - cosim*shs;
<a name="l00966"></a>00966 
<a name="l00967"></a>00967 
<a name="l00968"></a>00968 
<a name="l00969"></a>00969     <span class="comment">/* ------------------------- do lunar terms ------------------ */</span>
<a name="l00970"></a>00970     *dedt = ses + s1*znl*s5;
<a name="l00971"></a>00971     *didt = sis + s2*znl*(z11 + z13);
<a name="l00972"></a>00972     *dmdt = sls - znl*s3*(z1 + z3 - 14.0 - 6.0*emsq);
<a name="l00973"></a>00973     sghl = s4*znl*(z31 + z33 - 6.0);
<a name="l00974"></a>00974     shll = -znl*s2*(z21 + z23);
<a name="l00975"></a>00975     <span class="comment">// sgp4fix for 180 deg incl</span>
<a name="l00976"></a>00976     <span class="keywordflow">if</span> ((*inclm &lt; 5.2359877e-2) || (*inclm &gt; <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a> - 5.2359877e-2)) shll = 0.0;
<a name="l00977"></a>00977     *domdt = sgs + sghl;
<a name="l00978"></a>00978     *dnodt = shs;
<a name="l00979"></a>00979     <span class="keywordflow">if</span> (sinim != 0.0) {
<a name="l00980"></a>00980         *domdt = *domdt - cosim / sinim*shll;
<a name="l00981"></a>00981         *dnodt = *dnodt + shll / sinim;
<a name="l00982"></a>00982     }
<a name="l00983"></a>00983 
<a name="l00984"></a>00984 
<a name="l00985"></a>00985 
<a name="l00986"></a>00986     <span class="comment">/* ----------- calculate deep space resonance effects -------- */</span>
<a name="l00987"></a>00987     *dndt  = 0.0;
<a name="l00988"></a>00988     theta = fmod(gsto + tc*rptim, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l00989"></a>00989     *em    += *dedt*t;
<a name="l00990"></a>00990     *inclm += *didt*t;
<a name="l00991"></a>00991     *argpm += *domdt*t;
<a name="l00992"></a>00992     *nodem += *dnodt*t;
<a name="l00993"></a>00993     *mm    += *dmdt*t;
<a name="l00994"></a>00994     <span class="comment">// sgp4fix for negative inclinations</span>
<a name="l00995"></a>00995     <span class="comment">// the following if statement should be commented out</span>
<a name="l00996"></a>00996     <span class="comment">//if (*inclm &lt; 0.0)</span>
<a name="l00997"></a>00997     <span class="comment">// {</span>
<a name="l00998"></a>00998     <span class="comment">// *inclm = -*inclm;</span>
<a name="l00999"></a>00999     <span class="comment">// *argpm = *argpm - pi;</span>
<a name="l01000"></a>01000     <span class="comment">// *nodem = *nodem + pi;</span>
<a name="l01001"></a>01001     <span class="comment">// }</span>
<a name="l01002"></a>01002 
<a name="l01003"></a>01003 
<a name="l01004"></a>01004 
<a name="l01005"></a>01005     <span class="comment">/* -------------- initialize the resonance terms ------------- */</span>
<a name="l01006"></a>01006     <span class="keywordflow">if</span> (*irez != 0) {
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         aonv = pow(*nm/xke, x2o3);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010         <span class="comment">/* ---------- geopotential resonance for 12 hour orbits ------ */</span>
<a name="l01011"></a>01011         <span class="keywordflow">if</span> (*irez == 2) {
<a name="l01012"></a>01012             cosisq = cosim*cosim;
<a name="l01013"></a>01013             emo    = *em;
<a name="l01014"></a>01014             *em     = ecco;
<a name="l01015"></a>01015             emsqo  = emsq;
<a name="l01016"></a>01016             emsq   = eccsq;
<a name="l01017"></a>01017             eoc    = *em*emsq;
<a name="l01018"></a>01018             g201   = -0.306 - (*em - 0.64)*0.440;
<a name="l01019"></a>01019             <span class="keywordflow">if</span> (*em &lt;= 0.65) {
<a name="l01020"></a>01020                 g211 = 3.616 - 13.2470 * *em + 16.2900*emsq;
<a name="l01021"></a>01021                 g310 = -19.302 + 117.3900 * *em - 228.4190*emsq + 156.5910*eoc;
<a name="l01022"></a>01022                 g322 = -18.9068 + 109.7927 * *em - 214.6334*emsq + 146.5816*eoc;
<a name="l01023"></a>01023                 g410 = -41.122 + 242.6940 * *em - 471.0940*emsq + 313.9530*eoc;
<a name="l01024"></a>01024                 g422 = -146.407 + 841.8800 * *em - 1629.014*emsq + 1083.4350*eoc;
<a name="l01025"></a>01025                 g520 = -532.114 + 3017.977 * *em - 5740.032*emsq + 3708.2760*eoc;
<a name="l01026"></a>01026             } <span class="keywordflow">else</span> {
<a name="l01027"></a>01027                 g211 = -72.099 + 331.819 * *em - 508.738*emsq + 266.724*eoc;
<a name="l01028"></a>01028                 g310 = -346.844 + 1582.851 * *em - 2415.925*emsq + 1246.113*eoc;
<a name="l01029"></a>01029                 g322 = -342.585 + 1554.908 * *em - 2366.899*emsq + 1215.972*eoc;
<a name="l01030"></a>01030                 g410 = -1052.797 + 4758.686 * *em - 7193.992*emsq + 3651.957*eoc;
<a name="l01031"></a>01031                 g422 = -3581.690 + 16178.110 * *em - 24462.770*emsq + 12422.520*eoc;
<a name="l01032"></a>01032                 <span class="keywordflow">if</span> (*em &gt; 0.715) g520 =-5149.66 + 29936.92 * *em - 54087.36*emsq + 31324.56*eoc;
<a name="l01033"></a>01033                 <span class="keywordflow">else</span>            g520 = 1464.74 - 4664.75 * *em + 3763.64*emsq;
<a name="l01034"></a>01034             }
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 
<a name="l01037"></a>01037             <span class="keywordflow">if</span> (*em &lt; 0.7) {
<a name="l01038"></a>01038                 g533 = -919.22770 + 4988.6100 * *em - 9064.7700*emsq + 5542.21*eoc;
<a name="l01039"></a>01039                 g521 = -822.71072 + 4568.6173 * *em - 8491.4146*emsq + 5337.524*eoc;
<a name="l01040"></a>01040                 g532 = -853.66600 + 4690.2500 * *em - 8624.7700*emsq + 5341.4*eoc;
<a name="l01041"></a>01041             } <span class="keywordflow">else</span> {
<a name="l01042"></a>01042                 g533 =-37995.780 + 161616.52 * *em - 229838.20*emsq + 109377.94*eoc;
<a name="l01043"></a>01043                 g521 =-51752.104 + 218913.95 * *em - 309468.16*emsq + 146349.42*eoc;
<a name="l01044"></a>01044                 g532 =-40023.880 + 170470.89 * *em - 242699.48*emsq + 115605.82*eoc;
<a name="l01045"></a>01045             }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047 
<a name="l01048"></a>01048             sini2= sinim*sinim;
<a name="l01049"></a>01049             f220 = 0.75*(1.0 + 2.0*cosim+cosisq);
<a name="l01050"></a>01050             f221 = 1.5*sini2;
<a name="l01051"></a>01051             f321 = 1.875*sinim*(1.0 - 2.0*cosim - 3.0*cosisq);
<a name="l01052"></a>01052             f322 = -1.875*sinim*(1.0 + 2.0*cosim - 3.0*cosisq);
<a name="l01053"></a>01053             f441 = 35.0*sini2*f220;
<a name="l01054"></a>01054             f442 = 39.3750*sini2*sini2;
<a name="l01055"></a>01055             f522 = 9.84375*sinim*(sini2*(1.0 - 2.0*cosim- 5.0*cosisq) + 0.33333333*(-2.0 + 4.0*cosim + 6.0*cosisq) );
<a name="l01056"></a>01056             f523 = sinim*(4.92187512*sini2*(-2.0 - 4.0*cosim + 10.0*cosisq) + 6.56250012*(1.0+2.0*cosim - 3.0*cosisq));
<a name="l01057"></a>01057             f542 = 29.53125*sinim*(2.0 - 8.0*cosim+cosisq * (-12.0 + 8.0*cosim + 10.0*cosisq));
<a name="l01058"></a>01058             f543 = 29.53125*sinim*(-2.0 - 8.0*cosim+cosisq * (12.0 + 8.0*cosim - 10.0*cosisq));
<a name="l01059"></a>01059             xno2  = *nm * *nm;
<a name="l01060"></a>01060             ainv2 = aonv*aonv;
<a name="l01061"></a>01061             temp1 = 3.0*xno2*ainv2;
<a name="l01062"></a>01062             temp  = temp1*root22;
<a name="l01063"></a>01063             *d2201 = temp*f220*g201;
<a name="l01064"></a>01064             *d2211 = temp*f221*g211;
<a name="l01065"></a>01065             temp1 = temp1*aonv;
<a name="l01066"></a>01066             temp  = temp1*root32;
<a name="l01067"></a>01067             *d3210 = temp*f321*g310;
<a name="l01068"></a>01068             *d3222 = temp*f322*g322;
<a name="l01069"></a>01069             temp1 = temp1*aonv;
<a name="l01070"></a>01070             temp  = 2.0*temp1*root44;
<a name="l01071"></a>01071             *d4410 = temp*f441*g410;
<a name="l01072"></a>01072             *d4422 = temp*f442*g422;
<a name="l01073"></a>01073             temp1 = temp1*aonv;
<a name="l01074"></a>01074             temp  = temp1*root52;
<a name="l01075"></a>01075             *d5220 = temp*f522*g520;
<a name="l01076"></a>01076             *d5232 = temp*f523*g532;
<a name="l01077"></a>01077             temp  = 2.0*temp1*root54;
<a name="l01078"></a>01078             *d5421 = temp*f542*g521;
<a name="l01079"></a>01079             *d5433 = temp*f543*g533;
<a name="l01080"></a>01080             *xlamo = fmod(mo + nodeo + nodeo-theta - theta, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01081"></a>01081             *xfact = mdot + *dmdt + 2.0*(nodedot + *dnodt - rptim) - no;
<a name="l01082"></a>01082             *em    = emo;
<a name="l01083"></a>01083             emsq  = emsqo;
<a name="l01084"></a>01084         }
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 
<a name="l01088"></a>01088         <span class="comment">/* ---------------- synchronous resonance terms -------------- */</span>
<a name="l01089"></a>01089         <span class="keywordflow">if</span> (*irez == 1) {
<a name="l01090"></a>01090             g200  = 1.0 + emsq*(-2.5 + 0.8125*emsq);
<a name="l01091"></a>01091             g310  = 1.0 + 2.0*emsq;
<a name="l01092"></a>01092             g300  = 1.0 + emsq*(-6.0 + 6.60937*emsq);
<a name="l01093"></a>01093             f220  = 0.75*(1.0 + cosim)*(1.0 + cosim);
<a name="l01094"></a>01094             f311  = 0.9375*sinim*sinim*(1.0 + 3.0*cosim) - 0.75*(1.0 + cosim);
<a name="l01095"></a>01095             f330  = 1.0 + cosim;
<a name="l01096"></a>01096             f330  = 1.875*f330*f330*f330;
<a name="l01097"></a>01097             *del1  = 3.0 * *nm * *nm*aonv*aonv;
<a name="l01098"></a>01098             *del2  = 2.0 * *del1*f220*g200*q22;
<a name="l01099"></a>01099             *del3  = 3.0 * *del1*f330*g300*q33*aonv;
<a name="l01100"></a>01100             *del1  = *del1*f311*g310*q31*aonv;
<a name="l01101"></a>01101             *xlamo = fmod(mo + nodeo + argpo - theta, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01102"></a>01102             *xfact = mdot + xpidot - rptim + *dmdt + *domdt + *dnodt - no;
<a name="l01103"></a>01103         }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105 
<a name="l01106"></a>01106         <span class="comment">/* ------------ for sgp4, initialize the integrator ---------- */</span>
<a name="l01107"></a>01107         *xli   = *xlamo;
<a name="l01108"></a>01108         *xni   = no;
<a name="l01109"></a>01109         *atime = 0.0;
<a name="l01110"></a>01110         *nm    = no + *dndt;
<a name="l01111"></a>01111 
<a name="l01112"></a>01112     }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 
<a name="l01115"></a>01115 <span class="comment">//#include "debug3.cpp"</span>
<a name="l01116"></a>01116 
<a name="l01117"></a>01117 
<a name="l01118"></a>01118 } <span class="comment">// end dsinit</span>
<a name="l01119"></a>01119 
<a name="l01120"></a>01120 
<a name="l01121"></a>01121 
<a name="l01122"></a>01122 
<a name="l01123"></a>01123 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01124"></a>01124 <span class="comment">*</span>
<a name="l01125"></a>01125 <span class="comment">* procedure dspace</span>
<a name="l01126"></a>01126 <span class="comment">*</span>
<a name="l01127"></a>01127 <span class="comment">* this procedure provides deep space contributions to mean elements for</span>
<a name="l01128"></a>01128 <span class="comment">* perturbing third body. these effects have been averaged over one</span>
<a name="l01129"></a>01129 <span class="comment">* revolution of the sun and moon. for earth resonance effects, the</span>
<a name="l01130"></a>01130 <span class="comment">* effects have been averaged over no revolutions of the satellite.</span>
<a name="l01131"></a>01131 <span class="comment">* (mean motion)</span>
<a name="l01132"></a>01132 <span class="comment">*</span>
<a name="l01133"></a>01133 <span class="comment">* author : david vallado 719-573-2600 28 jun 2005</span>
<a name="l01134"></a>01134 <span class="comment">*</span>
<a name="l01135"></a>01135 <span class="comment">* inputs :</span>
<a name="l01136"></a>01136 <span class="comment">* d2201, d2211, d3210, d3222, d4410, d4422, d5220, d5232, d5421, d5433.</span>
<a name="l01137"></a>01137 <span class="comment">* dedt,</span>
<a name="l01138"></a>01138 <span class="comment">* del1, del2, del3,</span>
<a name="l01139"></a>01139 <span class="comment">* didt,</span>
<a name="l01140"></a>01140 <span class="comment">* dmdt,</span>
<a name="l01141"></a>01141 <span class="comment">* dnodt,</span>
<a name="l01142"></a>01142 <span class="comment">* domdt,</span>
<a name="l01143"></a>01143 <span class="comment">* irez - flag for resonance 0-none, 1-one day, 2-half day</span>
<a name="l01144"></a>01144 <span class="comment">* argpo - argument of perigee</span>
<a name="l01145"></a>01145 <span class="comment">* argpdot - argument of perigee dot (rate)</span>
<a name="l01146"></a>01146 <span class="comment">* t - time</span>
<a name="l01147"></a>01147 <span class="comment">* tc -</span>
<a name="l01148"></a>01148 <span class="comment">* gsto - gst</span>
<a name="l01149"></a>01149 <span class="comment">* xfact -</span>
<a name="l01150"></a>01150 <span class="comment">* xlamo -</span>
<a name="l01151"></a>01151 <span class="comment">* no - mean motion</span>
<a name="l01152"></a>01152 <span class="comment">* atime -</span>
<a name="l01153"></a>01153 <span class="comment">* em - eccentricity</span>
<a name="l01154"></a>01154 <span class="comment">* ft -</span>
<a name="l01155"></a>01155 <span class="comment">* argpm - argument of perigee</span>
<a name="l01156"></a>01156 <span class="comment">* inclm - inclination</span>
<a name="l01157"></a>01157 <span class="comment">* xli -</span>
<a name="l01158"></a>01158 <span class="comment">* mm - mean anomaly</span>
<a name="l01159"></a>01159 <span class="comment">* xni - mean motion</span>
<a name="l01160"></a>01160 <span class="comment">* nodem - right ascension of ascending node</span>
<a name="l01161"></a>01161 <span class="comment">*</span>
<a name="l01162"></a>01162 <span class="comment">* outputs :</span>
<a name="l01163"></a>01163 <span class="comment">*     atime -</span>
<a name="l01164"></a>01164 <span class="comment">*     em - eccentricity</span>
<a name="l01165"></a>01165 <span class="comment">*     argpm - argument of perigee</span>
<a name="l01166"></a>01166 <span class="comment">*     inclm - inclination</span>
<a name="l01167"></a>01167 <span class="comment">*     xli -</span>
<a name="l01168"></a>01168 <span class="comment">*     mm - mean anomaly</span>
<a name="l01169"></a>01169 <span class="comment">*     xni -</span>
<a name="l01170"></a>01170 <span class="comment">*     nodem - right ascension of ascending node</span>
<a name="l01171"></a>01171 <span class="comment">*     dndt -</span>
<a name="l01172"></a>01172 <span class="comment">*     nm - mean motion</span>
<a name="l01173"></a>01173 <span class="comment">*</span>
<a name="l01174"></a>01174 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l01175"></a>01175 
<a name="l01176"></a><a class="code" href="_lgm___sgp_8c.html#58680584e882ac4b3357448060b030a8">01176</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#58680584e882ac4b3357448060b030a8">LgmSgp_dspace</a>( <span class="keywordtype">double</span> tc, <span class="keywordtype">double</span> *atime, <span class="keywordtype">double</span> *em, <span class="keywordtype">double</span> *argpm, 
<a name="l01177"></a>01177         <span class="keywordtype">double</span> *inclm, <span class="keywordtype">double</span> *xli, <span class="keywordtype">double</span> *mm, <span class="keywordtype">double</span> *xni, <span class="keywordtype">double</span> *nodem, <span class="keywordtype">double</span> *dndt, <span class="keywordtype">double</span> *nm, <a class="code" href="struct___sgp_info.html">_SgpInfo</a> *s ) {
<a name="l01178"></a>01178 
<a name="l01179"></a>01179 
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 
<a name="l01183"></a>01183     <span class="keywordtype">int</span>     iretn, iret;
<a name="l01184"></a>01184     <span class="keywordtype">double</span>  delt, ft, theta, x2li, x2omi, xl, xldot, xnddt, xndt, xomi, t;
<a name="l01185"></a>01185     <span class="keywordtype">double</span>  g22, g32, g44, g52, g54, fasx2, fasx4, fasx6, rptim, step2, stepn, stepp;
<a name="l01186"></a>01186 
<a name="l01187"></a>01187 
<a name="l01188"></a>01188     ft    = 0.0;
<a name="l01189"></a>01189     fasx2 = 0.13130908;
<a name="l01190"></a>01190     fasx4 = 2.8843198;
<a name="l01191"></a>01191     fasx6 = 0.37448087;
<a name="l01192"></a>01192     g22   = 5.7686396;
<a name="l01193"></a>01193     g32   = 0.95240898;
<a name="l01194"></a>01194     g44   = 1.8014998;
<a name="l01195"></a>01195     g52   = 1.0508330;
<a name="l01196"></a>01196     g54   = 4.4108898;
<a name="l01197"></a>01197     rptim = 4.37526908801129966e-3; <span class="comment">// this equates to 7.29211514668855e-5 rad/sec</span>
<a name="l01198"></a>01198     stepp = 720.0;
<a name="l01199"></a>01199     stepn = -720.0;
<a name="l01200"></a>01200     step2 = 259200.0;
<a name="l01201"></a>01201 
<a name="l01202"></a>01202 
<a name="l01203"></a>01203 
<a name="l01204"></a>01204 
<a name="l01205"></a>01205     <span class="comment">/* ----------- calculate deep space resonance effects ----------- */</span>
<a name="l01206"></a>01206     t = s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01207"></a>01207     *dndt   = 0.0;
<a name="l01208"></a>01208     theta  = fmod(s-&gt;<a class="code" href="struct___sgp_info.html#a25f72b7facd9726153a3161507fd71e">gsto</a> + tc * rptim, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01209"></a>01209     *em    += s-&gt;<a class="code" href="struct___sgp_info.html#6c4a3f7535bef01f2fb7aa8ae65a1a63">dedt</a>*t;
<a name="l01210"></a>01210     *inclm += s-&gt;<a class="code" href="struct___sgp_info.html#b4f69178e71cb056b53415896f5de48e">didt</a>*t;
<a name="l01211"></a>01211     *argpm += s-&gt;<a class="code" href="struct___sgp_info.html#17500bc363ef2d910381b0b5999c4aaa">domdt</a>*t;
<a name="l01212"></a>01212     *nodem += s-&gt;<a class="code" href="struct___sgp_info.html#eb1fbdf7c8b859e1d4d0212ccc5c903c">dnodt</a>*t;
<a name="l01213"></a>01213     *mm    += s-&gt;<a class="code" href="struct___sgp_info.html#97de9b0087d69e56ed6d89a5d6caef17">dmdt</a>*t;
<a name="l01214"></a>01214 
<a name="l01215"></a>01215 
<a name="l01216"></a>01216     <span class="comment">// sgp4fix for negative inclinations</span>
<a name="l01217"></a>01217     <span class="comment">// the following if statement should be commented out</span>
<a name="l01218"></a>01218     <span class="comment">// if (*inclm &lt; 0.0)</span>
<a name="l01219"></a>01219     <span class="comment">// {</span>
<a name="l01220"></a>01220     <span class="comment">// *inclm = -*inclm;</span>
<a name="l01221"></a>01221     <span class="comment">// argpm = argpm - pi;</span>
<a name="l01222"></a>01222     <span class="comment">// *nodem = *nodem + pi;</span>
<a name="l01223"></a>01223     <span class="comment">// }</span>
<a name="l01224"></a>01224     <span class="comment">/* - update resonances : numerical (euler-maclaurin) integration - */</span>
<a name="l01225"></a>01225     <span class="comment">/* ------------------------- epoch restart ---------------------- */</span>
<a name="l01226"></a>01226     <span class="comment">// sgp4fix for propagator problems</span>
<a name="l01227"></a>01227     <span class="comment">// the following integration works for negative time steps and periods</span>
<a name="l01228"></a>01228     <span class="comment">// the specific changes are unknown because the original code was so convoluted</span>
<a name="l01229"></a>01229     ft = 0.0;
<a name="l01230"></a>01230     *atime = 0.0;
<a name="l01231"></a>01231     <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#2d01b296d1d4611e60cda302675ef46e">irez</a> != 0 ) {
<a name="l01232"></a>01232 
<a name="l01233"></a>01233         <span class="keywordflow">if</span> ((*atime == 0.0) || ((t &gt;= 0.0) &amp;&amp; (*atime &lt; 0.0)) || ((t &lt; 0.0) &amp;&amp; (*atime &gt;= 0.0))) {
<a name="l01234"></a>01234             <span class="keywordflow">if</span> (t &gt;= 0.0) delt = stepp;
<a name="l01235"></a>01235             <span class="keywordflow">else</span>          delt = stepn;
<a name="l01236"></a>01236             *atime = 0.0;
<a name="l01237"></a>01237             s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a>   = s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>;
<a name="l01238"></a>01238             s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a>   = s-&gt;<a class="code" href="struct___sgp_info.html#53f269b680646e524c0d190ceea30d2d">xlamo</a>;
<a name="l01239"></a>01239         }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241         iretn = 381; <span class="comment">// added for do loop</span>
<a name="l01242"></a>01242         iret  = 0; <span class="comment">// added for loop</span>
<a name="l01243"></a>01243 
<a name="l01244"></a>01244         <span class="keywordflow">while</span> ( iretn == 381 ) {
<a name="l01245"></a>01245 
<a name="l01246"></a>01246             <span class="keywordflow">if</span> ((fabs(t) &lt; fabs(*atime)) || (iret == 351)) {
<a name="l01247"></a>01247                 <span class="keywordflow">if</span> (t &gt;= 0.0) delt = stepn;
<a name="l01248"></a>01248                 <span class="keywordflow">else</span>          delt = stepp;
<a name="l01249"></a>01249                 iret  = 351;
<a name="l01250"></a>01250                 iretn = 381;
<a name="l01251"></a>01251             } <span class="keywordflow">else</span> {
<a name="l01252"></a>01252                 <span class="keywordflow">if</span> (t &gt; 0.0) delt = stepp; <span class="comment">// error if prev if has *atime:=0.0 and t:=0.0 (ge)</span>
<a name="l01253"></a>01253                 <span class="keywordflow">else</span>         delt = stepn;
<a name="l01254"></a>01254                 <span class="keywordflow">if</span> (fabs(t - *atime) &gt;= stepp) {
<a name="l01255"></a>01255                     iret  = 0;
<a name="l01256"></a>01256                     iretn = 381;
<a name="l01257"></a>01257                 } <span class="keywordflow">else</span> {
<a name="l01258"></a>01258                     ft    = t - *atime;
<a name="l01259"></a>01259                     iretn = 0;
<a name="l01260"></a>01260                 }
<a name="l01261"></a>01261             }
<a name="l01262"></a>01262 
<a name="l01263"></a>01263 
<a name="l01264"></a>01264 
<a name="l01265"></a>01265             <span class="comment">/* ------------------- dot terms calculated ------------- */</span>
<a name="l01266"></a>01266             <span class="comment">/* ----------- near - synchronous resonance terms ------- */</span>
<a name="l01267"></a>01267             <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#2d01b296d1d4611e60cda302675ef46e">irez</a> != 2) {
<a name="l01268"></a>01268                 xndt  = s-&gt;<a class="code" href="struct___sgp_info.html#8c5ee7600289061b966b0e64ba835e66">del1</a>*sin(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - fasx2) + s-&gt;<a class="code" href="struct___sgp_info.html#f52c4e502051877edca1aec48acabd34">del2</a>*sin(2.0*(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - fasx4)) + s-&gt;<a class="code" href="struct___sgp_info.html#d460879243bdba4b857df0fe993443fe">del3</a>*sin(3.0*(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - fasx6));
<a name="l01269"></a>01269                 xldot = s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a> + s-&gt;<a class="code" href="struct___sgp_info.html#34389a85dd8a65ed941cc23793d4efbf">xfact</a>;
<a name="l01270"></a>01270                 xnddt = s-&gt;<a class="code" href="struct___sgp_info.html#8c5ee7600289061b966b0e64ba835e66">del1</a>*cos(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - fasx2) + 2.0*s-&gt;<a class="code" href="struct___sgp_info.html#f52c4e502051877edca1aec48acabd34">del2</a>*cos(2.0*(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - fasx4)) + 3.0*s-&gt;<a class="code" href="struct___sgp_info.html#d460879243bdba4b857df0fe993443fe">del3</a>*cos(3.0*(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - fasx6));
<a name="l01271"></a>01271                 xnddt = xnddt*xldot;
<a name="l01272"></a>01272             } <span class="keywordflow">else</span> {
<a name="l01273"></a>01273                 <span class="comment">/* --------- near - half-day resonance terms -------- */</span>
<a name="l01274"></a>01274                 xomi  = s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a> + s-&gt;<a class="code" href="struct___sgp_info.html#c9dd4d43db3b68465f53fd7841f2cb96">argpdot</a> * *atime;
<a name="l01275"></a>01275                 x2omi = xomi + xomi;
<a name="l01276"></a>01276                 x2li  = s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a>;
<a name="l01277"></a>01277                 xndt  = s-&gt;<a class="code" href="struct___sgp_info.html#230a89ad405323f2b9926a19395ec04e">d2201</a>*sin(x2omi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g22) + s-&gt;<a class="code" href="struct___sgp_info.html#548a2513409777664a0675a48be0c85a">d2211</a>*sin(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g22) + s-&gt;<a class="code" href="struct___sgp_info.html#a7e79e7ab67d28da1b1b3dac80810655">d3210</a>*sin(xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g32) + s-&gt;<a class="code" href="struct___sgp_info.html#01655415f454f2f669b0055791fdd7fb">d3222</a>*sin(-xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g32)
<a name="l01278"></a>01278                         + s-&gt;<a class="code" href="struct___sgp_info.html#0b8afbe4b3eaca5ad5d895e7e6bb0da3">d4410</a>*sin(x2omi + x2li - g44)+ s-&gt;<a class="code" href="struct___sgp_info.html#71ff139b8068f058073bd65be4a038a4">d4422</a>*sin(x2li - g44) + s-&gt;<a class="code" href="struct___sgp_info.html#bdd287076f628dd8963e31918c477f27">d5220</a>*sin(xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g52) + s-&gt;<a class="code" href="struct___sgp_info.html#6029959a3ce7b1deec5862dab9dc928b">d5232</a>*sin(-xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g52)
<a name="l01279"></a>01279                         + s-&gt;<a class="code" href="struct___sgp_info.html#27382a4e06e4d963a2e268a4e47eb639">d5421</a>*sin(xomi + x2li - g54) + s-&gt;<a class="code" href="struct___sgp_info.html#ed583d24183bddfa0eb67ca6653c9a42">d5433</a>*sin(-xomi + x2li - g54);
<a name="l01280"></a>01280                 xldot = s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a> + s-&gt;<a class="code" href="struct___sgp_info.html#34389a85dd8a65ed941cc23793d4efbf">xfact</a>;
<a name="l01281"></a>01281                 xnddt = s-&gt;<a class="code" href="struct___sgp_info.html#230a89ad405323f2b9926a19395ec04e">d2201</a>*cos(x2omi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g22) + s-&gt;<a class="code" href="struct___sgp_info.html#548a2513409777664a0675a48be0c85a">d2211</a>*cos(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g22) 
<a name="l01282"></a>01282                         + s-&gt;<a class="code" href="struct___sgp_info.html#a7e79e7ab67d28da1b1b3dac80810655">d3210</a>*cos(xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g32) + s-&gt;<a class="code" href="struct___sgp_info.html#01655415f454f2f669b0055791fdd7fb">d3222</a>*cos(-xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g32) 
<a name="l01283"></a>01283                         + s-&gt;<a class="code" href="struct___sgp_info.html#bdd287076f628dd8963e31918c477f27">d5220</a>*cos(xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g52) + s-&gt;<a class="code" href="struct___sgp_info.html#6029959a3ce7b1deec5862dab9dc928b">d5232</a>*cos(-xomi + s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> - g52) 
<a name="l01284"></a>01284                         + 2.0*(s-&gt;<a class="code" href="struct___sgp_info.html#0b8afbe4b3eaca5ad5d895e7e6bb0da3">d4410</a>*cos(x2omi + x2li - g44) 
<a name="l01285"></a>01285                         + s-&gt;<a class="code" href="struct___sgp_info.html#71ff139b8068f058073bd65be4a038a4">d4422</a>*cos(x2li - g44) + s-&gt;<a class="code" href="struct___sgp_info.html#27382a4e06e4d963a2e268a4e47eb639">d5421</a>*cos(xomi + x2li - g54) 
<a name="l01286"></a>01286                         + s-&gt;<a class="code" href="struct___sgp_info.html#ed583d24183bddfa0eb67ca6653c9a42">d5433</a>*cos(-xomi + x2li - g54));
<a name="l01287"></a>01287                 xnddt = xnddt*xldot;
<a name="l01288"></a>01288             }
<a name="l01289"></a>01289 
<a name="l01290"></a>01290             <span class="comment">/* ----------------------- integrator ------------------- */</span>
<a name="l01291"></a>01291             <span class="keywordflow">if</span> (iretn == 381) {
<a name="l01292"></a>01292                 s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a>   += xldot*delt + xndt*step2;
<a name="l01293"></a>01293                 s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a>   += xndt*delt + xnddt*step2;
<a name="l01294"></a>01294                 *atime += delt;
<a name="l01295"></a>01295             }
<a name="l01296"></a>01296 
<a name="l01297"></a>01297         } <span class="comment">// while iretn = 381</span>
<a name="l01298"></a>01298 
<a name="l01299"></a>01299 
<a name="l01300"></a>01300         *nm = s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a> + xndt*ft + xnddt*ft*ft*0.5;
<a name="l01301"></a>01301         xl = s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> + xldot*ft + xndt*ft*ft*0.5;
<a name="l01302"></a>01302 
<a name="l01303"></a>01303         <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#2d01b296d1d4611e60cda302675ef46e">irez</a> != 1) {
<a name="l01304"></a>01304             *mm = xl - 2.0*(*nodem) + 2.0*theta;
<a name="l01305"></a>01305             *dndt = *nm - s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>;
<a name="l01306"></a>01306         } <span class="keywordflow">else</span> {
<a name="l01307"></a>01307             *mm = xl - *nodem - *argpm + theta;
<a name="l01308"></a>01308             *dndt = *nm - s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>;
<a name="l01309"></a>01309         }
<a name="l01310"></a>01310         *nm = s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a> + *dndt;
<a name="l01311"></a>01311     }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313 
<a name="l01314"></a>01314     <span class="comment">//#include "debug4.cpp"</span>
<a name="l01315"></a>01315 
<a name="l01316"></a>01316 
<a name="l01317"></a>01317 } <span class="comment">// end dsspace</span>
<a name="l01318"></a>01318 
<a name="l01319"></a>01319 
<a name="l01320"></a>01320 
<a name="l01321"></a>01321 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01322"></a>01322 <span class="comment">*</span>
<a name="l01323"></a>01323 <span class="comment">* procedure initl</span>
<a name="l01324"></a>01324 <span class="comment">*</span>
<a name="l01325"></a>01325 <span class="comment">* this procedure initializes the spg4 propagator. all the initialization is</span>
<a name="l01326"></a>01326 <span class="comment">* consolidated here instead of having multiple loops inside other routines.</span>
<a name="l01327"></a>01327 <span class="comment">*</span>
<a name="l01328"></a>01328 <span class="comment">* author : david vallado 719-573-2600 28 jun 2005</span>
<a name="l01329"></a>01329 <span class="comment">*</span>
<a name="l01330"></a>01330 <span class="comment">* inputs :</span>
<a name="l01331"></a>01331 <span class="comment">*     ecco - eccentricity 0.0 - 1.0</span>
<a name="l01332"></a>01332 <span class="comment">*     epoch - epoch time in days from jan 0, 1950. 0 hr</span>
<a name="l01333"></a>01333 <span class="comment">*     inclo - inclination of satellite</span>
<a name="l01334"></a>01334 <span class="comment">*     no - mean motion of satellite</span>
<a name="l01335"></a>01335 <span class="comment">*     satn - satellite number</span>
<a name="l01336"></a>01336 <span class="comment">*</span>
<a name="l01337"></a>01337 <span class="comment">* outputs :</span>
<a name="l01338"></a>01338 <span class="comment">*     ainv - 1.0 / a</span>
<a name="l01339"></a>01339 <span class="comment">*     ao - semi major axis</span>
<a name="l01340"></a>01340 <span class="comment">*     con41 -</span>
<a name="l01341"></a>01341 <span class="comment">*     con42 - 1.0 - 5.0 cos(i)</span>
<a name="l01342"></a>01342 <span class="comment">*     cosio - cosine of inclination</span>
<a name="l01343"></a>01343 <span class="comment">*     cosio2 - cosio squared</span>
<a name="l01344"></a>01344 <span class="comment">*     eccsq - eccentricity squared</span>
<a name="l01345"></a>01345 <span class="comment">*     method - flag for deep space 'd', 'n'</span>
<a name="l01346"></a>01346 <span class="comment">*     omeosq - 1.0 - ecco * ecco</span>
<a name="l01347"></a>01347 <span class="comment">*     posq - semi-parameter squared</span>
<a name="l01348"></a>01348 <span class="comment">*     rp - radius of perigee</span>
<a name="l01349"></a>01349 <span class="comment">*     rteosq - square root of (1.0 - ecco*ecco)</span>
<a name="l01350"></a>01350 <span class="comment">*     sinio - sine of inclination</span>
<a name="l01351"></a>01351 <span class="comment">*     gsto - gst at time of observation rad</span>
<a name="l01352"></a>01352 <span class="comment">*     no - mean motion of satellite</span>
<a name="l01353"></a>01353 <span class="comment">*</span>
<a name="l01354"></a>01354 <span class="comment">*</span>
<a name="l01355"></a>01355 <span class="comment">* coupling :</span>
<a name="l01356"></a>01356 <span class="comment">* LgmSgp_GetGravConst</span>
<a name="l01357"></a>01357 <span class="comment">* gstime - find greenwich sidereal time from the julian date</span>
<a name="l01358"></a>01358 <span class="comment">*</span>
<a name="l01359"></a>01359 <span class="comment">* references :</span>
<a name="l01360"></a>01360 <span class="comment">* hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l01361"></a>01361 <span class="comment">* hoots, norad spacetrack report #6 1986</span>
<a name="l01362"></a>01362 <span class="comment">* hoots, schumacher and glover 2004</span>
<a name="l01363"></a>01363 <span class="comment">* vallado, crawford, hujsak, kelso 2006</span>
<a name="l01364"></a>01364 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l01365"></a><a class="code" href="_lgm___sgp_8c.html#f3f227d3dbd22281b684cd11124b838d">01365</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#f3f227d3dbd22281b684cd11124b838d">LgmSgp_initl</a>( <span class="keywordtype">int</span> satn, <span class="keywordtype">int</span> whichconst, <span class="keywordtype">double</span> ecco, <span class="keywordtype">double</span> epoch, <span class="keywordtype">double</span> inclo, 
<a name="l01366"></a>01366                     <span class="keywordtype">double</span> *no, <span class="keywordtype">char</span> *method, <span class="keywordtype">double</span> *ainv, <span class="keywordtype">double</span> *ao, <span class="keywordtype">double</span> *con41, <span class="keywordtype">double</span> *con42, 
<a name="l01367"></a>01367                     <span class="keywordtype">double</span> *cosio, <span class="keywordtype">double</span> *cosio2, <span class="keywordtype">double</span> *eccsq, <span class="keywordtype">double</span> *omeosq, <span class="keywordtype">double</span> *posq, 
<a name="l01368"></a>01368                     <span class="keywordtype">double</span> *rp, <span class="keywordtype">double</span> *rteosq, <span class="keywordtype">double</span> *sinio, <span class="keywordtype">double</span> *gsto) {
<a name="l01369"></a>01369 
<a name="l01370"></a>01370     <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l01371"></a>01371     <span class="keywordtype">double</span>  ak, d1, del, adel, po, x2o3, j2, xke, tumin, radiusearthkm, j3, j4, j3oj2;
<a name="l01372"></a>01372 
<a name="l01373"></a>01373 
<a name="l01374"></a>01374     <span class="comment">/* ----------------------- earth constants ---------------------- */</span>
<a name="l01375"></a>01375     <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l01376"></a>01376     <a class="code" href="_lgm___sgp_8h.html#67d8f3b2acd5863c49efb5ba9e8c2eb7">LgmSgp_GetGravConst</a>( whichconst, &amp;tumin, &amp;radiusearthkm, &amp;xke, &amp;j2, &amp;j3, &amp;j4, &amp;j3oj2 );
<a name="l01377"></a>01377     x2o3 = 2.0 / 3.0;
<a name="l01378"></a>01378 
<a name="l01379"></a>01379 
<a name="l01380"></a>01380     <span class="comment">/* ------------- calculate auxillary epoch quantities ---------- */</span>
<a name="l01381"></a>01381     *eccsq  = ecco*ecco;
<a name="l01382"></a>01382     *omeosq = 1.0 - *eccsq;
<a name="l01383"></a>01383     *rteosq = sqrt(*omeosq);
<a name="l01384"></a>01384     *cosio  = cos(inclo);
<a name="l01385"></a>01385     *cosio2 = (*cosio)*(*cosio);
<a name="l01386"></a>01386 
<a name="l01387"></a>01387 
<a name="l01388"></a>01388     <span class="comment">/* ------------------ un-kozai the mean motion ----------------- */</span>
<a name="l01389"></a>01389     ak      = pow(xke/(*no), x2o3);
<a name="l01390"></a>01390     d1      = 0.75*j2*(3.0*(*cosio2) - 1.0)/((*rteosq)*(*omeosq));
<a name="l01391"></a>01391     del     = d1/(ak*ak);
<a name="l01392"></a>01392     adel    = ak*(1.0 - del*del - del*(1.0/3.0 + 134.0*del*del/81.0));
<a name="l01393"></a>01393     del     = d1/(adel*adel);
<a name="l01394"></a>01394     *no      = *no/(1.0 + del);
<a name="l01395"></a>01395     *ao      = pow(xke/(*no), x2o3);
<a name="l01396"></a>01396     *sinio   = sin(inclo);
<a name="l01397"></a>01397     po      = *ao*(*omeosq);
<a name="l01398"></a>01398     *con42   = 1.0 - 5.0*(*cosio2);
<a name="l01399"></a>01399     *con41   = -(*con42)-(*cosio2)-(*cosio2);
<a name="l01400"></a>01400     *ainv    = 1.0/(*ao);
<a name="l01401"></a>01401     *posq    = po*po;
<a name="l01402"></a>01402     *rp      = *ao*(1.0 - ecco);
<a name="l01403"></a>01403     *method = <span class="charliteral">'n'</span>;
<a name="l01404"></a>01404     *gsto    = <a class="code" href="_lgm___sgp_8h.html#4226a319104ba9b36b55e73a4c1d0d30">LgmSgp_gstime</a>(epoch + 2433281.5);
<a name="l01405"></a>01405 
<a name="l01406"></a>01406     <span class="comment">//#include "debug5.cpp"</span>
<a name="l01407"></a>01407 
<a name="l01408"></a>01408 
<a name="l01409"></a>01409 } <span class="comment">// end LgmSgp_initl</span>
<a name="l01410"></a>01410 
<a name="l01411"></a>01411 
<a name="l01412"></a>01412 
<a name="l01413"></a>01413 
<a name="l01414"></a>01414 
<a name="l01415"></a>01415 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01416"></a>01416 <span class="comment">*</span>
<a name="l01417"></a>01417 <span class="comment">* procedure sgp4init</span>
<a name="l01418"></a>01418 <span class="comment">*</span>
<a name="l01419"></a>01419 <span class="comment">* this procedure initializes variables for sgp4.</span>
<a name="l01420"></a>01420 <span class="comment">*</span>
<a name="l01421"></a>01421 <span class="comment">* author : david vallado 719-573-2600 28 jun 2005</span>
<a name="l01422"></a>01422 <span class="comment">*</span>
<a name="l01423"></a>01423 <span class="comment">* inputs :</span>
<a name="l01424"></a>01424 <span class="comment">* satn - satellite number</span>
<a name="l01425"></a>01425 <span class="comment">* bstar - sgp4 type drag coefficient kg/m2er</span>
<a name="l01426"></a>01426 <span class="comment">* ecco - eccentricity</span>
<a name="l01427"></a>01427 <span class="comment">* epoch - epoch time in days from jan 0, 1950. 0 hr</span>
<a name="l01428"></a>01428 <span class="comment">* argpo - argument of perigee (output if ds)</span>
<a name="l01429"></a>01429 <span class="comment">* inclo - inclination</span>
<a name="l01430"></a>01430 <span class="comment">* mo - mean anomaly (output if ds)</span>
<a name="l01431"></a>01431 <span class="comment">* no - mean motion</span>
<a name="l01432"></a>01432 <span class="comment">* nodeo - right ascension of ascending node</span>
<a name="l01433"></a>01433 <span class="comment">*</span>
<a name="l01434"></a>01434 <span class="comment">* outputs :</span>
<a name="l01435"></a>01435 <span class="comment">* s-&gt;- common values for subsequent calls</span>
<a name="l01436"></a>01436 <span class="comment">* return code - non-zero on error.</span>
<a name="l01437"></a>01437 <span class="comment">* 1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span>
<a name="l01438"></a>01438 <span class="comment">* 2 - mean motion less than 0.0</span>
<a name="l01439"></a>01439 <span class="comment">* 3 - pert elements, ecc &lt; 0.0 or ecc &gt; 1.0</span>
<a name="l01440"></a>01440 <span class="comment">* 4 - semi-latus rectum &lt; 0.0</span>
<a name="l01441"></a>01441 <span class="comment">* 5 - epoch elements are sub-orbital</span>
<a name="l01442"></a>01442 <span class="comment">* 6 - satellite has decayed</span>
<a name="l01443"></a>01443 <span class="comment">*</span>
<a name="l01444"></a>01444 <span class="comment">*</span>
<a name="l01445"></a>01445 <span class="comment">* coupling :</span>
<a name="l01446"></a>01446 <span class="comment">* LgmSgp_GetGravConst-</span>
<a name="l01447"></a>01447 <span class="comment">* initl -</span>
<a name="l01448"></a>01448 <span class="comment">* dscom -</span>
<a name="l01449"></a>01449 <span class="comment">* dpper -</span>
<a name="l01450"></a>01450 <span class="comment">* dsinit -</span>
<a name="l01451"></a>01451 <span class="comment">* sgp4 -</span>
<a name="l01452"></a>01452 <span class="comment">*</span>
<a name="l01453"></a>01453 <span class="comment">* references :</span>
<a name="l01454"></a>01454 <span class="comment">* hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l01455"></a>01455 <span class="comment">* hoots, norad spacetrack report #6 1986</span>
<a name="l01456"></a>01456 <span class="comment">* hoots, schumacher and glover 2004</span>
<a name="l01457"></a>01457 <span class="comment">* vallado, crawford, hujsak, kelso 2006</span>
<a name="l01458"></a>01458 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l01459"></a>01459 
<a name="l01460"></a>01460 
<a name="l01461"></a><a class="code" href="_lgm___sgp_8c.html#19fa3cab6ea1bb0518dce1bb8c2b1c27">01461</a> <span class="keywordtype">int</span> <a class="code" href="_lgm___sgp_8h.html#19fa3cab6ea1bb0518dce1bb8c2b1c27">LgmSgp_SGP4_Init</a>( <a class="code" href="struct___sgp_info.html">_SgpInfo</a> *s, <a class="code" href="struct___sgp_t_l_e.html">_SgpTLE</a> *t ) {
<a name="l01462"></a>01462 
<a name="l01463"></a>01463 
<a name="l01464"></a>01464     <span class="comment">/* --------------------- local variables ------------------------ */</span>
<a name="l01465"></a>01465     <span class="keywordtype">double</span>  ao, ainv, con42, cosio, sinio, cosio2, eccsq, omeosq, posq, rp, rteosq, cnodm;
<a name="l01466"></a>01466     <span class="keywordtype">double</span>  snodm, cosim, sinim, cosomm, sinomm, cc1sq, cc2, cc3, coef, coef1, cosio4, day;
<a name="l01467"></a>01467     <span class="keywordtype">double</span>  dndt, em, emsq, eeta, etasq, gam, argpm, nodem, inclm, mm, nm, perige, pinvsq;
<a name="l01468"></a>01468     <span class="keywordtype">double</span>  psisq, qzms24, rtemsq, s1, s2, s3, s4, s5, s6, s7, sfour, ss1, ss2, ss3, ss4;
<a name="l01469"></a>01469     <span class="keywordtype">double</span>  ss5, ss6, ss7, sz1, sz2, sz3, sz11, sz12, sz13, sz21, sz22, sz23, sz31, sz32;
<a name="l01470"></a>01470     <span class="keywordtype">double</span>  sz33, tc, temp, temp1, temp2, temp3, tsi, xpidot, xhdot1, z1, z2, z3, z11, z12;
<a name="l01471"></a>01471     <span class="keywordtype">double</span>  z13, z21, z22, z23, z31, z32, z33, qzms2t, ss, j2, j3oj2, j4, x2o3;<span class="comment">//, r[3], v[3];</span>
<a name="l01472"></a>01472     <span class="keywordtype">double</span> tumin, radiusearthkm, xke, j3, tmp, tmp2, tmp4;
<a name="l01473"></a>01473 
<a name="l01474"></a>01474     <span class="keywordtype">int</span>     whichconst, satn;
<a name="l01475"></a>01475     <span class="keywordtype">double</span>  epoch, xbstar, xecco, xargpo, xinclo, xmo, xno, xnodeo;
<a name="l01476"></a>01476 
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <span class="comment">// mgh - transfer vars here.</span>
<a name="l01479"></a>01479     whichconst = s-&gt;<a class="code" href="struct___sgp_info.html#a69491b0e6ccf4560cce706b1e089e24">GravConst</a>;
<a name="l01480"></a>01480 whichconst = <a class="code" href="_lgm___sgp_8h.html#79aea7fe700b0a21162a8e5ec55d7eda">SGP_wgs72</a>;
<a name="l01481"></a>01481     satn   = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#8134db9bcf3428082c18dba769258dfd">IdNumber</a>;
<a name="l01482"></a>01482 <span class="comment">//    epoch  = t-&gt;ElementSetEpoch;</span>
<a name="l01483"></a>01483 epoch  = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#fca64005cd84fa9e811dac5219a618ad">JD</a>-2433281.5;
<a name="l01484"></a>01484     xbstar = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#542efb643c91709b678e9a08a27d9e40">BstarDrag</a>;
<a name="l01485"></a>01485     xecco  = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#9e8627236231ee5feff425a382c3cc0d">Eccentricity</a>;
<a name="l01486"></a>01486 
<a name="l01487"></a>01487     xargpo = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#faafa77786dcba9c30db49ee397f3bdc">ArgOfPerigee</a>;
<a name="l01488"></a>01488     xinclo = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#dc4143d3dcc5a8a32498a8d172e0d394">Inclination</a>;
<a name="l01489"></a>01489     xmo    = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#d3d6acdadbbc8715b238f8f6fbf4d4a8">MeanAnomaly</a>;
<a name="l01490"></a>01490     xno    = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#a8230c8489edeb8a5e009088180c9d12">MeanMotion</a>;
<a name="l01491"></a>01491     xnodeo = t-&gt;<a class="code" href="struct___sgp_t_l_e.html#32a0bdaab6be58e1e601ee6c236c681e">RAofAscNode</a>;
<a name="l01492"></a>01492    
<a name="l01493"></a>01493 
<a name="l01494"></a>01494     
<a name="l01495"></a>01495 <span class="keywordtype">double</span> xpdotp = 1440.0/<a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>;
<a name="l01496"></a>01496 xnodeo *= <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;
<a name="l01497"></a>01497 xargpo *= <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;
<a name="l01498"></a>01498 xmo    *= <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;
<a name="l01499"></a>01499 xinclo *= <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0;
<a name="l01500"></a>01500 xno     = xno/xpdotp;
<a name="l01501"></a>01501 <span class="comment">// WHERE ARE THESE SET IN THE NEW STUFF?</span>
<a name="l01502"></a>01502 <span class="comment">//    s-&gt;XNDT2O  =  s-&gt;XNDT2O*tmp;</span>
<a name="l01503"></a>01503 <span class="comment">//    s-&gt;XNDD6O  =  s-&gt;XNDD6O*tmp/SGP_XMNPDA;</span>
<a name="l01504"></a>01504 
<a name="l01505"></a>01505     
<a name="l01506"></a>01506 
<a name="l01507"></a>01507 
<a name="l01508"></a>01508 
<a name="l01509"></a>01509     <span class="comment">/* ------------------------ initialization --------------------- */</span>
<a name="l01510"></a>01510     <span class="comment">// sgp4fix divisor for divide by zero check on inclination</span>
<a name="l01511"></a>01511     <span class="keyword">const</span> <span class="keywordtype">double</span> temp4 = 1.0 + cos(<a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>-1.0e-9);
<a name="l01512"></a>01512 
<a name="l01513"></a>01513 
<a name="l01514"></a>01514     <span class="comment">/* ----------- set all near earth variables to zero ------------ */</span>
<a name="l01515"></a>01515     s-&gt;<a class="code" href="struct___sgp_info.html#633c6d59b92dbf5b830ea47a87b9fc96">isimp</a> = 0;       s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a> = <span class="charliteral">'n'</span>;    s-&gt;<a class="code" href="struct___sgp_info.html#73cf6efaf6896931cb677e94a7d95b4a">aycof</a> = 0.0;
<a name="l01516"></a>01516     s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#aefb3346680163a2f54c8115c6542e94">cc4</a> = 0.0;
<a name="l01517"></a>01517     s-&gt;<a class="code" href="struct___sgp_info.html#02926a7d267c9362ca676c008f4e6c21">cc5</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a> = 0.0;        s-&gt;<a class="code" href="struct___sgp_info.html#483620916658141a26a261c7a5016910">d3</a> = 0.0;
<a name="l01518"></a>01518     s-&gt;<a class="code" href="struct___sgp_info.html#4bdca1913dad0bca307e04c2c8128100">d4</a> = 0.0;        s-&gt;<a class="code" href="struct___sgp_info.html#a4f8567c544bb137f5dc25957c63ac1a">delmo</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a> = 0.0;
<a name="l01519"></a>01519     s-&gt;<a class="code" href="struct___sgp_info.html#c9dd4d43db3b68465f53fd7841f2cb96">argpdot</a> = 0.0;   s-&gt;<a class="code" href="struct___sgp_info.html#9b0060ff74bc3469f158f9d4cfa578ea">omgcof</a> = 0.0;    s-&gt;<a class="code" href="struct___sgp_info.html#ac6611ed753f0b5e0e50d51f6a8fc3b8">sinmao</a> = 0.0;
<a name="l01520"></a>01520     s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a> = 0.0;         s-&gt;<a class="code" href="struct___sgp_info.html#a92271ca6d86502933389f47a9202ab6">t2cof</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#6ead2ed42d4de4759c2a773cbc10d36c">t3cof</a> = 0.0;
<a name="l01521"></a>01521     s-&gt;<a class="code" href="struct___sgp_info.html#9fba2bddd10102492866a46693318781">t4cof</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#3770068f50d6a8b4a73dcec1e8967087">t5cof</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a> = 0.0;
<a name="l01522"></a>01522     s-&gt;<a class="code" href="struct___sgp_info.html#1db2d8883d9dd784b6ae51a031c1266e">x7thm1</a> = 0.0;    s-&gt;<a class="code" href="struct___sgp_info.html#ee90111c98406414a1db98e8c5102e4f">mdot</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#9a7d9ae35fbeac8903eb8ebf5f9d31cc">nodedot</a> = 0.0;
<a name="l01523"></a>01523     s-&gt;<a class="code" href="struct___sgp_info.html#0af92c37e7066a1cb310fb71c91ad369">xlcof</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#f47d9394629b013547ccd3a29072de44">xmcof</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#6ec196aa951f2b53cdbfd43947eb2bce">nodecf</a> = 0.0;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525 
<a name="l01526"></a>01526     <span class="comment">/* ----------- set all deep space variables to zero ------------ */</span>
<a name="l01527"></a>01527     s-&gt;<a class="code" href="struct___sgp_info.html#2d01b296d1d4611e60cda302675ef46e">irez</a> = 0;        s-&gt;<a class="code" href="struct___sgp_info.html#230a89ad405323f2b9926a19395ec04e">d2201</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#548a2513409777664a0675a48be0c85a">d2211</a> = 0.0;
<a name="l01528"></a>01528     s-&gt;<a class="code" href="struct___sgp_info.html#a7e79e7ab67d28da1b1b3dac80810655">d3210</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#01655415f454f2f669b0055791fdd7fb">d3222</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#0b8afbe4b3eaca5ad5d895e7e6bb0da3">d4410</a> = 0.0;
<a name="l01529"></a>01529     s-&gt;<a class="code" href="struct___sgp_info.html#71ff139b8068f058073bd65be4a038a4">d4422</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#bdd287076f628dd8963e31918c477f27">d5220</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#6029959a3ce7b1deec5862dab9dc928b">d5232</a> = 0.0;
<a name="l01530"></a>01530     s-&gt;<a class="code" href="struct___sgp_info.html#27382a4e06e4d963a2e268a4e47eb639">d5421</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#ed583d24183bddfa0eb67ca6653c9a42">d5433</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#6c4a3f7535bef01f2fb7aa8ae65a1a63">dedt</a> = 0.0;
<a name="l01531"></a>01531     s-&gt;<a class="code" href="struct___sgp_info.html#8c5ee7600289061b966b0e64ba835e66">del1</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#f52c4e502051877edca1aec48acabd34">del2</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#d460879243bdba4b857df0fe993443fe">del3</a> = 0.0;
<a name="l01532"></a>01532     s-&gt;<a class="code" href="struct___sgp_info.html#b4f69178e71cb056b53415896f5de48e">didt</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#97de9b0087d69e56ed6d89a5d6caef17">dmdt</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#eb1fbdf7c8b859e1d4d0212ccc5c903c">dnodt</a> = 0.0;
<a name="l01533"></a>01533     s-&gt;<a class="code" href="struct___sgp_info.html#17500bc363ef2d910381b0b5999c4aaa">domdt</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#ff99da95c225d58a2c9acf9aa04a267b">e3</a> = 0.0;        s-&gt;<a class="code" href="struct___sgp_info.html#3907e33c8e58cb154a33174dd8e78179">ee2</a> = 0.0;
<a name="l01534"></a>01534     s-&gt;<a class="code" href="struct___sgp_info.html#689de6e0b3caffccb68dcee94abb1018">peo</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#f56cf39324cbf2fe295bf84dc69e3e8f">pgho</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#6455bb211516d721115c708d51f5beec">pho</a> = 0.0;
<a name="l01535"></a>01535     s-&gt;<a class="code" href="struct___sgp_info.html#3063db50044a10a1805f09ec06904db9">pinco</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#7ad4147f4ca4a74315a064ca7b1817f5">plo</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#5a7f7150e4e1afe1ca272a66d2618936">se2</a> = 0.0;
<a name="l01536"></a>01536     s-&gt;<a class="code" href="struct___sgp_info.html#7881e839568571e07c209edcdf9ac468">se3</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#77544b4b59fd16ed1ac93adfee0eb997">sgh2</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#d42d32067016e78f4583075ea03773b2">sgh3</a> = 0.0;
<a name="l01537"></a>01537     s-&gt;<a class="code" href="struct___sgp_info.html#8333fff103deda5ec256d39b38beabf3">sgh4</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#f39a6d6ec64bcb919784f1c046a5031d">sh2</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#9081e5546a5c993436dcc994592f0c7a">sh3</a> = 0.0;
<a name="l01538"></a>01538     s-&gt;<a class="code" href="struct___sgp_info.html#61a1945bc1d3f4c395b657c4203ceb2a">si2</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#5e144ba52a7d297f9c6dfcd5380e49d1">si3</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#24aba20cbbf42da0d081954b34834924">sl2</a> = 0.0;
<a name="l01539"></a>01539     s-&gt;<a class="code" href="struct___sgp_info.html#18b9a2f918f88752c91b220bf3531d31">sl3</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#234f391445ad2c9894442de5280d0559">sl4</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#a25f72b7facd9726153a3161507fd71e">gsto</a> = 0.0;
<a name="l01540"></a>01540     s-&gt;<a class="code" href="struct___sgp_info.html#34389a85dd8a65ed941cc23793d4efbf">xfact</a> = 0.0;     s-&gt;<a class="code" href="struct___sgp_info.html#12cc589dda276aa5ae735902e6778b7c">xgh2</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#e49feebf68831d39731fa268baba51c1">xgh3</a> = 0.0;
<a name="l01541"></a>01541     s-&gt;<a class="code" href="struct___sgp_info.html#c1fc37ddfcd1eb053bb240d30083455d">xgh4</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#1ae6115c362e5b5450b515b208f46764">xh2</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#b8a252c46a5859f5f5f5f7a3bb0ed3b8">xh3</a> = 0.0;
<a name="l01542"></a>01542     s-&gt;<a class="code" href="struct___sgp_info.html#c3b4de799b764c0819cffc7166a2df10">xi2</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#90e3204b70e2fc9053c1879656ca4bc7">xi3</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#965576393853e94605542dbd4df08cfe">xl2</a> = 0.0;
<a name="l01543"></a>01543     s-&gt;<a class="code" href="struct___sgp_info.html#db2bab7e771a89101eaf1dd3d527fcf3">xl3</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#5233fa6736de1f47b91f58865ea7cb80">xl4</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#53f269b680646e524c0d190ceea30d2d">xlamo</a> = 0.0;
<a name="l01544"></a>01544     s-&gt;<a class="code" href="struct___sgp_info.html#0c8d59633bdce5d61494b16c884903bd">zmol</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#1840b955ac5e5eb7d015f46051df589f">zmos</a> = 0.0;      s-&gt;<a class="code" href="struct___sgp_info.html#ec7bcb1d46812f966d89f66dc1a399ea">atime</a> = 0.0;
<a name="l01545"></a>01545     s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a> = 0.0;       s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a> = 0.0;
<a name="l01546"></a>01546 
<a name="l01547"></a>01547 
<a name="l01548"></a>01548     <span class="comment">// sgp4fix - note the following variables are also passed directly via s-&gt;</span>
<a name="l01549"></a>01549     <span class="comment">// it is possible to streamline the sgp4init call by deleting the "x"</span>
<a name="l01550"></a>01550     <span class="comment">// variables, but the user would need to set the s-&gt;* values first. we</span>
<a name="l01551"></a>01551     <span class="comment">// include the additional assignments in case twoline2rv is not used.</span>
<a name="l01552"></a>01552     s-&gt;<a class="code" href="struct___sgp_info.html#e385ed1815b61e4a30b2ab3165514f71">bstar</a> = xbstar;
<a name="l01553"></a>01553     s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>  = xecco;
<a name="l01554"></a>01554     s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a> = xargpo;
<a name="l01555"></a>01555     s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a> = xinclo;
<a name="l01556"></a>01556     s-&gt;<a class="code" href="struct___sgp_info.html#bf05d62d7ad39d494816d23dd19b9325">mo</a>    = xmo;
<a name="l01557"></a>01557     s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>    = xno;
<a name="l01558"></a>01558     s-&gt;<a class="code" href="struct___sgp_info.html#8496b25cf07aff8b5d0944cc2e229778">nodeo</a> = xnodeo;
<a name="l01559"></a>01559 
<a name="l01560"></a>01560     <span class="comment">/* ------------------------ earth constants ----------------------- */</span>
<a name="l01561"></a>01561     <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l01562"></a>01562     <a class="code" href="_lgm___sgp_8h.html#67d8f3b2acd5863c49efb5ba9e8c2eb7">LgmSgp_GetGravConst</a>( whichconst, &amp;tumin, &amp;radiusearthkm, &amp;xke, &amp;j2, &amp;j3, &amp;j4, &amp;j3oj2 );
<a name="l01563"></a>01563     ss     = 78.0 / radiusearthkm + 1.0;
<a name="l01564"></a>01564     qzms2t = pow(((120.0 - 78.0) / radiusearthkm), 4);
<a name="l01565"></a>01565     x2o3   = 2.0 / 3.0;
<a name="l01566"></a>01566     s-&gt;<a class="code" href="struct___sgp_info.html#6a9691d2260a0c4c1a531b79d708520a">init</a> = <span class="charliteral">'y'</span>;
<a name="l01567"></a>01567     s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a> = 0.0;
<a name="l01568"></a>01568 
<a name="l01569"></a>01569 
<a name="l01570"></a>01570     <a class="code" href="_lgm___sgp_8h.html#f3f227d3dbd22281b684cd11124b838d">LgmSgp_initl</a>( satn, whichconst, s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>, epoch, s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a>, 
<a name="l01571"></a>01571             &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a>), &amp;ainv, &amp;ao, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a>), &amp;con42, 
<a name="l01572"></a>01572             &amp;cosio, &amp;cosio2, &amp;eccsq, &amp;omeosq, &amp;posq, 
<a name="l01573"></a>01573             &amp;rp, &amp;rteosq, &amp;sinio, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#a25f72b7facd9726153a3161507fd71e">gsto</a>));
<a name="l01574"></a>01574     s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 0;
<a name="l01575"></a>01575     <span class="keywordflow">if</span> (rp &lt; 1.0) {
<a name="l01576"></a>01576         <span class="comment">// printf("# *** satn%d epoch elts sub-orbital ***\n", satn);</span>
<a name="l01577"></a>01577         s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 5;
<a name="l01578"></a>01578     }
<a name="l01579"></a>01579 
<a name="l01580"></a>01580 
<a name="l01581"></a>01581 
<a name="l01582"></a>01582     <span class="keywordflow">if</span> ((omeosq &gt;= 0.0 ) || ( s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a> &gt;= 0.0)) {
<a name="l01583"></a>01583 
<a name="l01584"></a>01584         s-&gt;<a class="code" href="struct___sgp_info.html#633c6d59b92dbf5b830ea47a87b9fc96">isimp</a> = (rp &lt; (220.0/radiusearthkm + 1.0)) ? 1 : 0;
<a name="l01585"></a>01585         sfour  = ss;
<a name="l01586"></a>01586         qzms24 = qzms2t;
<a name="l01587"></a>01587         perige = (rp - 1.0) * radiusearthkm;
<a name="l01588"></a>01588 
<a name="l01589"></a>01589         <span class="comment">/* - for perigees below 156 km, s and qoms2t are altered - */</span>
<a name="l01590"></a>01590         <span class="keywordflow">if</span> (perige &lt; 156.0) {
<a name="l01591"></a>01591             sfour  = perige - 78.0;
<a name="l01592"></a>01592             <span class="keywordflow">if</span> (perige &lt; 98.0) sfour = 20.0;
<a name="l01593"></a>01593             qzms24 = pow(((120.0 - sfour) / radiusearthkm), 4.0);
<a name="l01594"></a>01594             sfour  = sfour / radiusearthkm + 1.0;
<a name="l01595"></a>01595         }
<a name="l01596"></a>01596 
<a name="l01597"></a>01597         pinvsq = 1.0 / posq;
<a name="l01598"></a>01598         tsi    = 1.0 / (ao - sfour);
<a name="l01599"></a>01599         s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a> = ao * s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a> * tsi;
<a name="l01600"></a>01600         etasq = s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a> * s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a>;
<a name="l01601"></a>01601         eeta  = s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a> * s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a>;
<a name="l01602"></a>01602         psisq = fabs(1.0 - etasq);
<a name="l01603"></a>01603         tmp2  = tsi*tsi; tmp4=tmp2*tmp2;
<a name="l01604"></a>01604         coef  = qzms24 * tmp4;
<a name="l01605"></a>01605         coef1 = coef / pow(psisq, 3.5);
<a name="l01606"></a>01606         cc2   = coef1*s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>*(ao*(1.0 + 1.5*etasq + eeta*(4.0 + etasq)) + 0.375*j2
<a name="l01607"></a>01607                 *tsi/psisq*s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a>*(8.0 + 3.0*etasq*(8.0 + etasq)));
<a name="l01608"></a>01608         s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a> = s-&gt;<a class="code" href="struct___sgp_info.html#e385ed1815b61e4a30b2ab3165514f71">bstar</a> * cc2;
<a name="l01609"></a>01609         cc3 = 0.0;
<a name="l01610"></a>01610         <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a> &gt; 1.0e-4) cc3 = -2.0*coef*tsi*j3oj2*s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>*sinio/s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>;
<a name="l01611"></a>01611         s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a> = 1.0 - cosio2;
<a name="l01612"></a>01612         s-&gt;<a class="code" href="struct___sgp_info.html#aefb3346680163a2f54c8115c6542e94">cc4</a> = 2.0*s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>*coef1*ao*omeosq
<a name="l01613"></a>01613                         *(s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a>*(2.0 + 0.5*etasq) + s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>*(0.5 + 2.0*etasq) 
<a name="l01614"></a>01614                             - j2*tsi/(ao*psisq)*(-3.0*s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a>*(1.0 - 2.0*eeta + etasq*(1.5 - 0.5*eeta)) 
<a name="l01615"></a>01615                             + 0.75*s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a>*(2.0*etasq - eeta*(1.0 + etasq))*cos(2.0*s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a>)));
<a name="l01616"></a>01616 
<a name="l01617"></a>01617         s-&gt;<a class="code" href="struct___sgp_info.html#02926a7d267c9362ca676c008f4e6c21">cc5</a> = 2.0*coef1*ao*omeosq*(1.0 + 2.75*(etasq + eeta) + eeta*etasq);
<a name="l01618"></a>01618         cosio4 = cosio2 * cosio2;
<a name="l01619"></a>01619         temp1  = 1.5 * j2 * pinvsq * s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>;
<a name="l01620"></a>01620         temp2  = 0.5 * temp1 * j2 * pinvsq;
<a name="l01621"></a>01621         temp3  = -0.46875 * j4 * pinvsq * pinvsq * s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>;
<a name="l01622"></a>01622         s-&gt;<a class="code" href="struct___sgp_info.html#ee90111c98406414a1db98e8c5102e4f">mdot</a>    = s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a> + 0.5*temp1*rteosq*s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a> + 0.0625*temp2*rteosq*(13.0 - 78.0*cosio2 + 137.0*cosio4);
<a name="l01623"></a>01623         s-&gt;<a class="code" href="struct___sgp_info.html#c9dd4d43db3b68465f53fd7841f2cb96">argpdot</a> = -0.5*temp1*con42 + 0.0625*temp2*(7.0 - 114.0*cosio2 + 395.0*cosio4) + temp3*(3.0 - 36.0*cosio2 + 49.0*cosio4);
<a name="l01624"></a>01624         xhdot1     = -temp1*cosio;
<a name="l01625"></a>01625         s-&gt;<a class="code" href="struct___sgp_info.html#9a7d9ae35fbeac8903eb8ebf5f9d31cc">nodedot</a> = xhdot1 + (0.5*temp2*(4.0 - 19.0*cosio2) + 2.0*temp3*(3.0 - 7.0*cosio2))*cosio;
<a name="l01626"></a>01626         xpidot     = s-&gt;<a class="code" href="struct___sgp_info.html#c9dd4d43db3b68465f53fd7841f2cb96">argpdot</a>+ s-&gt;<a class="code" href="struct___sgp_info.html#9a7d9ae35fbeac8903eb8ebf5f9d31cc">nodedot</a>;
<a name="l01627"></a>01627         s-&gt;<a class="code" href="struct___sgp_info.html#9b0060ff74bc3469f158f9d4cfa578ea">omgcof</a>  = s-&gt;<a class="code" href="struct___sgp_info.html#e385ed1815b61e4a30b2ab3165514f71">bstar</a> * cc3 * cos(s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a>);
<a name="l01628"></a>01628         s-&gt;<a class="code" href="struct___sgp_info.html#f47d9394629b013547ccd3a29072de44">xmcof</a>   = 0.0;
<a name="l01629"></a>01629         <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a> &gt; 1.0e-4) s-&gt;<a class="code" href="struct___sgp_info.html#f47d9394629b013547ccd3a29072de44">xmcof</a> = -x2o3*coef*s-&gt;<a class="code" href="struct___sgp_info.html#e385ed1815b61e4a30b2ab3165514f71">bstar</a>/eeta;
<a name="l01630"></a>01630         s-&gt;<a class="code" href="struct___sgp_info.html#6ec196aa951f2b53cdbfd43947eb2bce">nodecf</a>  = 3.5*omeosq*xhdot1*s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>;
<a name="l01631"></a>01631         s-&gt;<a class="code" href="struct___sgp_info.html#a92271ca6d86502933389f47a9202ab6">t2cof</a>   = 1.5*s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>;
<a name="l01632"></a>01632 
<a name="l01633"></a>01633         <span class="comment">// sgp4fix for divide by zero with xinco = 180 deg</span>
<a name="l01634"></a>01634         <span class="keywordflow">if</span> (fabs(cosio+1.0) &gt; 1.5e-12) s-&gt;<a class="code" href="struct___sgp_info.html#0af92c37e7066a1cb310fb71c91ad369">xlcof</a> = -0.25*j3oj2*sinio*(3.0 + 5.0*cosio)/(1.0 + cosio);
<a name="l01635"></a>01635         <span class="keywordflow">else</span>                           s-&gt;<a class="code" href="struct___sgp_info.html#0af92c37e7066a1cb310fb71c91ad369">xlcof</a> = -0.25*j3oj2*sinio*(3.0 + 5.0*cosio)/temp4;
<a name="l01636"></a>01636 
<a name="l01637"></a>01637         s-&gt;<a class="code" href="struct___sgp_info.html#73cf6efaf6896931cb677e94a7d95b4a">aycof</a>  = -0.5*j3oj2*sinio;
<a name="l01638"></a>01638         tmp       = 1.0 + s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a>*cos(s-&gt;<a class="code" href="struct___sgp_info.html#bf05d62d7ad39d494816d23dd19b9325">mo</a>);
<a name="l01639"></a>01639         s-&gt;<a class="code" href="struct___sgp_info.html#a4f8567c544bb137f5dc25957c63ac1a">delmo</a>  = tmp*tmp*tmp;
<a name="l01640"></a>01640         s-&gt;<a class="code" href="struct___sgp_info.html#ac6611ed753f0b5e0e50d51f6a8fc3b8">sinmao</a> = sin(s-&gt;<a class="code" href="struct___sgp_info.html#bf05d62d7ad39d494816d23dd19b9325">mo</a>);
<a name="l01641"></a>01641         s-&gt;<a class="code" href="struct___sgp_info.html#1db2d8883d9dd784b6ae51a031c1266e">x7thm1</a> = 7.0*cosio2 - 1.0;
<a name="l01642"></a>01642 
<a name="l01643"></a>01643         <span class="comment">/* --------------- deep space initialization ------------- */</span>
<a name="l01644"></a>01644         <span class="keywordflow">if</span> ((2.0*<a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>) &gt;= 225.0) {
<a name="l01645"></a>01645             s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a> = <span class="charliteral">'d'</span>;
<a name="l01646"></a>01646             s-&gt;<a class="code" href="struct___sgp_info.html#633c6d59b92dbf5b830ea47a87b9fc96">isimp</a>  = 1;
<a name="l01647"></a>01647             tc        = 0.0;
<a name="l01648"></a>01648             inclm     = s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a>;
<a name="l01649"></a>01649             <span class="comment">// mgh - this is the stupidest coding Ive seen in a long time...</span>
<a name="l01650"></a>01650             <a class="code" href="_lgm___sgp_8h.html#584c10e9b76c3814acb6ac927d11dfdf">LgmSgp_dscom</a>( epoch, s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>, s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a>, tc, s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a>, s-&gt;<a class="code" href="struct___sgp_info.html#8496b25cf07aff8b5d0944cc2e229778">nodeo</a>, s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>, 
<a name="l01651"></a>01651                             &amp;snodm, &amp;cnodm, &amp;sinim, &amp;cosim, &amp;sinomm, &amp;cosomm, &amp;day, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#ff99da95c225d58a2c9acf9aa04a267b">e3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#3907e33c8e58cb154a33174dd8e78179">ee2</a>), &amp;em, &amp;emsq, &amp;gam, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#689de6e0b3caffccb68dcee94abb1018">peo</a>), 
<a name="l01652"></a>01652                             &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#f56cf39324cbf2fe295bf84dc69e3e8f">pgho</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#6455bb211516d721115c708d51f5beec">pho</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#3063db50044a10a1805f09ec06904db9">pinco</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#7ad4147f4ca4a74315a064ca7b1817f5">plo</a>), &amp;rtemsq, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#5a7f7150e4e1afe1ca272a66d2618936">se2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#7881e839568571e07c209edcdf9ac468">se3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#77544b4b59fd16ed1ac93adfee0eb997">sgh2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#d42d32067016e78f4583075ea03773b2">sgh3</a>), 
<a name="l01653"></a>01653                             &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#8333fff103deda5ec256d39b38beabf3">sgh4</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#f39a6d6ec64bcb919784f1c046a5031d">sh2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#9081e5546a5c993436dcc994592f0c7a">sh3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#61a1945bc1d3f4c395b657c4203ceb2a">si2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#5e144ba52a7d297f9c6dfcd5380e49d1">si3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#24aba20cbbf42da0d081954b34834924">sl2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#18b9a2f918f88752c91b220bf3531d31">sl3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#234f391445ad2c9894442de5280d0559">sl4</a>), &amp;s1, &amp;s2, &amp;s3, 
<a name="l01654"></a>01654                             &amp;s4, &amp;s5, &amp;s6, &amp;s7, &amp;ss1, &amp;ss2, &amp;ss3, &amp;ss4, &amp;ss5, &amp;ss6, &amp;ss7, &amp;sz1, &amp;sz2, &amp;sz3, &amp;sz11, &amp;sz12, &amp;sz13, 
<a name="l01655"></a>01655                             &amp;sz21, &amp;sz22, &amp;sz23, &amp;sz31, &amp;sz32, &amp;sz33, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#12cc589dda276aa5ae735902e6778b7c">xgh2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#e49feebf68831d39731fa268baba51c1">xgh3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#c1fc37ddfcd1eb053bb240d30083455d">xgh4</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#1ae6115c362e5b5450b515b208f46764">xh2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#b8a252c46a5859f5f5f5f7a3bb0ed3b8">xh3</a>), 
<a name="l01656"></a>01656                             &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#c3b4de799b764c0819cffc7166a2df10">xi2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#90e3204b70e2fc9053c1879656ca4bc7">xi3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#965576393853e94605542dbd4df08cfe">xl2</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#db2bab7e771a89101eaf1dd3d527fcf3">xl3</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#5233fa6736de1f47b91f58865ea7cb80">xl4</a>), &amp;nm, &amp;z1, &amp;z2, &amp;z3, &amp;z11, &amp;z12, &amp;z13, &amp;z21, 
<a name="l01657"></a>01657                             &amp;z22, &amp;z23, &amp;z31, &amp;z32, &amp;z33, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#0c8d59633bdce5d61494b16c884903bd">zmol</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#1840b955ac5e5eb7d015f46051df589f">zmos</a>) );
<a name="l01658"></a>01658 
<a name="l01659"></a>01659             <a class="code" href="_lgm___sgp_8h.html#3a3d1ab6587159dd6059bf83aa4b6924">LgmSgp_dpper</a>( inclm, s-&gt;<a class="code" href="struct___sgp_info.html#6a9691d2260a0c4c1a531b79d708520a">init</a>, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#8496b25cf07aff8b5d0944cc2e229778">nodeo</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a>), &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#bf05d62d7ad39d494816d23dd19b9325">mo</a>), s );
<a name="l01660"></a>01660 
<a name="l01661"></a>01661             argpm = 0.0;
<a name="l01662"></a>01662             nodem = 0.0;
<a name="l01663"></a>01663             mm    = 0.0;
<a name="l01664"></a>01664             <a class="code" href="_lgm___sgp_8h.html#f068d9816c00ad56633a4dbfe8eb47b8">LgmSgp_dsinit</a>( whichconst, cosim, emsq, s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a>, s1, s2, s3, s4, s5, sinim, ss1, ss2, ss3, ss4, ss5, sz1, sz3, 
<a name="l01665"></a>01665                             sz11, sz13, sz21, sz23, sz31, sz33, s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>, tc, s-&gt;<a class="code" href="struct___sgp_info.html#a25f72b7facd9726153a3161507fd71e">gsto</a>, s-&gt;<a class="code" href="struct___sgp_info.html#bf05d62d7ad39d494816d23dd19b9325">mo</a>, s-&gt;<a class="code" href="struct___sgp_info.html#ee90111c98406414a1db98e8c5102e4f">mdot</a>, s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>, s-&gt;<a class="code" href="struct___sgp_info.html#8496b25cf07aff8b5d0944cc2e229778">nodeo</a>, s-&gt;<a class="code" href="struct___sgp_info.html#9a7d9ae35fbeac8903eb8ebf5f9d31cc">nodedot</a>, 
<a name="l01666"></a>01666                             xpidot, z1, z3, z11, z13, z21, z23, z31, z33, s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>, eccsq, 
<a name="l01667"></a>01667                             &amp;em, &amp;argpm, &amp;inclm, &amp;mm, &amp;nm, &amp;nodem, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#2d01b296d1d4611e60cda302675ef46e">irez</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#ec7bcb1d46812f966d89f66dc1a399ea">atime</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#230a89ad405323f2b9926a19395ec04e">d2201</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#548a2513409777664a0675a48be0c85a">d2211</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#a7e79e7ab67d28da1b1b3dac80810655">d3210</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#01655415f454f2f669b0055791fdd7fb">d3222</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#0b8afbe4b3eaca5ad5d895e7e6bb0da3">d4410</a>, 
<a name="l01668"></a>01668                             &amp;s-&gt;<a class="code" href="struct___sgp_info.html#71ff139b8068f058073bd65be4a038a4">d4422</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#bdd287076f628dd8963e31918c477f27">d5220</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#6029959a3ce7b1deec5862dab9dc928b">d5232</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#27382a4e06e4d963a2e268a4e47eb639">d5421</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#ed583d24183bddfa0eb67ca6653c9a42">d5433</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#6c4a3f7535bef01f2fb7aa8ae65a1a63">dedt</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#b4f69178e71cb056b53415896f5de48e">didt</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#97de9b0087d69e56ed6d89a5d6caef17">dmdt</a>, &amp;dndt, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#eb1fbdf7c8b859e1d4d0212ccc5c903c">dnodt</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#17500bc363ef2d910381b0b5999c4aaa">domdt</a>, 
<a name="l01669"></a>01669                             &amp;s-&gt;<a class="code" href="struct___sgp_info.html#8c5ee7600289061b966b0e64ba835e66">del1</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#f52c4e502051877edca1aec48acabd34">del2</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#d460879243bdba4b857df0fe993443fe">del3</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#34389a85dd8a65ed941cc23793d4efbf">xfact</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#53f269b680646e524c0d190ceea30d2d">xlamo</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a>, &amp;s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a>);
<a name="l01670"></a>01670         }
<a name="l01671"></a>01671 
<a name="l01672"></a>01672 
<a name="l01673"></a>01673 
<a name="l01674"></a>01674 
<a name="l01675"></a>01675         <span class="comment">/* ----------- set variables if not deep space ----------- */</span>
<a name="l01676"></a>01676         <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#633c6d59b92dbf5b830ea47a87b9fc96">isimp</a> != 1 ) {
<a name="l01677"></a>01677             cc1sq    = s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>*s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>;
<a name="l01678"></a>01678             s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a>    = 4.0*ao*tsi*cc1sq;
<a name="l01679"></a>01679             temp     = s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a>*tsi*s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>/3.0;
<a name="l01680"></a>01680             s-&gt;<a class="code" href="struct___sgp_info.html#483620916658141a26a261c7a5016910">d3</a>    = (17.0*ao + sfour)*temp;
<a name="l01681"></a>01681             s-&gt;<a class="code" href="struct___sgp_info.html#4bdca1913dad0bca307e04c2c8128100">d4</a>    = 0.5*temp*ao*tsi*(221.0*ao + 31.0*sfour)*s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>;
<a name="l01682"></a>01682             s-&gt;<a class="code" href="struct___sgp_info.html#6ead2ed42d4de4759c2a773cbc10d36c">t3cof</a> = s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a> + 2.0*cc1sq;
<a name="l01683"></a>01683             s-&gt;<a class="code" href="struct___sgp_info.html#9fba2bddd10102492866a46693318781">t4cof</a> = 0.25*(3.0*s-&gt;<a class="code" href="struct___sgp_info.html#483620916658141a26a261c7a5016910">d3</a> + s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>*(12.0*s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a> + 10.0*cc1sq));
<a name="l01684"></a>01684             s-&gt;<a class="code" href="struct___sgp_info.html#3770068f50d6a8b4a73dcec1e8967087">t5cof</a> = 0.2*(3.0*s-&gt;<a class="code" href="struct___sgp_info.html#4bdca1913dad0bca307e04c2c8128100">d4</a> + 12.0*s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>*s-&gt;<a class="code" href="struct___sgp_info.html#483620916658141a26a261c7a5016910">d3</a> + 6.0*s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a>*s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a> + 15.0*cc1sq*(2.0*s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a> + cc1sq));
<a name="l01685"></a>01685         }
<a name="l01686"></a>01686 
<a name="l01687"></a>01687 
<a name="l01688"></a>01688     } <span class="comment">// if omeosq = 0 ...</span>
<a name="l01689"></a>01689 
<a name="l01690"></a>01690 
<a name="l01691"></a>01691 
<a name="l01692"></a>01692 
<a name="l01693"></a>01693 
<a name="l01694"></a>01694     <span class="comment">/* finally propogate to zero epoch to initialise all others. */</span>
<a name="l01695"></a>01695 <span class="comment">//FIX ME</span>
<a name="l01696"></a>01696 s-&gt;<a class="code" href="struct___sgp_info.html#a69491b0e6ccf4560cce706b1e089e24">GravConst</a> = whichconst;
<a name="l01697"></a>01697 <span class="keywordflow">if</span> (s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> == 0) <a class="code" href="_lgm___sgp_8h.html#3aac1ba553258a14780ab9422adfdaa1">LgmSgp_SGP4</a>( 0.0, s );
<a name="l01698"></a>01698     s-&gt;<a class="code" href="struct___sgp_info.html#6a9691d2260a0c4c1a531b79d708520a">init</a> = <span class="charliteral">'n'</span>;
<a name="l01699"></a>01699 
<a name="l01700"></a>01700     <span class="comment">//#include "debug6.cpp"</span>
<a name="l01701"></a>01701     <span class="keywordflow">return</span>( s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> );
<a name="l01702"></a>01702 
<a name="l01703"></a>01703 
<a name="l01704"></a>01704 
<a name="l01705"></a>01705 } <span class="comment">// end sgp4init</span>
<a name="l01706"></a>01706 
<a name="l01707"></a>01707 
<a name="l01708"></a>01708 
<a name="l01709"></a>01709 <span class="comment">/* -----------------------------------------------------------------------------</span>
<a name="l01710"></a>01710 <span class="comment">*</span>
<a name="l01711"></a>01711 <span class="comment">* function LgmSgp_GetGravConst</span>
<a name="l01712"></a>01712 <span class="comment">*</span>
<a name="l01713"></a>01713 <span class="comment">* this function gets constants for the propagator. note that mu is identified to</span>
<a name="l01714"></a>01714 <span class="comment">* facilitiate comparisons with newer models.</span>
<a name="l01715"></a>01715 <span class="comment">*</span>
<a name="l01716"></a>01716 <span class="comment">* author : david vallado 719-573-2600 21 jul 2006</span>
<a name="l01717"></a>01717 <span class="comment">*</span>
<a name="l01718"></a>01718 <span class="comment">* mods: Mike Henderson 20, feb 2009 -- changed arg passing</span>
<a name="l01719"></a>01719 <span class="comment">*</span>
<a name="l01720"></a>01720 <span class="comment">* inputs :</span>
<a name="l01721"></a>01721 <span class="comment">* whichconst - which set of constants to use 72, 84</span>
<a name="l01722"></a>01722 <span class="comment">*</span>
<a name="l01723"></a>01723 <span class="comment">* outputs :</span>
<a name="l01724"></a>01724 <span class="comment">* tumin - minutes in one time unit</span>
<a name="l01725"></a>01725 <span class="comment">* radiusearthkm - radius of the earth in km</span>
<a name="l01726"></a>01726 <span class="comment">* xke - reciprocal of tumin</span>
<a name="l01727"></a>01727 <span class="comment">* j2, j3, j4 - un-normalized zonal harmonic values</span>
<a name="l01728"></a>01728 <span class="comment">* j3oj2 - j3 divided by j2</span>
<a name="l01729"></a>01729 <span class="comment">*</span>
<a name="l01730"></a>01730 <span class="comment">* locals :</span>
<a name="l01731"></a>01731 <span class="comment">* mu - earth gravitational parameter</span>
<a name="l01732"></a>01732 <span class="comment">*</span>
<a name="l01733"></a>01733 <span class="comment">* coupling :</span>
<a name="l01734"></a>01734 <span class="comment">* none</span>
<a name="l01735"></a>01735 <span class="comment">*</span>
<a name="l01736"></a>01736 <span class="comment">* references :</span>
<a name="l01737"></a>01737 <span class="comment">* norad spacetrack report #3</span>
<a name="l01738"></a>01738 <span class="comment">* vallado, crawford, hujsak, kelso 2006</span>
<a name="l01739"></a>01739 <span class="comment">--------------------------------------------------------------------------- */</span>
<a name="l01740"></a><a class="code" href="_lgm___sgp_8c.html#67d8f3b2acd5863c49efb5ba9e8c2eb7">01740</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sgp_8h.html#67d8f3b2acd5863c49efb5ba9e8c2eb7">LgmSgp_GetGravConst</a>( <span class="keywordtype">int</span> whichconst, <span class="keywordtype">double</span> *tumin, <span class="keywordtype">double</span> *radiusearthkm,
<a name="l01741"></a>01741                     <span class="keywordtype">double</span> *xke, <span class="keywordtype">double</span> *j2, <span class="keywordtype">double</span> *j3, <span class="keywordtype">double</span> *j4, <span class="keywordtype">double</span> *j3oj2 ) {
<a name="l01742"></a>01742 
<a name="l01743"></a>01743     <span class="keywordtype">double</span> mu;
<a name="l01744"></a>01744 
<a name="l01745"></a>01745     <span class="keywordflow">switch</span> ( whichconst ) {
<a name="l01746"></a>01746 
<a name="l01747"></a>01747 
<a name="l01748"></a>01748             <span class="comment">// -- wgs-72 low precision str#3 constants --</span>
<a name="l01749"></a>01749             <span class="keywordflow">case</span> <a class="code" href="_lgm___sgp_8h.html#2b1fb599568ec105a79da8f7b8ae4195">SGP_wgs72old</a>:
<a name="l01750"></a>01750                 *radiusearthkm = 6378.135; <span class="comment">// km</span>
<a name="l01751"></a>01751                 *xke = 0.0743669161;
<a name="l01752"></a>01752                 *tumin = 1.0 / *xke;
<a name="l01753"></a>01753                 *j2 = 0.001082616;
<a name="l01754"></a>01754                 *j3 = -0.00000253881;
<a name="l01755"></a>01755                 *j4 = -0.00000165597;
<a name="l01756"></a>01756                 *j3oj2 = *j3 / *j2;
<a name="l01757"></a>01757                 <span class="keywordflow">break</span>;
<a name="l01758"></a>01758             <span class="comment">// ------------ wgs-72 constants ------------</span>
<a name="l01759"></a>01759             <span class="keywordflow">case</span> <a class="code" href="_lgm___sgp_8h.html#79aea7fe700b0a21162a8e5ec55d7eda">SGP_wgs72</a>:
<a name="l01760"></a>01760                 mu = 398600.8; <span class="comment">// in km3 / s2</span>
<a name="l01761"></a>01761                 *radiusearthkm = 6378.135; <span class="comment">// km</span>
<a name="l01762"></a>01762                 *xke = 60.0 / sqrt( (*radiusearthkm) * (*radiusearthkm) * (*radiusearthkm)/mu);
<a name="l01763"></a>01763                 *tumin = 1.0 / *xke;
<a name="l01764"></a>01764                 *j2 = 0.001082616;
<a name="l01765"></a>01765                 *j3 = -0.00000253881;
<a name="l01766"></a>01766                 *j4 = -0.00000165597;
<a name="l01767"></a>01767                 *j3oj2 = *j3 / *j2;
<a name="l01768"></a>01768                 <span class="keywordflow">break</span>;
<a name="l01769"></a>01769             <span class="keywordflow">case</span> <a class="code" href="_lgm___sgp_8h.html#e2a125aa75f07faf173e5dc265926983">SGP_wgs84</a>:
<a name="l01770"></a>01770                 <span class="comment">// ------------ wgs-84 constants ------------</span>
<a name="l01771"></a>01771                 mu = 398600.5; <span class="comment">// in km3 / s2</span>
<a name="l01772"></a>01772                 *radiusearthkm = 6378.137; <span class="comment">// km</span>
<a name="l01773"></a>01773                 *xke = 60.0 / sqrt( (*radiusearthkm) * (*radiusearthkm) * (*radiusearthkm)/mu);
<a name="l01774"></a>01774                 *tumin = 1.0 / *xke;
<a name="l01775"></a>01775                 *j2 = 0.00108262998905;
<a name="l01776"></a>01776                 *j3 = -0.00000253215306;
<a name="l01777"></a>01777                 *j4 = -0.00000161098761;
<a name="l01778"></a>01778                 *j3oj2 = *j3 / *j2;
<a name="l01779"></a>01779                 <span class="keywordflow">break</span>;
<a name="l01780"></a>01780             <span class="keywordflow">default</span>:
<a name="l01781"></a>01781                 fprintf(stderr,<span class="stringliteral">"unknown gravity option (%d)\n"</span>,whichconst);
<a name="l01782"></a>01782                 <span class="keywordflow">break</span>;
<a name="l01783"></a>01783     }
<a name="l01784"></a>01784 
<a name="l01785"></a>01785 } <span class="comment">// end getgravcons</span>
<a name="l01786"></a>01786 
<a name="l01787"></a>01787 
<a name="l01788"></a>01788 
<a name="l01789"></a>01789 
<a name="l01790"></a>01790 <span class="comment">/*-----------------------------------------------------------------------------</span>
<a name="l01791"></a>01791 <span class="comment">*</span>
<a name="l01792"></a>01792 <span class="comment">* procedure sgp4</span>
<a name="l01793"></a>01793 <span class="comment">*</span>
<a name="l01794"></a>01794 <span class="comment">* this procedure is the sgp4 prediction model from space command. this is an</span>
<a name="l01795"></a>01795 <span class="comment">* updated and combined version of sgp4 and sdp4, which were originally</span>
<a name="l01796"></a>01796 <span class="comment">* published separately in spacetrack report #3. this version follows the nasa</span>
<a name="l01797"></a>01797 <span class="comment">* release on the internet. there are a few fixes that are added to correct</span>
<a name="l01798"></a>01798 <span class="comment">* known errors in the existing implementations.</span>
<a name="l01799"></a>01799 <span class="comment">*</span>
<a name="l01800"></a>01800 <span class="comment">* author :  David Vallado (719-573-2600)            28 jun 2005</span>
<a name="l01801"></a>01801 <span class="comment">*               Original version in "Spacetrack Report #3 Revisited"</span>
<a name="l01802"></a>01802 <span class="comment">*</span>
<a name="l01803"></a>01803 <span class="comment">* Modifications:</span>
<a name="l01804"></a>01804 <span class="comment">*           Mike Henderson (mghenderson@lanl.gov)   20 Feb 2009</span>
<a name="l01805"></a>01805 <span class="comment">*</span>
<a name="l01806"></a>01806 <span class="comment">*             - Changed manner in which structure is passed.</span>
<a name="l01807"></a>01807 <span class="comment">*               Despite using a structure, the original version had an insane </span>
<a name="l01808"></a>01808 <span class="comment">*               number of function args. Also strange way of passing...</span>
<a name="l01809"></a>01809 <span class="comment">*</span>
<a name="l01810"></a>01810 <span class="comment">*             - Changed an instance of pow(XXX, 3) to simple multiplies.</span>
<a name="l01811"></a>01811 <span class="comment">*</span>
<a name="l01812"></a>01812 <span class="comment">*             - Integrated code with my own TLE reader.</span>
<a name="l01813"></a>01813 <span class="comment">*</span>
<a name="l01814"></a>01814 <span class="comment">*             - Integrated code with my own TLE reader.</span>
<a name="l01815"></a>01815 <span class="comment">*</span>
<a name="l01816"></a>01816 <span class="comment">*           </span>
<a name="l01817"></a>01817 <span class="comment">*</span>
<a name="l01818"></a>01818 <span class="comment">* inputs :</span>
<a name="l01819"></a>01819 <span class="comment">*   s      - initialised structure from sgp4init() call.</span>
<a name="l01820"></a>01820 <span class="comment">*   tsince - time eince epoch (minutes)</span>
<a name="l01821"></a>01821 <span class="comment">*</span>
<a name="l01822"></a>01822 <span class="comment">* outputs (via structure):</span>
<a name="l01823"></a>01823 <span class="comment">*   r - position vector km</span>
<a name="l01824"></a>01824 <span class="comment">*   v - velocity km/sec</span>
<a name="l01825"></a>01825 <span class="comment">*</span>
<a name="l01826"></a>01826 <span class="comment">* return code - non-zero on error.</span>
<a name="l01827"></a>01827 <span class="comment">*   1 - mean elements, ecc &gt;= 1.0 or ecc &lt; -0.001 or a &lt; 0.95 er</span>
<a name="l01828"></a>01828 <span class="comment">*   2 - mean motion less than 0.0</span>
<a name="l01829"></a>01829 <span class="comment">*   3 - pert elements, ecc &lt; 0.0 or ecc &gt; 1.0</span>
<a name="l01830"></a>01830 <span class="comment">*   4 - semi-latus rectum &lt; 0.0</span>
<a name="l01831"></a>01831 <span class="comment">*   5 - epoch elements are sub-orbital</span>
<a name="l01832"></a>01832 <span class="comment">*   6 - satellite has decayed</span>
<a name="l01833"></a>01833 <span class="comment">*</span>
<a name="l01834"></a>01834 <span class="comment">*</span>
<a name="l01835"></a>01835 <span class="comment">* references :</span>
<a name="l01836"></a>01836 <span class="comment">*     hoots, roehrich, norad spacetrack report #3 1980</span>
<a name="l01837"></a>01837 <span class="comment">*     hoots, norad spacetrack report #6 1986</span>
<a name="l01838"></a>01838 <span class="comment">*     hoots, schumacher and glover 2004</span>
<a name="l01839"></a>01839 <span class="comment">*     vallado, crawford, hujsak, kelso 2006 (This is the Revisiting Spacetrack Report #3)</span>
<a name="l01840"></a>01840 <span class="comment">----------------------------------------------------------------------------*/</span>
<a name="l01841"></a>01841 <span class="comment">//int sgp4( int whichconst, elsetrec&amp; s-&gt; double tsince, double r[3], double v[3]) {</span>
<a name="l01842"></a><a class="code" href="_lgm___sgp_8c.html#35dcc38ab9090b839cb731cf751f6ad6">01842</a> <span class="keywordtype">int</span> <a class="code" href="_lgm___sgp_8h.html#3aac1ba553258a14780ab9422adfdaa1">LgmSgp_SGP4</a>( <span class="keywordtype">double</span> tsince, <a class="code" href="struct___sgp_info.html">_SgpInfo</a> *s ) {
<a name="l01843"></a>01843 
<a name="l01844"></a>01844     <span class="keywordtype">double</span>  am, argpdf, argpm, argpp, axnl, aynl, betal, cnod, cos2u, coseo1, cosi, cosim;
<a name="l01845"></a>01845     <span class="keywordtype">double</span>  cosip, cosisq, cossu, cosu, delm, delomg, dndt, ecose, el2, em, emsq, eo1, ep;
<a name="l01846"></a>01846     <span class="keywordtype">double</span>  esine, inclm, j2, j3, j3oj2, j4, mm, mp, mrt=0.0, mvt, nm, nodedf, nodem;
<a name="l01847"></a>01847     <span class="keywordtype">double</span>  nodep, pl, radiusearthkm, rdotl, rl, rvdot, rvdotl, sin2u, sineo1, sini, sinim;
<a name="l01848"></a>01848     <span class="keywordtype">double</span>  sinip, sinsu, sinu, snod, su, t2, t3, t4, tc, tem5, temp, temp1, temp2, tempa;
<a name="l01849"></a>01849     <span class="keywordtype">double</span>  tempe, templ, tumin, u, ux, uy, uz, vkmpersec, vx, vy, vz, x2o3, xinc;
<a name="l01850"></a>01850     <span class="keywordtype">double</span>  xincp, xke, xl, xlm, xmdf, xmx, xmy, xnode, tmp;
<a name="l01851"></a>01851     <span class="keywordtype">int</span>     ktr;
<a name="l01852"></a>01852 
<a name="l01853"></a>01853 
<a name="l01854"></a>01854     <span class="comment">/* ------------------ set mathematical constants --------------- */</span>
<a name="l01855"></a>01855     <span class="comment">// sgp4fix divisor for divide by zero check on inclination</span>
<a name="l01856"></a>01856     <span class="keyword">const</span> <span class="keywordtype">double</span> temp4 = 1.0 + cos(<a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>-1.0e-9);
<a name="l01857"></a>01857     x2o3 = 2.0 / 3.0;
<a name="l01858"></a>01858     <span class="comment">// sgp4fix identify constants and allow alternate values</span>
<a name="l01859"></a>01859     <a class="code" href="_lgm___sgp_8h.html#67d8f3b2acd5863c49efb5ba9e8c2eb7">LgmSgp_GetGravConst</a>( s-&gt;<a class="code" href="struct___sgp_info.html#a69491b0e6ccf4560cce706b1e089e24">GravConst</a>, &amp;tumin, &amp;radiusearthkm, &amp;xke, &amp;j2, &amp;j3, &amp;j4, &amp;j3oj2 );
<a name="l01860"></a>01860     vkmpersec = radiusearthkm * xke/60.0;
<a name="l01861"></a>01861 
<a name="l01862"></a>01862 
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <span class="comment">/* --------------------- clear sgp4 error flag ----------------- */</span>
<a name="l01865"></a>01865     s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>     = tsince;
<a name="l01866"></a>01866     s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 0;
<a name="l01867"></a>01867 
<a name="l01868"></a>01868 
<a name="l01869"></a>01869 
<a name="l01870"></a>01870     <span class="comment">/* ------- update for secular gravity and atmospheric drag ----- */</span>
<a name="l01871"></a>01871     xmdf   = s-&gt;<a class="code" href="struct___sgp_info.html#bf05d62d7ad39d494816d23dd19b9325">mo</a> + s-&gt;<a class="code" href="struct___sgp_info.html#ee90111c98406414a1db98e8c5102e4f">mdot</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01872"></a>01872     argpdf = s-&gt;<a class="code" href="struct___sgp_info.html#48e2d1161d18da867e275aad47a0f2f5">argpo</a> + s-&gt;<a class="code" href="struct___sgp_info.html#c9dd4d43db3b68465f53fd7841f2cb96">argpdot</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01873"></a>01873     nodedf = s-&gt;<a class="code" href="struct___sgp_info.html#8496b25cf07aff8b5d0944cc2e229778">nodeo</a> + s-&gt;<a class="code" href="struct___sgp_info.html#9a7d9ae35fbeac8903eb8ebf5f9d31cc">nodedot</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01874"></a>01874     argpm  = argpdf;
<a name="l01875"></a>01875     mm     = xmdf;
<a name="l01876"></a>01876     t2     = s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01877"></a>01877     nodem  = nodedf + s-&gt;<a class="code" href="struct___sgp_info.html#6ec196aa951f2b53cdbfd43947eb2bce">nodecf</a>*t2;
<a name="l01878"></a>01878     tempa  = 1.0 - s-&gt;<a class="code" href="struct___sgp_info.html#d32764e5a4a660af7424fb205e2eca4c">cc1</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01879"></a>01879     tempe  = s-&gt;<a class="code" href="struct___sgp_info.html#e385ed1815b61e4a30b2ab3165514f71">bstar</a>*s-&gt;<a class="code" href="struct___sgp_info.html#aefb3346680163a2f54c8115c6542e94">cc4</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01880"></a>01880     templ  = s-&gt;<a class="code" href="struct___sgp_info.html#a92271ca6d86502933389f47a9202ab6">t2cof</a>*t2;
<a name="l01881"></a>01881 
<a name="l01882"></a>01882     <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#633c6d59b92dbf5b830ea47a87b9fc96">isimp</a> != 1 ) {
<a name="l01883"></a>01883         delomg = s-&gt;<a class="code" href="struct___sgp_info.html#9b0060ff74bc3469f158f9d4cfa578ea">omgcof</a>*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01884"></a>01884         tmp    = 1.0 + s-&gt;<a class="code" href="struct___sgp_info.html#e4f402913d5fc5dd3aebca242ab26019">eta</a>*cos(xmdf);
<a name="l01885"></a>01885         delm   = s-&gt;<a class="code" href="struct___sgp_info.html#f47d9394629b013547ccd3a29072de44">xmcof</a>*(tmp*tmp*tmp - s-&gt;<a class="code" href="struct___sgp_info.html#a4f8567c544bb137f5dc25957c63ac1a">delmo</a>);
<a name="l01886"></a>01886         temp   = delomg + delm;
<a name="l01887"></a>01887         mm     = xmdf + temp;
<a name="l01888"></a>01888         argpm  = argpdf - temp;
<a name="l01889"></a>01889         t3     = t2*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01890"></a>01890         t4     = t3*s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01891"></a>01891         tempa  = tempa - s-&gt;<a class="code" href="struct___sgp_info.html#13b4e96542fec65c7a11bc18f5a5439e">d2</a>*t2 - s-&gt;<a class="code" href="struct___sgp_info.html#483620916658141a26a261c7a5016910">d3</a>*t3 - s-&gt;<a class="code" href="struct___sgp_info.html#4bdca1913dad0bca307e04c2c8128100">d4</a>*t4;
<a name="l01892"></a>01892         tempe  = tempe + s-&gt;<a class="code" href="struct___sgp_info.html#e385ed1815b61e4a30b2ab3165514f71">bstar</a>*s-&gt;<a class="code" href="struct___sgp_info.html#02926a7d267c9362ca676c008f4e6c21">cc5</a>*(sin(mm) - s-&gt;<a class="code" href="struct___sgp_info.html#ac6611ed753f0b5e0e50d51f6a8fc3b8">sinmao</a>);
<a name="l01893"></a>01893         templ  = templ + s-&gt;<a class="code" href="struct___sgp_info.html#6ead2ed42d4de4759c2a773cbc10d36c">t3cof</a>*t3 + t4*(s-&gt;<a class="code" href="struct___sgp_info.html#9fba2bddd10102492866a46693318781">t4cof</a> + s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>*s-&gt;<a class="code" href="struct___sgp_info.html#3770068f50d6a8b4a73dcec1e8967087">t5cof</a>);
<a name="l01894"></a>01894     }
<a name="l01895"></a>01895 
<a name="l01896"></a>01896     nm    = s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a>;
<a name="l01897"></a>01897     em    = s-&gt;<a class="code" href="struct___sgp_info.html#9c6fbcc6053a01f83f538705162576d1">ecco</a>;
<a name="l01898"></a>01898     inclm = s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a>;
<a name="l01899"></a>01899 
<a name="l01900"></a>01900     <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a> == <span class="charliteral">'d'</span> ) {
<a name="l01901"></a>01901         tc = s-&gt;<a class="code" href="struct___sgp_info.html#87accd1af8e0aff4b818d891374f7cec">t</a>;
<a name="l01902"></a>01902         <span class="comment">//LgmSgp_dspace( tc, &amp;(s-&gt;atime), &amp;em, &amp;argpm, &amp;inclm, &amp;mm, &amp;nodem, &amp;dndt, &amp;nm, s);</span>
<a name="l01903"></a>01903         <a class="code" href="_lgm___sgp_8h.html#58680584e882ac4b3357448060b030a8">LgmSgp_dspace</a>( tc, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#ec7bcb1d46812f966d89f66dc1a399ea">atime</a>), &amp;em, &amp;argpm, &amp;inclm, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#83e99efa0cbc63cd4bad3b0bff321c80">xli</a>), &amp;mm, &amp;(s-&gt;<a class="code" href="struct___sgp_info.html#cfea2ed90198863a579d0dd9123d2e7b">xni</a>), &amp;nodem, &amp;dndt, &amp;nm, s ); 
<a name="l01904"></a>01904 
<a name="l01905"></a>01905     } <span class="comment">// if method = d</span>
<a name="l01906"></a>01906 
<a name="l01907"></a>01907     <span class="keywordflow">if</span> (nm &lt;= 0.0) {
<a name="l01908"></a>01908         <span class="comment">// printf("# error nm %f\n", nm);</span>
<a name="l01909"></a>01909         s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 2;
<a name="l01910"></a>01910     }
<a name="l01911"></a>01911 
<a name="l01912"></a>01912     am = pow((xke/nm), x2o3)*tempa*tempa;
<a name="l01913"></a>01913     nm = xke/pow(am, 1.5);
<a name="l01914"></a>01914     em = em - tempe;
<a name="l01915"></a>01915     <span class="comment">// fix tolerance for error recognition</span>
<a name="l01916"></a>01916     <span class="keywordflow">if</span> ((em &gt;= 1.0) || (em &lt; -0.001) || (am &lt; 0.95)) {
<a name="l01917"></a>01917         <span class="comment">// printf("# error em %f\n", em);</span>
<a name="l01918"></a>01918         s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 1;
<a name="l01919"></a>01919     }
<a name="l01920"></a>01920 
<a name="l01921"></a>01921     <span class="keywordflow">if</span> (em &lt; 0.0) em = 1.0e-6;
<a name="l01922"></a>01922     mm   += s-&gt;<a class="code" href="struct___sgp_info.html#b002ef35361da13209d5bf20414b08b1">no</a> * templ;
<a name="l01923"></a>01923     xlm   = mm + argpm + nodem;
<a name="l01924"></a>01924     emsq  = em * em;
<a name="l01925"></a>01925     temp  = 1.0 - emsq;
<a name="l01926"></a>01926     nodem = fmod(nodem, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01927"></a>01927     argpm = fmod(argpm, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01928"></a>01928     xlm   = fmod(xlm, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01929"></a>01929     mm    = fmod(xlm - argpm - nodem, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01930"></a>01930 
<a name="l01931"></a>01931 
<a name="l01932"></a>01932     <span class="comment">/* ----------------- compute extra mean quantities ------------- */</span>
<a name="l01933"></a>01933     sinim = sin(inclm);
<a name="l01934"></a>01934     cosim = cos(inclm);
<a name="l01935"></a>01935 
<a name="l01936"></a>01936 
<a name="l01937"></a>01937 
<a name="l01938"></a>01938     <span class="comment">/* -------------------- add lunar-solar periodics -------------- */</span>
<a name="l01939"></a>01939     ep    = em;
<a name="l01940"></a>01940     xincp = inclm;
<a name="l01941"></a>01941     argpp = argpm;
<a name="l01942"></a>01942     nodep = nodem;
<a name="l01943"></a>01943     mp    = mm;
<a name="l01944"></a>01944     sinip = sinim;
<a name="l01945"></a>01945     cosip = cosim;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947     <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a> == <span class="charliteral">'d'</span> ) {
<a name="l01948"></a>01948 
<a name="l01949"></a>01949         <a class="code" href="_lgm___sgp_8h.html#3a3d1ab6587159dd6059bf83aa4b6924">LgmSgp_dpper</a>( s-&gt;<a class="code" href="struct___sgp_info.html#fcbd011ce32e4763767d90522dc42e0e">inclo</a>, <span class="charliteral">'n'</span>, &amp;ep, &amp;xincp, &amp;nodep, &amp;argpp, &amp;mp, s);
<a name="l01950"></a>01950 
<a name="l01951"></a>01951         <span class="keywordflow">if</span> (xincp &lt; 0.0) {
<a name="l01952"></a>01952             xincp = -xincp;
<a name="l01953"></a>01953             nodep = nodep + <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l01954"></a>01954             argpp = argpp - M_PI;
<a name="l01955"></a>01955         }
<a name="l01956"></a>01956         <span class="keywordflow">if</span> ( (ep &lt; 0.0) || (ep &gt; 1.0) ) {
<a name="l01957"></a>01957             <span class="comment">// printf("# error ep %f\n", ep);</span>
<a name="l01958"></a>01958             s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 3;
<a name="l01959"></a>01959         }
<a name="l01960"></a>01960 
<a name="l01961"></a>01961     } <span class="comment">// if method = d</span>
<a name="l01962"></a>01962 
<a name="l01963"></a>01963     <span class="comment">/* -------------------- long period periodics ------------------ */</span>
<a name="l01964"></a>01964     <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a> == <span class="charliteral">'d'</span> ) {
<a name="l01965"></a>01965         sinip = sin(xincp);
<a name="l01966"></a>01966         cosip = cos(xincp);
<a name="l01967"></a>01967         s-&gt;<a class="code" href="struct___sgp_info.html#73cf6efaf6896931cb677e94a7d95b4a">aycof</a> = -0.5*j3oj2*sinip;
<a name="l01968"></a>01968         <span class="comment">// sgp4fix for divide by zero for xincp = 180 deg</span>
<a name="l01969"></a>01969         <span class="keywordflow">if</span> (fabs(cosip+1.0) &gt; 1.5e-12)  s-&gt;<a class="code" href="struct___sgp_info.html#0af92c37e7066a1cb310fb71c91ad369">xlcof</a> = -0.25*j3oj2*sinip*(3.0 + 5.0*cosip)/(1.0 + cosip);
<a name="l01970"></a>01970         <span class="keywordflow">else</span>                            s-&gt;<a class="code" href="struct___sgp_info.html#0af92c37e7066a1cb310fb71c91ad369">xlcof</a> = -0.25*j3oj2*sinip*(3.0 + 5.0*cosip)/temp4;
<a name="l01971"></a>01971     }
<a name="l01972"></a>01972     axnl = ep*cos(argpp);
<a name="l01973"></a>01973     temp = 1.0/(am*(1.0 - ep*ep));
<a name="l01974"></a>01974     aynl = ep*sin(argpp) + temp*s-&gt;<a class="code" href="struct___sgp_info.html#73cf6efaf6896931cb677e94a7d95b4a">aycof</a>;
<a name="l01975"></a>01975     xl   = mp + argpp + nodep + temp*s-&gt;<a class="code" href="struct___sgp_info.html#0af92c37e7066a1cb310fb71c91ad369">xlcof</a>*axnl;
<a name="l01976"></a>01976 
<a name="l01977"></a>01977 
<a name="l01978"></a>01978 
<a name="l01979"></a>01979 
<a name="l01980"></a>01980     <span class="comment">/* --------------------- solve kepler's equation --------------- */</span>
<a name="l01981"></a>01981     u    = fmod(xl - nodep, <a class="code" href="_lgm___c_trans_8h.html#4aa2c43b09c1300c334821f5507d6f71">M_2PI</a>);
<a name="l01982"></a>01982     eo1  = u;
<a name="l01983"></a>01983     tem5 = 9999.9;
<a name="l01984"></a>01984     ktr  = 1;
<a name="l01985"></a>01985     <span class="comment">// sgp4fix for kepler iteration</span>
<a name="l01986"></a>01986     <span class="comment">// the following iteration needs better limits on corrections</span>
<a name="l01987"></a>01987     <span class="keywordflow">while</span> ( (fabs(tem5) &gt;= 1.0e-12) &amp;&amp; (ktr &lt;= 10) ) {
<a name="l01988"></a>01988         sineo1 = sin(eo1);
<a name="l01989"></a>01989         coseo1 = cos(eo1);
<a name="l01990"></a>01990         tem5   = 1.0 - coseo1*axnl - sineo1*aynl;
<a name="l01991"></a>01991         tem5   = (u - aynl*coseo1 + axnl*sineo1 - eo1)/tem5;
<a name="l01992"></a>01992         <span class="keywordflow">if</span>(fabs(tem5) &gt;= 0.95) tem5 = (tem5 &gt; 0.0) ? 0.95 : -0.95;
<a name="l01993"></a>01993         eo1 += tem5;
<a name="l01994"></a>01994         ++ktr;
<a name="l01995"></a>01995     }
<a name="l01996"></a>01996 
<a name="l01997"></a>01997 
<a name="l01998"></a>01998     <span class="comment">/* ------------- short period preliminary quantities ----------- */</span>
<a name="l01999"></a>01999     ecose = axnl*coseo1 + aynl*sineo1;
<a name="l02000"></a>02000     esine = axnl*sineo1 - aynl*coseo1;
<a name="l02001"></a>02001     el2   = axnl*axnl + aynl*aynl;
<a name="l02002"></a>02002     pl    = am*(1.0-el2);
<a name="l02003"></a>02003 
<a name="l02004"></a>02004     <span class="keywordflow">if</span> (pl &lt; 0.0) {
<a name="l02005"></a>02005 
<a name="l02006"></a>02006         <span class="comment">// printf("# error pl %f\n", pl);</span>
<a name="l02007"></a>02007         s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 4;
<a name="l02008"></a>02008 
<a name="l02009"></a>02009     } <span class="keywordflow">else</span> {
<a name="l02010"></a>02010 
<a name="l02011"></a>02011         rl     = am*(1.0 - ecose);
<a name="l02012"></a>02012         rdotl  = sqrt(am)*esine/rl;
<a name="l02013"></a>02013         rvdotl = sqrt(pl)/rl;
<a name="l02014"></a>02014         betal  = sqrt(1.0 - el2);
<a name="l02015"></a>02015         temp   = esine/(1.0 + betal);
<a name="l02016"></a>02016         sinu   = am/rl*(sineo1 - aynl - axnl*temp);
<a name="l02017"></a>02017         cosu   = am/rl*(coseo1 - axnl + aynl*temp);
<a name="l02018"></a>02018         su     = atan2(sinu, cosu);
<a name="l02019"></a>02019         sin2u  = (cosu + cosu)*sinu;
<a name="l02020"></a>02020         cos2u  = 1.0 - 2.0*sinu*sinu;
<a name="l02021"></a>02021         temp   = 1.0/pl;
<a name="l02022"></a>02022         temp1  = 0.5*j2*temp;
<a name="l02023"></a>02023         temp2  = temp1*temp;
<a name="l02024"></a>02024 
<a name="l02025"></a>02025 
<a name="l02026"></a>02026 
<a name="l02027"></a>02027         <span class="comment">/* -------------- update for short period periodics ------------ */</span>
<a name="l02028"></a>02028         <span class="keywordflow">if</span> ( s-&gt;<a class="code" href="struct___sgp_info.html#e16a2e07e3ca49c3c4bd592efbf1b5ed">method</a> == <span class="charliteral">'d'</span> ) {
<a name="l02029"></a>02029             cosisq    = cosip*cosip;
<a name="l02030"></a>02030             s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a>  = 3.0*cosisq-1.0;
<a name="l02031"></a>02031             s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a> = 1.0-cosisq;
<a name="l02032"></a>02032             s-&gt;<a class="code" href="struct___sgp_info.html#1db2d8883d9dd784b6ae51a031c1266e">x7thm1</a> = 7.0*cosisq-1.0;
<a name="l02033"></a>02033         }
<a name="l02034"></a>02034         mrt   = rl*(1.0 - 1.5*temp2*betal* s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a>) + 0.5*temp1*s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a>*cos2u;
<a name="l02035"></a>02035         su    = su - 0.25*temp2*s-&gt;<a class="code" href="struct___sgp_info.html#1db2d8883d9dd784b6ae51a031c1266e">x7thm1</a>*sin2u;
<a name="l02036"></a>02036         xnode = nodep + 1.5*temp2*cosip*sin2u;
<a name="l02037"></a>02037         xinc  = xincp + 1.5*temp2*cosip*sinip*cos2u;
<a name="l02038"></a>02038         mvt   = rdotl - nm*temp1*s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a>*sin2u/xke;
<a name="l02039"></a>02039         rvdot = rvdotl + nm*temp1*(s-&gt;<a class="code" href="struct___sgp_info.html#1e0131f4c92de0fd372d35e3b9edb9f4">x1mth2</a>*cos2u + 1.5*s-&gt;<a class="code" href="struct___sgp_info.html#77fbcbf60585b0d443d82036a943d947">con41</a>)/xke;
<a name="l02040"></a>02040 
<a name="l02041"></a>02041         <span class="comment">/* --------------------- orientation vectors ------------------- */</span>
<a name="l02042"></a>02042         sinsu = sin(su);
<a name="l02043"></a>02043         cossu = cos(su);
<a name="l02044"></a>02044 
<a name="l02045"></a>02045         snod  = sin(xnode);
<a name="l02046"></a>02046         cnod  = cos(xnode);
<a name="l02047"></a>02047 
<a name="l02048"></a>02048         sini  = sin(xinc);
<a name="l02049"></a>02049         cosi  = cos(xinc);
<a name="l02050"></a>02050 
<a name="l02051"></a>02051         xmx = -snod * cosi;
<a name="l02052"></a>02052         xmy = cnod * cosi;
<a name="l02053"></a>02053 
<a name="l02054"></a>02054         ux = xmx * sinsu + cnod * cossu;
<a name="l02055"></a>02055         uy = xmy * sinsu + snod * cossu;
<a name="l02056"></a>02056         uz = sini * sinsu;
<a name="l02057"></a>02057 
<a name="l02058"></a>02058         vx = xmx * cossu - cnod * sinsu;
<a name="l02059"></a>02059         vy = xmy * cossu - snod * sinsu;
<a name="l02060"></a>02060         vz = sini * cossu;
<a name="l02061"></a>02061 
<a name="l02062"></a>02062 
<a name="l02063"></a>02063         <span class="comment">/* --------- position and velocity (in km and km/sec) ---------- */</span>
<a name="l02064"></a>02064         s-&gt;<a class="code" href="struct___sgp_info.html#1059b82f84827fc49ea81b12566b3cdb">X</a>  = (mrt * ux)* radiusearthkm;
<a name="l02065"></a>02065         s-&gt;<a class="code" href="struct___sgp_info.html#c8d59bf77d5ef21e7c7a88b08f14c825">Y</a>  = (mrt * uy)* radiusearthkm;
<a name="l02066"></a>02066         s-&gt;<a class="code" href="struct___sgp_info.html#0f16a8f561453187897f0820186da39b">Z</a>  = (mrt * uz)* radiusearthkm;
<a name="l02067"></a>02067 
<a name="l02068"></a>02068         s-&gt;<a class="code" href="struct___sgp_info.html#7a2579ee60469b7dc5ac77b902d71fa5">VX</a> = (mvt * ux + rvdot * vx) * vkmpersec;
<a name="l02069"></a>02069         s-&gt;<a class="code" href="struct___sgp_info.html#f7687d7aef9103def7b09bcb5d568e04">VY</a> = (mvt * uy + rvdot * vy) * vkmpersec;
<a name="l02070"></a>02070         s-&gt;<a class="code" href="struct___sgp_info.html#b9b9161b8168f9424231c7fc59837f88">VZ</a> = (mvt * uz + rvdot * vz) * vkmpersec;
<a name="l02071"></a>02071 
<a name="l02072"></a>02072     } <span class="comment">// if pl &gt; 0</span>
<a name="l02073"></a>02073 
<a name="l02074"></a>02074     <span class="comment">// sgp4fix for decaying satellites</span>
<a name="l02075"></a>02075     <span class="keywordflow">if</span> (mrt &lt; 1.0) {
<a name="l02076"></a>02076         <span class="comment">// printf("# decay condition %11.6f \n",mrt);</span>
<a name="l02077"></a>02077         s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> = 6;
<a name="l02078"></a>02078     }
<a name="l02079"></a>02079 
<a name="l02080"></a>02080     <span class="comment">//#include "debug7.cpp"</span>
<a name="l02081"></a>02081     <span class="keywordflow">return</span>( s-&gt;<a class="code" href="struct___sgp_info.html#1ec236df65b93a338aecdf3fa64790f9">error</a> );
<a name="l02082"></a>02082 
<a name="l02083"></a>02083 
<a name="l02084"></a>02084 } <span class="comment">// end sgp4</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small><a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
</body>
</html>
