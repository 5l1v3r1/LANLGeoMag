<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>LanlGeoMag: /home/mgh/LanlGeoMag/libLanlGeoMag/Lgm_SunPosition.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>/home/mgh/LanlGeoMag/libLanlGeoMag/Lgm_SunPosition.c</h1><a href="_lgm___sun_position_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00003"></a><a class="code" href="_lgm___sun_position_8c.html#7737801a4acf448cf8e47064fd3820ab">00003</a> <span class="preprocessor">#define INCLUDE_PERTURBATIONS 1</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span>
<a name="l00005"></a><a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">00005</a> <span class="keywordtype">double</span> <a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( <span class="keywordtype">double</span> x ) {
<a name="l00006"></a>00006 <span class="comment">/*</span>
<a name="l00007"></a>00007 <span class="comment">    x -= floor(x);</span>
<a name="l00008"></a>00008 <span class="comment">    if (x&lt;0.0) x += 1.0;</span>
<a name="l00009"></a>00009 <span class="comment">*/</span>
<a name="l00010"></a>00010     x = x-(double)((<span class="keywordtype">int</span>)x); <span class="keywordflow">if</span> (x&lt;0.0) x += 1.0;
<a name="l00011"></a>00011     <span class="keywordflow">return</span>( x );
<a name="l00012"></a>00012 }
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">00014</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( <span class="keywordtype">double</span> c1, <span class="keywordtype">double</span> s1, <span class="keywordtype">double</span> c2, <span class="keywordtype">double</span> s2, <span class="keywordtype">double</span> *c, <span class="keywordtype">double</span> *s ){
<a name="l00015"></a>00015     *c = c1*c2 - s1*s2;
<a name="l00016"></a>00016     *s = s1*c2 + c1*s2;
<a name="l00017"></a>00017 }
<a name="l00018"></a>00018 
<a name="l00019"></a><a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">00019</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( <span class="keywordtype">double</span> T, <span class="keywordtype">int</span> i1, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> it, <span class="keywordtype">double</span> dlc, <span class="keywordtype">double</span> dls, <span class="keywordtype">double</span> drc, <span class="keywordtype">double</span> drs, <span class="keywordtype">double</span> dbc, <span class="keywordtype">double</span> dbs, 
<a name="l00020"></a>00020             <span class="keywordtype">double</span> c3[], <span class="keywordtype">double</span> s3[], <span class="keywordtype">double</span> c[], <span class="keywordtype">double</span> s[],  <span class="keywordtype">double</span> *dl, <span class="keywordtype">double</span> *dr, <span class="keywordtype">double</span> *db ) {
<a name="l00021"></a>00021 
<a name="l00022"></a>00022     <span class="keywordtype">double</span> u, v;
<a name="l00023"></a>00023 
<a name="l00024"></a>00024     <span class="keywordflow">if</span> (it == 0){
<a name="l00025"></a>00025         <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( c3[i1], s3[i1], c[i], s[i], &amp;u, &amp;v );
<a name="l00026"></a>00026     } <span class="keywordflow">else</span> {
<a name="l00027"></a>00027         u *= T;
<a name="l00028"></a>00028         v *= T;
<a name="l00029"></a>00029     }
<a name="l00030"></a>00030     *dl += dlc*u + dls*v;
<a name="l00031"></a>00031     *dr += drc*u + drs*v;
<a name="l00032"></a>00032     *db += dbc*u + dbs*v;
<a name="l00033"></a>00033 }
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="_lgm___sun_position_8c.html#b400c7fd9bf8cd64e6b77831caca28e4">00036</a> <span class="keywordtype">void</span> <a class="code" href="_lgm___c_trans_8h.html#b400c7fd9bf8cd64e6b77831caca28e4">Lgm_SunPosition</a>( <span class="keywordtype">double</span> T, <span class="keywordtype">double</span> *l, <span class="keywordtype">double</span> *r, <span class="keywordtype">double</span> *b ) {
<a name="l00037"></a>00037 
<a name="l00038"></a>00038     <span class="keywordtype">int</span>     i;
<a name="l00039"></a>00039     <span class="keywordtype">double</span>  p2;
<a name="l00040"></a>00040     <span class="keywordtype">double</span>  m2, m3, m4, m5, m6;
<a name="l00041"></a>00041     <span class="keywordtype">double</span>  d, a, uu, c3[9], s3[9], c[9], s[9];
<a name="l00042"></a>00042     <span class="keywordtype">double</span>  dl, dr, db;
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045     p2 = 2.0*<a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00046"></a>00046     dl = dr = db = 0.0;
<a name="l00047"></a>00047     m2 = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.1387306 + 162.5485917*T );
<a name="l00048"></a>00048     m3 = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.9931266 + 99.9973604*T );
<a name="l00049"></a>00049     m4 = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.0543250 + 53.1666028*T );
<a name="l00050"></a>00050     m5 = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.0551750 + 8.4293972*T );
<a name="l00051"></a>00051     m6 = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.8816500 + 3.3938722*T );
<a name="l00052"></a>00052     d  = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.8274 + 1236.8531*T);
<a name="l00053"></a>00053     a  = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.3749 + 1325.5524*T );
<a name="l00054"></a>00054     uu = p2*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.2591 + 1342.2278*T );
<a name="l00055"></a>00055 
<a name="l00056"></a>00056     c3[1] = 1.0; s3[1] = 0.0;
<a name="l00057"></a>00057     c3[2] = cos(m3); s3[2] = sin(m3);
<a name="l00058"></a>00058     c3[0] = c3[2]; s3[0] = -s3[2];
<a name="l00059"></a>00059     <span class="keywordflow">for</span> (i=3; i&lt;9; i++ ) <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( c3[i-1], s3[i-1], c3[2], s3[2], &amp;c3[i], &amp;s3[i] );
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <span class="keywordflow">if</span> ( <a class="code" href="_lgm___sun_position_8c.html#7737801a4acf448cf8e47064fd3820ab">INCLUDE_PERTURBATIONS</a> ) {
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         <span class="comment">// perturbations for Venus</span>
<a name="l00067"></a>00067         c[8] = 1.0; s[8] = 0.0;
<a name="l00068"></a>00068         c[7] = cos(m2); s[7] = -sin(m2);
<a name="l00069"></a>00069         <span class="keywordflow">for</span> (i=7; i&gt;=3; i--) <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( c[i], s[i], c[7], s[7], &amp;c[i-1], &amp;s[i-1] );
<a name="l00070"></a>00070         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 8, 0, -0.22, 6892.76, -16707.37, -0.54,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00071"></a>00071         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 8, 1, -0.06,  -17.35,     42.04, -0.15,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00072"></a>00072         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 8, 2, -0.01,   -0.05,      0.13, -0.02,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00073"></a>00073         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 8, 0,  0.00,   71.98,   -139.57,  0.00,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00074"></a>00074         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 8, 1,  0.00,   -0.36,      0.70,  0.00,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00075"></a>00075         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 8, 0,  0.00,    1.04,     -1.75,  0.00,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00076"></a>00076         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 1, 7, 0,  0.03,   -0.07,     -0.16, -0.07,  0.02, -0.02, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00077"></a>00077         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 7, 0,  2.35,   -4.23,     -4.75, -2.64,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00078"></a>00078         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 6, 0, -0.10,    0.06,      0.12,  0.20,  0.02,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00079"></a>00079         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 7, 0, -0.06,   -0.03,      0.20, -0.01,  0.01, -0.09, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00080"></a>00080         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 6, 0, -4.70,    2.90,      8.28, 13.42,  0.01, -0.01, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00081"></a>00081         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 6, 0,  1.80,   -1.74,     -1.44, -1.57,  0.04, -0.06, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00082"></a>00082         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 5, 0, -0.67,    0.03,      0.11,  2.43,  0.01,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00083"></a>00083         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 5, 6, 0,  0.03,   -0.03,      0.10,  0.09,  0.01, -0.01, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00084"></a>00084         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 5, 5, 0,  1.51,   -0.40,     -0.88, -3.36,  0.18, -0.10, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00085"></a>00085         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 5, 4, 0, -0.19,   -0.09,     -0.38,  0.77,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00086"></a>00086         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 6, 5, 0,  0.76,   -0.68,      0.30,  0.37,  0.01,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00087"></a>00087         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 6, 4, 0, -0.14,   -0.04,     -0.11,  0.43, -0.03,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00088"></a>00088         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 6, 3, 0, -0.05,   -0.07,     -0.31,  0.21,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00089"></a>00089         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 7, 4, 0,  0.15,   -0.04,     -0.06, -0.21,  0.01,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00090"></a>00090         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 7, 3, 0, -0.03,   -0.03,     -0.09,  0.09, -0.01,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00091"></a>00091         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 7, 2, 0,  0.00,   -0.04,     -0.18,  0.02,  0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00092"></a>00092         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 8, 3, 0, -0.12,   -0.03,     -0.08,  0.31, -0.02, -0.01, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         <span class="comment">// perturbations for Mars</span>
<a name="l00095"></a>00095         c[7] = cos(m4); s[7] = -sin(m4);
<a name="l00096"></a>00096         <span class="keywordflow">for</span> (i=7; i&gt;=1; i--) <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( c[i], s[i], c[7], s[7], &amp;c[i-1], &amp;s[i-1] );
<a name="l00097"></a>00097         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 7, 0, -0.22,  0.17, -0.21, -0.27, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00098"></a>00098         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 6, 0, -1.66,  0.62,  0.16,  0.28, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00099"></a>00099         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 6, 0,  1.96,  0.57, -1.32,  4.55, 0.00, 0.01, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00100"></a>00100         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 5, 0,  0.40,  0.15, -0.17,  0.46, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00101"></a>00101         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 4, 0,  0.53,  0.26,  0.09, -0.22, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00102"></a>00102         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 5, 0,  0.05,  0.12, -0.35,  0.15, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00103"></a>00103         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 4, 0, -0.13, -0.48,  1.06, -0.29, 0.01, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00104"></a>00104         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 3, 0, -0.04, -0.20,  0.20, -0.04, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00105"></a>00105         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 5, 4, 0,  0.00, -0.03,  0.10,  0.04, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00106"></a>00106         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 5, 3, 0,  0.05, -0.07,  0.20,  0.14, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00107"></a>00107         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 5, 2, 0, -0.10,  0.11, -0.23, -0.22, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00108"></a>00108         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 6, 1, 0, -0.05,  0.00,  0.01, -0.14, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00109"></a>00109         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 6, 0, 0,  0.05,  0.01, -0.02,  0.10, 0.00, 0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="comment">// perturbations for Jupiter</span>
<a name="l00112"></a>00112         c[7] = cos(m5); s[7] = -sin(m5);
<a name="l00113"></a>00113         <span class="keywordflow">for</span> (i=7; i&gt;=5; i--) <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( c[i], s[i], c[7], s[7], &amp;c[i-1], &amp;s[i-1] );
<a name="l00114"></a>00114         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 0, 7, 0,  0.01,  0.07,  0.18,  -0.02,   0.00, -0.02, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00115"></a>00115         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 1, 7, 0, -0.31,  2.58,  0.52,   0.34,   0.02,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00116"></a>00116         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 7, 0, -7.21, -0.06,  0.13, -16.27,   0.00, -0.02, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00117"></a>00117         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 6, 0, -0.54, -1.52,  3.09,  -1.12,   0.01, -0.17, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00118"></a>00118         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 5, 0, -0.03, -0.21,  0.38,  -0.06,   0.00, -0.02, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00119"></a>00119         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 7, 0, -0.16,  0.05, -0.18,  -0.31,   0.01,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00120"></a>00120         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 6, 0,  0.14, -2.73,  9.23,   0.48,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00121"></a>00121         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 5, 0,  0.07, -0.55,  1.83,   0.25,   0.01,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00122"></a>00122         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 4, 0,  0.02, -0.08,  0.25,   0.06,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00123"></a>00123         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 6, 0,  0.01, -0.07,  0.16,   0.04,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00124"></a>00124         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 5, 0, -0.16, -0.03,  0.08,  -0.64,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00125"></a>00125         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 4, 4, 0, -0.04, -0.01,  0.03,  -0.17,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <span class="comment">// perturbations for Saturn</span>
<a name="l00128"></a>00128         c[7] = cos(m6); s[7] = -sin(m6);
<a name="l00129"></a>00129         <a class="code" href="_lgm___sun_position_8c.html#31f5bd3719a51e5dcac5d5eb3e4f639d">AddThe</a>( c[7], s[7], c[7], s[7], &amp;c[6], &amp;s[6] );
<a name="l00130"></a>00130         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 1, 7, 0,  0.00,  0.32,  0.01,   0.00,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00131"></a>00131         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 7, 0, -0.08, -0.41,  0.97,  -0.18,   0.00, -0.01, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00132"></a>00132         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 2, 6, 0,  0.04,  0.10, -0.23,   0.10,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00133"></a>00133         <a class="code" href="_lgm___sun_position_8c.html#0fffd38e8b66a549896a0860fac30e2d">Term</a>( T, 3, 6, 0,  0.04,  0.10, -0.35,   0.13,   0.00,  0.00, c3, s3, c, s, &amp;dl, &amp;dr, &amp;db );
<a name="l00134"></a>00134 
<a name="l00135"></a>00135         <span class="comment">// perturbations for Moon</span>
<a name="l00136"></a>00136         dl += 6.45*sin(d)  - 0.42*sin(d-a) + 0.18*sin(d+a) + 0.17*sin(d-m3) - 0.06*sin(d+m3);
<a name="l00137"></a>00137         dr += 30.76*cos(d) - 3.06*cos(d-a) + 0.85*cos(d+a) - 0.58*cos(d+m3) + 0.57*cos(d-m3);
<a name="l00138"></a>00138         db += 0.576*sin(uu);
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141     
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     dl += 6.40*sin(p2*(0.6983 + 0.0561*T)) + 1.87*sin(p2*(0.5764 + 0.4174*T))
<a name="l00144"></a>00144             + 0.27*sin(p2*(0.4189 + 0.3306*T)) + 0.20*sin(p2*(0.3581 + 2.4814*T));
<a name="l00145"></a>00145     *l = <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0 * 360.0*<a class="code" href="_lgm___sun_position_8c.html#92f2f0f91c99cd6bec1a0e9a3b6443fc">Frac</a>( 0.7859453 + m3/p2 + ((6191.2 + 1.1*T)*T + dl)/1296e3);
<a name="l00146"></a>00146     *r = 1.0001398 - 7e-7*T + 1e-6*dr;
<a name="l00147"></a>00147     *b = <a class="code" href="_lgm___sgp_8h.html#e71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180.0 * db/3600.0;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small><a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
</body>
</html>
